import{j as a}from"./ui-vendor-BuGzxEnB.js";import{a as e}from"./react-vendor-9hcqHTTy.js";import{g as t,b as s,a as n,f as r,i as l,j as o,h as i,p as d,o as c,B as m}from"./index-B29_a9u8.js";import{E as h,S as u,I as g}from"./StatusMessage-Bopybf1P.js";import"./icons-vendor-BLJDdPqg.js";import"./dnd-vendor-B-r8cpST.js";import"./state-vendor-CZRBIdKG.js";const x={primary:"bg-blue-600",success:"bg-green-600",warning:"bg-amber-500",error:"bg-red-600"},f={sm:"h-2",md:"h-3",lg:"h-4"},$=({value:e,max:t=100,showPercentage:s=!0,showValue:n=!1,label:r,size:l="md",variant:o="primary",className:i="",animated:d=!0})=>{const c=Math.min(Math.max(e,0),t),m=c/t*100,h=["w-full bg-gray-200 rounded-full overflow-hidden",f[l],i].join(" "),u=["h-full transition-all duration-300 ease-out",x[o],d?"transition-all duration-300":""].join(" ");return a.jsxs("div",{className:"w-full",children:[(r||s||n)&&a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:r}),a.jsxs("div",{className:"text-sm text-gray-600 flex gap-2",children:[n&&a.jsxs("span",{children:[c," / ",t]}),s&&a.jsxs("span",{children:[Math.round(m),"%"]})]})]}),a.jsx("div",{className:h,role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":t,children:a.jsx("div",{className:u,style:{width:`${m}%`}})})]})},j=e.memo(function({onStatusChange:l}){const[x,f]=e.useState(null),[j,p]=e.useState(0),[w,y]=e.useState(!1),[b,M]=e.useState(0),[v,S]=e.useState(0),[k,N]=e.useState(0),[D,_]=e.useState(""),[C,E]=e.useState(""),[I,U]=e.useState(""),F=e.useCallback(async()=>{try{const[a,e,r]=await Promise.all([t(),s(),n()]);if(M(a.length),S(e.length),N(r.length),a.length>0){const e=a.map(a=>a.date).sort();_(`${e[0]} ～ ${e[e.length-1]}`)}else _("");if(e.length>0){const a=e.map(a=>a.date).sort();E(`${a[0]} ～ ${a[a.length-1]}`)}else E("");if(r.length>0){const a=r.map(a=>a.date).sort();U(`${a[0]} ～ ${a[a.length-1]}`)}else U("")}catch(a){}},[]),Y=e.useCallback(async()=>{f("体重テストデータを生成中..."),y(!0),p(0),null==l||l("体重テストデータを生成中...");try{const e=180,t=75,s=50,n=100;let o=0;for(let l=e-1;l>=0;l--){const i=new Date;i.setDate(i.getDate()-l);const d=i.getFullYear(),c=String(i.getMonth()+1).padStart(2,"0"),m=`${d}-${c}-${String(i.getDate()).padStart(2,"0")}`,h="08:00";let u=t-.05*(e-l)+2*(Math.random()-.5);u=Math.max(s,Math.min(n,Math.round(10*u)/10));const g={id:`test_weight_${m}_${Math.random().toString(36).substr(2,6)}`,date:m,time:h,weight:u,bodyFat:Math.random()>.2?Math.round(10*(15+20*Math.random()))/10:null,waist:Math.random()>.2?Math.round(10*(65+25*Math.random()))/10:null,note:Math.random()>.7?"テストメモ":null,excludeFromGraph:Math.random()>.5};try{await r(g),o++,p(o/e*50)}catch(a){}}f(`体重テストデータ生成完了: ${o}/${e}件`),null==l||l(`体重テストデータ生成完了: ${o}/${e}件`),await F()}catch(a){f(`エラー: ${a instanceof Error?a.message:"Unknown error"}`),null==l||l(`エラー: ${a instanceof Error?a.message:"Unknown error"}`)}finally{y(!1)}},[l,F]),P=e.useCallback(async()=>{f("日課テストデータを生成中..."),y(!0),p(50),null==l||l("日課テストデータを生成中...");try{const e=[{fieldId:"exercise"},{fieldId:"meal"},{fieldId:"sleep"},{fieldId:"smoke"},{fieldId:"alcohol"}],t=180;let s=0;for(let n=t-1;n>=0;n--){const r=new Date;r.setDate(r.getDate()-n);const l=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),d=`${l}-${i}-${String(r.getDate()).padStart(2,"0")}`;for(const t of e){const e=Math.random();let s;s=e<.3?1:e<.6?.5:0;const n={id:`test_daily_${t.fieldId}_${d}_${Math.random().toString(36).substr(2,6)}`,date:d,fieldId:t.fieldId,value:s};try{await o(n)}catch(a){}}s++,p(50+s/t*25)}f(`日課テストデータ生成完了: ${s*e.length}件`),null==l||l(`日課テストデータ生成完了: ${s*e.length}件`),await F()}catch(a){f(`エラー: ${a instanceof Error?a.message:"Unknown error"}`),null==l||l(`エラー: ${a instanceof Error?a.message:"Unknown error"}`)}},[l,F]),z=e.useCallback(async()=>{f("血圧テストデータを生成中..."),p(75),null==l||l("血圧テストデータを生成中...");try{const e=180;let t=0;for(let s=e-1;s>=0;s--){const n=new Date;n.setDate(n.getDate()-s);const r=n.getFullYear(),l=String(n.getMonth()+1).padStart(2,"0"),o=`${r}-${l}-${String(n.getDate()).padStart(2,"0")}`,d=["08:00","22:00"];for(const e of d){const t=110+Math.round(30*Math.random()),s=60+Math.round(30*Math.random()),n=60+Math.round(40*Math.random()),r={id:`test_bp_${o}_${e.replace(":","")}_${Math.random().toString(36).substr(2,6)}`,date:o,time:e,systolic:t,diastolic:s,heartRate:n,note:Math.random()>.8?"テストメモ":null};try{await i(r)}catch(a){}}t++,p(75+t/e*25)}f(`血圧テストデータ生成完了: ${2*t}件`),null==l||l(`血圧テストデータ生成完了: ${2*t}件`),await F()}catch(a){f(`エラー: ${a instanceof Error?a.message:"Unknown error"}`),null==l||l(`エラー: ${a instanceof Error?a.message:"Unknown error"}`)}finally{y(!1),p(100)}},[l,F]),B=e.useCallback(async()=>{const a=`generate-test-data-${Date.now()}`;d.trackDatabase.start(a,"generate-test-data");try{await Y(),await P(),await z(),f("すべてのテストデータ生成が完了しました"),null==l||l("すべてのテストデータ生成が完了しました")}catch(e){f(`エラー: ${e instanceof Error?e.message:"Unknown error"}`),null==l||l(`エラー: ${e instanceof Error?e.message:"Unknown error"}`)}finally{d.trackDatabase.end(a,"generate-test-data"),y(!1)}},[Y,P,z,l]);return a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-700 dark:text-gray-200 flex items-center gap-2 justify-center",children:[a.jsx(c,{className:"w-6 h-6"}),"テストデータ生成"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex justify-center",children:a.jsxs("div",{className:"text-left max-w-md",children:[a.jsxs("p",{children:["• 体重: ",b,"件 ",D&&`(${D})`]}),a.jsxs("p",{children:["• 日課: ",v,"件 ",C&&`(${C})`]}),a.jsxs("p",{children:["• 血圧: ",k,"件 ",I&&`(${I})`]})]})}),a.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[a.jsx(m,{variant:"primary",icon:c,onClick:Y,disabled:w,children:"体重テストデータ生成"}),a.jsx(m,{variant:"primary",icon:c,onClick:P,disabled:w,children:"日課テストデータ生成"}),a.jsx(m,{variant:"primary",icon:c,onClick:z,disabled:w,children:"血圧テストデータ生成"}),a.jsx(m,{variant:"success",icon:c,onClick:B,disabled:w,children:"すべて生成"})]}),w&&a.jsx($,{value:j,label:"テストデータを生成中..."}),x&&a.jsx("div",{className:"mt-4",children:x.includes("エラー")?a.jsx(h,{message:x}):x.includes("完了")?a.jsx(u,{message:x}):a.jsx(g,{message:x})})]})]})})});export{j as default};
