import{j as e,c as a}from"./ui-vendor-Z70llhoy.js";import{a as r}from"./react-vendor-DRLO6cO2.js";import{u as t,k as n,p as d,a as s,h as o,y as l,t as c}from"./index-BNZho4P3.js";import{t as i}from"./textUtils-BtQSYqdL.js";import"./icons-vendor-DbsR8xvJ.js";import"./state-vendor-Crk1RRDk.js";function m(){const{t:m,translateFieldName:x,currentLanguage:g,formatDate:u}=t(),{records:h,fields:f,loadRecords:b,loadFields:p}=n(),[v,y]=r.useState(null),[k,w]=r.useState(new Set),j="ja"===g?"ja-JP":"en-US";r.useEffect(()=>(d.trackRender.start("RecordCalendar"),()=>{d.trackRender.end("RecordCalendar")})),r.useEffect(()=>{(async()=>{try{await c("load-fields-calendar",async()=>{await p()}),await c("load-records-calendar",async()=>{await b()})}catch(e){console.error("Data loading error:",e)}})()},[p,b]);const _=e=>{if("notes"===e)return{fieldId:"notes",name:x("notes"),type:"string",order:0};let a=f.find(a=>a.fieldId===e);return a||(a=f.find(a=>a.name===e)),a},N=r.useMemo(()=>{performance.now();const e=new Set(h.map(e=>e.date));return performance.now(),e},[h]),S=r.useMemo(()=>{performance.now();if(!v)return[];const e=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}`,a=h.filter(a=>a.date===e);return performance.now(),a},[h,v]),I=r.useMemo(()=>{performance.now();if(0===S.length)return{};const e=[...S].sort((e,a)=>{const r=`${e.date} ${e.time}`;return`${a.date} ${a.time}`.localeCompare(r)}).reduce((e,a)=>{const r=`${a.date} ${a.time}`;return e[r]||(e[r]=[]),e[r].push(a),e},{});return performance.now(),e},[S]),$=e=>{const a=d.trackInteraction.start("text-expand");(e=>{w(a=>{const r=new Set(a);return r.has(e)?r.delete(e):r.add(e),r})})(e),d.trackInteraction.end(a,"text-expand")};return r.useEffect(()=>{},[h.length,f.length,N.size,S.length,Object.keys(I).length,k.size,v]),e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-12",children:m("pages.calendar.title")}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6 mb-8",children:[e.jsx("style",{children:"\n          .react-calendar {\n            width: 100%;\n            background: transparent;\n            border: none;\n            font-family: inherit;\n          }\n          .react-calendar__tile {\n            padding: 12px 8px;\n            background: transparent;\n            border-radius: 8px;\n            transition: all 0.2s;\n            position: relative;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n            color: #374151;\n          }\n          @media (prefers-color-scheme: dark) {\n            .react-calendar__tile {\n              color: #d1d5db;\n            }\n          }\n          .react-calendar__tile:enabled:hover,\n          .react-calendar__tile:enabled:focus {\n            background-color: #dbeafe;\n          }\n          @media (prefers-color-scheme: dark) {\n            .react-calendar__tile:enabled:hover,\n            .react-calendar__tile:enabled:focus {\n              background-color: #1e3a8a;\n            }\n          }\n          .react-calendar__tile--active {\n            background: #2563eb !important;\n            color: white !important;\n          }\n          .react-calendar__tile--active .record-border {\n            border-color: white !important;\n          }\n          .react-calendar__navigation button {\n            color: #374151;\n            font-weight: 500;\n            font-size: 16px;\n            padding: 8px 16px;\n          }\n          @media (prefers-color-scheme: dark) {\n            .react-calendar__navigation button {\n              color: #d1d5db;\n            }\n          }\n          .react-calendar__navigation button:enabled:hover,\n          .react-calendar__navigation button:enabled:focus {\n            background-color: #f3f4f6;\n            border-radius: 8px;\n          }\n          @media (prefers-color-scheme: dark) {\n            .react-calendar__navigation button:enabled:hover,\n            .react-calendar__navigation button:enabled:focus {\n              background-color: #374151;\n            }\n          }\n          .react-calendar__month-view__weekdays {\n            font-weight: 600;\n            color: #6b7280;\n          }\n          @media (prefers-color-scheme: dark) {\n            .react-calendar__month-view__weekdays {\n              color: #9ca3af;\n            }\n          }\n        "}),e.jsx(a,{onChange:e=>(e=>{const a=d.trackInteraction.start("date-select");y(e),d.trackInteraction.end(a,"date-select")})(e),value:v,locale:j,tileContent:({date:a,view:r})=>{if("month"===r){const r=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`;if(N.has(r))return e.jsx("div",{className:"absolute inset-0 border-2 border-blue-600 rounded-lg pointer-events-none record-border"})}return null}})]}),v&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-white mb-8",children:[u(v,{year:"numeric",month:"long",day:"numeric",weekday:"long"})," ",m("pages.calendar.recordsFor")]}),0===S.length?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6 text-center text-gray-500 dark:text-gray-400",children:e.jsx("p",{className:"text-lg",children:m("pages.calendar.noRecords")})}):e.jsx("div",{className:"space-y-8",children:Object.entries(I).map(([a,r])=>{return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6",children:[e.jsxs("div",{className:"text-2xl font-semibold text-gray-800 dark:text-white mb-6 border-b border-gray-200 dark:border-gray-600 pb-4 flex items-center gap-2",children:[e.jsx(s,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),r[0].time]}),e.jsx("ul",{className:"space-y-4",children:(t=r,[...t].sort((e,a)=>{const r=_(e.fieldId),t=_(a.fieldId);return((null==r?void 0:r.order)??999)-((null==t?void 0:t.order)??999)})).map(a=>{const r=_(a.fieldId);return e.jsx("li",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors duration-200",children:"notes"===(null==r?void 0:r.fieldId)?e.jsxs("div",{className:"flex items-stretch gap-2",children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 dark:text-gray-300 pr-2 border-r border-gray-200 dark:border-gray-500 flex-shrink-0",children:r?r.name:a.fieldId}),e.jsx("div",{className:"text-lg text-gray-800 dark:text-white font-semibold pl-2 flex-1 min-w-0",children:"string"==typeof a.value&&a.value.length>30?e.jsx("button",{onClick:()=>$(a.id),className:"text-left hover:text-blue-600 transition-colors break-words w-full",title:m("common.clickToExpand"),children:(t=a.id,k.has(t)?a.value:i(a.value))}):e.jsx("span",{className:"break-words",children:a.value})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-stretch",children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 dark:text-gray-300 text-right pr-2 border-r border-gray-200 dark:border-gray-500",children:r?r.name:a.fieldId}),e.jsx("div",{className:"text-lg text-gray-800 dark:text-white font-semibold pl-2 text-left",children:"boolean"==typeof a.value?a.value?e.jsxs("span",{className:"inline-flex items-center gap-2 text-green-600",children:[e.jsx(o,{className:"w-6 h-6"}),m("fields.yes")]}):e.jsxs("span",{className:"inline-flex items-center gap-2 text-red-600",children:[e.jsx(l,{className:"w-6 h-6"}),m("fields.no")]}):e.jsxs("span",{className:"break-words",children:[a.value,(null==r?void 0:r.unit)&&"boolean"!=typeof a.value&&e.jsx("span",{className:"text-gray-600 dark:text-gray-400 ml-1",children:r.unit})]})})]})},a.id);var t})})]},a);var t})})]})]})}export{m as default};
//# sourceMappingURL=RecordCalendar-DjxaaUgL.js.map
