import{j as e,d as t}from"./ui-vendor-NppzeDv9.js";import{r as n}from"./react-vendor-C0LY84C9.js";import{g as a,a as r,e as s,n as l}from"./index-C5oYGPPY.js";import"./icons-vendor-dw3RmBrp.js";import"./state-vendor-B_eAjXv5.js";function d(){const{records:d,fields:i,loadRecords:o,loadFields:c}=a(),[m,x]=n.useState(null),[u,g]=n.useState(new Set);n.useEffect(()=>{c(),o()},[c,o]);const h=e=>{if("notes"===e)return{fieldId:"notes",name:"備考",type:"string",order:0};let t=i.find(t=>t.fieldId===e);return t||(t=i.find(t=>t.name===e)),t},f=(e,t=30)=>e.length<=t?e:e.substring(0,t)+"...",p=n.useMemo(()=>new Set(d.map(e=>e.date)),[d]),b=n.useMemo(()=>{if(!m)return[];const e=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}`;return d.filter(t=>t.date===e)},[d,m]),v=n.useMemo(()=>{if(0===b.length)return{};return[...b].sort((e,t)=>{const n=`${e.date} ${e.time}`;return`${t.date} ${t.time}`.localeCompare(n)}).reduce((e,t)=>{const n=`${t.date} ${t.time}`;return e[n]||(e[n]=[]),e[n].push(t),e},{})},[b]);return e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-12",children:"カレンダー"}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6 mb-8",children:[e.jsx("style",{children:"\n          .react-calendar {\n            width: 100%;\n            background: transparent;\n            border: none;\n            font-family: inherit;\n          }\n          .react-calendar__tile {\n            padding: 12px 8px;\n            background: transparent;\n            border-radius: 8px;\n            transition: all 0.2s;\n          }\n          .react-calendar__tile:enabled:hover,\n          .react-calendar__tile:enabled:focus {\n            background-color: #dbeafe;\n          }\n          .react-calendar__tile--active {\n            background: #2563eb !important;\n            color: white;\n          }\n          .react-calendar__navigation button {\n            color: #374151;\n            font-weight: 500;\n            font-size: 16px;\n            padding: 8px 16px;\n          }\n          .react-calendar__navigation button:enabled:hover,\n          .react-calendar__navigation button:enabled:focus {\n            background-color: #f3f4f6;\n            border-radius: 8px;\n          }\n          .react-calendar__month-view__weekdays {\n            font-weight: 600;\n            color: #6b7280;\n          }\n        "}),e.jsx(t,{onChange:e=>x(e),value:m,tileContent:({date:t,view:n})=>{if("month"===n){const n=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;if(p.has(n))return e.jsx("span",{className:"inline-block ml-1 w-2 h-2 rounded-full bg-blue-600 align-middle",title:"記録あり"})}return null}})]}),m&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-8",children:[m.toLocaleDateString()," の記録"]}),0===b.length?e.jsx("div",{className:"bg-white rounded-2xl shadow-md p-6 text-center text-gray-500",children:e.jsx("p",{className:"text-lg",children:"この日の記録はありませんわ。"})}):e.jsx("div",{className:"space-y-8",children:Object.entries(v).map(([t,n])=>{return e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6",children:[e.jsxs("div",{className:"text-2xl font-semibold text-gray-800 mb-6 border-b border-gray-200 pb-4 flex items-center gap-2",children:[e.jsx(r,{className:"w-6 h-6 text-blue-600"}),n[0].time]}),e.jsx("ul",{className:"space-y-4",children:(a=n,[...a].sort((e,t)=>{const n=h(e.fieldId),a=h(t.fieldId);return((null==n?void 0:n.order)??999)-((null==a?void 0:a.order)??999)})).map(t=>{const n=h(t.fieldId);return e.jsx("li",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors duration-200",children:"notes"===(null==n?void 0:n.fieldId)?e.jsxs("div",{className:"flex items-stretch gap-2",children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 pr-2 border-r border-gray-200 flex-shrink-0",children:n?n.name:t.fieldId}),e.jsx("div",{className:"text-lg text-gray-800 font-semibold pl-2 flex-1 min-w-0",children:"string"==typeof t.value&&t.value.length>30?e.jsx("button",{onClick:()=>{return e=t.id,void g(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n});var e},className:"text-left hover:text-blue-600 transition-colors break-words w-full",title:"クリックして全文表示",children:(a=t.id,u.has(a)?t.value:f(t.value))}):e.jsx("span",{className:"break-words",children:t.value})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2 items-stretch",children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 text-right pr-2 border-r border-gray-200",children:n?n.name:t.fieldId}),e.jsx("div",{className:"text-lg text-gray-800 font-semibold pl-2 text-left",children:"boolean"==typeof t.value?t.value?e.jsxs("span",{className:"inline-flex items-center gap-2 text-green-600",children:[e.jsx(s,{className:"w-6 h-6"}),"あり"]}):e.jsxs("span",{className:"inline-flex items-center gap-2 text-red-600",children:[e.jsx(l,{className:"w-6 h-6"}),"なし"]}):e.jsxs("span",{className:"break-words",children:[t.value,(null==n?void 0:n.unit)&&"boolean"!=typeof t.value&&e.jsx("span",{className:"text-gray-600 ml-1",children:n.unit})]})})]})},t.id);var a})})]},t);var a})})]})]})}export{d as default};
