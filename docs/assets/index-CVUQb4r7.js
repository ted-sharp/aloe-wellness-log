const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RecordExport-Cc6Tr6B6.js","assets/ui-vendor-C5za43mV.js","assets/react-vendor-DRLO6cO2.js","assets/icons-vendor-DbsR8xvJ.js","assets/dnd-vendor-D_6lbEtB.js","assets/state-vendor-Crk1RRDk.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,r,a)=>((t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a)(t,"symbol"!=typeof r?r+"":r,a);import{j as r,r as a,C as n,R as o,L as l,a as s,X as i,b as d,Y as c,T as u,c as f}from"./ui-vendor-C5za43mV.js";import{d as g,a as m,r as h,g as p,R as x,e as b,f as y,N as v,u as w,L as j,B as k}from"./react-vendor-DRLO6cO2.js";import{G as N}from"./icons-vendor-DbsR8xvJ.js";import{u as S,a as C,b as D,C as I,D as E,c as M,S as T,v as R,d as O,P as L}from"./dnd-vendor-D_6lbEtB.js";import{c as B}from"./state-vendor-Crk1RRDk.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var A,_={};var $=function(){if(A)return _;A=1;var e=g();return _.createRoot=e.createRoot,_.hydrateRoot=e.hydrateRoot,_}();const P={},z={primary:"bg-blue-500 hover:bg-blue-600 focus:ring-blue-500 text-white",success:"bg-green-600 hover:bg-green-700 focus:ring-green-600 text-white",warning:"bg-amber-500 hover:bg-amber-600 focus:ring-amber-500 text-white",danger:"bg-red-600 hover:bg-red-700 focus:ring-red-600 text-white",secondary:"bg-gray-400 hover:bg-gray-500 focus:ring-gray-400 text-white",purple:"bg-purple-600 hover:bg-purple-700 focus:ring-purple-600 text-white",teal:"bg-teal-500 hover:bg-teal-600 focus:ring-teal-500 text-white",sky:"bg-sky-500 hover:bg-sky-600 focus:ring-sky-500 text-white"},H={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},W="rounded-lg font-medium shadow-md transition-all duration-200 flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",F=({variant:e="primary",size:t="md",icon:a,iconPosition:n="left",loading:o=!1,fullWidth:l=!1,className:s="",children:i,disabled:d,...c})=>{const u=d||o,f=[W,z[e],H[t],l?"w-full":"w-auto","hover:shadow-lg",s].join(" "),g="lg"===t?"w-6 h-6":"sm"===t?"w-4 h-4":"w-5 h-5";return r.jsx("button",{className:f,disabled:u,...c,children:o?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`animate-spin rounded-full border-2 border-current border-t-transparent ${g}`}),"読み込み中..."]}):r.jsxs(r.Fragment,{children:[a&&"left"===n&&r.jsx(a,{className:g,"aria-hidden":"true"}),i,a&&"right"===n&&r.jsx(a,{className:g,"aria-hidden":"true"})]})})},Z=({className:e="",onInstall:t,onCancel:a,debug:n=!1})=>{const[o,l]=m.useState(null),[s,i]=m.useState(!1),[d,c]=m.useState(!1),[u,f]=m.useState(!1);m.useEffect(()=>{(()=>{const e=window.matchMedia("(display-mode: standalone)").matches,t=!0===navigator.standalone;(e||t)&&f(!0)})();const e=e=>{e.preventDefault(),l(e),i(!0)},r=()=>{f(!0),i(!1),l(null),null==t||t()};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",r),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",r)}},[t]);return n||u||!s?null:r.jsxs("button",{onClick:async()=>{if(o){c(!0);try{await o.prompt();const{outcome:e}=await o.userChoice;"dismissed"===e&&(null==a||a()),l(null),i(!1)}catch(e){console.error("Installation failed:",e)}finally{c(!1)}}},disabled:d,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 ${e}`,"aria-label":"アプリをインストール",title:"アプリをインストール",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),d?"インストール中...":"アプリをインストール"]})};function V(e){return N({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M2 2h2v2H2z"},child:[]},{tag:"path",attr:{d:"M6 0v6H0V0zM5 1H1v4h4zM4 12H2v2h2z"},child:[]},{tag:"path",attr:{d:"M6 10v6H0v-6zm-5 1v4h4v-4zm11-9h2v2h-2z"},child:[]},{tag:"path",attr:{d:"M10 0v6h6V0zm5 1v4h-4V1zM8 1V0h1v2H8v2H7V1zm0 5V4h1v2zM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8zm0 0v1H2V8H1v1H0V7h3v1zm10 1h-1V7h1zm-1 0h-1v2h2v-1h-1zm-4 0h2v1h-1v1h-1zm2 3v-1h-1v1h-1v1H9v1h3v-2zm0 0h3v1h-2v1h-1zm-4-1v1h1v-2H7v1z"},child:[]},{tag:"path",attr:{d:"M7 12h1v3h4v1H7zm9 2v2h-3v-1h2v-1z"},child:[]}]})(e)}function G(e){return N({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(e)}var K,U,q,Y,Q,X,J,ee,te,re,ae,ne,oe,le,se,ie,de,ce,ue={};function fe(){return U?K:(U=1,K={L:1,M:0,Q:3,H:2})}function ge(){return Y?q:(Y=1,q={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8})}function me(){if(ne)return ae;ne=1;for(var e={glog:function(t){if(t<1)throw new Error("glog("+t+")");return e.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},t=0;t<8;t++)e.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)e.EXP_TABLE[t]=e.EXP_TABLE[t-4]^e.EXP_TABLE[t-5]^e.EXP_TABLE[t-6]^e.EXP_TABLE[t-8];for(t=0;t<255;t++)e.LOG_TABLE[e.EXP_TABLE[t]]=t;return ae=e}function he(){if(le)return oe;le=1;var e=me();function t(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=new Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}return t.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(r){for(var a=new Array(this.getLength()+r.getLength()-1),n=0;n<this.getLength();n++)for(var o=0;o<r.getLength();o++)a[n+o]^=e.gexp(e.glog(this.get(n))+e.glog(r.get(o)));return new t(a,0)},mod:function(r){if(this.getLength()-r.getLength()<0)return this;for(var a=e.glog(this.get(0))-e.glog(r.get(0)),n=new Array(this.getLength()),o=0;o<this.getLength();o++)n[o]=this.get(o);for(o=0;o<r.getLength();o++)n[o]^=e.gexp(e.glog(r.get(o))+a);return new t(n,0).mod(r)}},oe=t}function pe(){if(ce)return de;ce=1;var e=function(){if(X)return Q;X=1;var e=ge();function t(t){this.mode=e.MODE_8BIT_BYTE,this.data=t}return t.prototype={getLength:function(e){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++)e.put(this.data.charCodeAt(t),8)}},Q=t}(),t=function(){if(ee)return J;ee=1;var e=fe();function t(e,t){this.totalCount=e,this.dataCount=t}return t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t.getRSBlocks=function(e,r){var a=t.getRsBlockTable(e,r);if(null==a)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+r);for(var n=a.length/3,o=new Array,l=0;l<n;l++)for(var s=a[3*l+0],i=a[3*l+1],d=a[3*l+2],c=0;c<s;c++)o.push(new t(i,d));return o},t.getRsBlockTable=function(r,a){switch(a){case e.L:return t.RS_BLOCK_TABLE[4*(r-1)+0];case e.M:return t.RS_BLOCK_TABLE[4*(r-1)+1];case e.Q:return t.RS_BLOCK_TABLE[4*(r-1)+2];case e.H:return t.RS_BLOCK_TABLE[4*(r-1)+3];default:return}},J=t}(),r=function(){if(re)return te;function e(){this.buffer=new Array,this.length=0}return re=1,e.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},te=e}(),a=function(){if(ie)return se;ie=1;var e=ge(),t=he(),r=me(),a=0,n=1,o=2,l=3,s=4,i=5,d=6,c=7,u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;u.getBCHDigit(t)-u.getBCHDigit(u.G15)>=0;)t^=u.G15<<u.getBCHDigit(t)-u.getBCHDigit(u.G15);return(e<<10|t)^u.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;u.getBCHDigit(t)-u.getBCHDigit(u.G18)>=0;)t^=u.G18<<u.getBCHDigit(t)-u.getBCHDigit(u.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return u.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case a:return(t+r)%2==0;case n:return t%2==0;case o:return r%3==0;case l:return(t+r)%3==0;case s:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case i:return t*r%2+t*r%3==0;case d:return(t*r%2+t*r%3)%2==0;case c:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var a=new t([1],0),n=0;n<e;n++)a=a.multiply(new t([1,r.gexp(n)],0));return a},getLengthInBits:function(t,r){if(1<=r&&r<10)switch(t){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:case e.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(r<27)switch(t){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(r<41))throw new Error("type:"+r);switch(t){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0;a<t;a++)for(var n=0;n<t;n++){for(var o=0,l=e.isDark(a,n),s=-1;s<=1;s++)if(!(a+s<0||t<=a+s))for(var i=-1;i<=1;i++)n+i<0||t<=n+i||0==s&&0==i||l==e.isDark(a+s,n+i)&&o++;o>5&&(r+=3+o-5)}for(a=0;a<t-1;a++)for(n=0;n<t-1;n++){var d=0;e.isDark(a,n)&&d++,e.isDark(a+1,n)&&d++,e.isDark(a,n+1)&&d++,e.isDark(a+1,n+1)&&d++,0!=d&&4!=d||(r+=3)}for(a=0;a<t;a++)for(n=0;n<t-6;n++)e.isDark(a,n)&&!e.isDark(a,n+1)&&e.isDark(a,n+2)&&e.isDark(a,n+3)&&e.isDark(a,n+4)&&!e.isDark(a,n+5)&&e.isDark(a,n+6)&&(r+=40);for(n=0;n<t;n++)for(a=0;a<t-6;a++)e.isDark(a,n)&&!e.isDark(a+1,n)&&e.isDark(a+2,n)&&e.isDark(a+3,n)&&e.isDark(a+4,n)&&!e.isDark(a+5,n)&&e.isDark(a+6,n)&&(r+=40);var c=0;for(n=0;n<t;n++)for(a=0;a<t;a++)e.isDark(a,n)&&c++;return r+Math.abs(100*c/t/t-50)/5*10}};return se=u}(),n=he();function o(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var l=o.prototype;return l.addData=function(t){var r=new e(t);this.dataList.push(r),this.dataCache=null},l.isDark=function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},l.getModuleCount=function(){return this.moduleCount},l.make=function(){if(this.typeNumber<1){var e=1;for(e=1;e<40;e++){for(var n=t.getRSBlocks(e,this.errorCorrectLevel),o=new r,l=0,s=0;s<n.length;s++)l+=n[s].dataCount;for(s=0;s<this.dataList.length;s++){var i=this.dataList[s];o.put(i.mode,4),o.put(i.getLength(),a.getLengthInBits(i.mode,e)),i.write(o)}if(o.getLengthInBits()<=8*l)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())},l.makeImpl=function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[r][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},l.setupPositionProbePattern=function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(this.modules[e+r][t+a]=0<=r&&r<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=a&&a<=4)},l.getBestMaskPattern=function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var n=a.getLostPoint(this);(0==r||e>n)&&(e=n,t=r)}return t},l.createMovieClip=function(e,t,r){var a=e.createEmptyMovieClip(t,r);this.make();for(var n=0;n<this.modules.length;n++)for(var o=1*n,l=0;l<this.modules[n].length;l++){var s=1*l;this.modules[n][l]&&(a.beginFill(0,100),a.moveTo(s,o),a.lineTo(s+1,o),a.lineTo(s+1,o+1),a.lineTo(s,o+1),a.endFill())}return a},l.setupTimingPattern=function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},l.setupPositionAdjustPattern=function(){for(var e=a.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var n=e[t],o=e[r];if(null==this.modules[n][o])for(var l=-2;l<=2;l++)for(var s=-2;s<=2;s++)this.modules[n+l][o+s]=-2==l||2==l||-2==s||2==s||0==l&&0==s}},l.setupTypeNumber=function(e){for(var t=a.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var n=!e&&1==(t>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=n}for(r=0;r<18;r++){n=!e&&1==(t>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=n}},l.setupTypeInfo=function(e,t){for(var r=this.errorCorrectLevel<<3|t,n=a.getBCHTypeInfo(r),o=0;o<15;o++){var l=!e&&1==(n>>o&1);o<6?this.modules[o][8]=l:o<8?this.modules[o+1][8]=l:this.modules[this.moduleCount-15+o][8]=l}for(o=0;o<15;o++){l=!e&&1==(n>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=l:o<9?this.modules[8][15-o-1+1]=l:this.modules[8][15-o-1]=l}this.modules[this.moduleCount-8][8]=!e},l.mapData=function(e,t){for(var r=-1,n=this.moduleCount-1,o=7,l=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var i=0;i<2;i++)if(null==this.modules[n][s-i]){var d=!1;l<e.length&&(d=1==(e[l]>>>o&1)),a.getMask(t,n,s-i)&&(d=!d),this.modules[n][s-i]=d,-1==--o&&(l++,o=7)}if((n+=r)<0||this.moduleCount<=n){n-=r,r=-r;break}}},o.PAD0=236,o.PAD1=17,o.createData=function(e,n,l){for(var s=t.getRSBlocks(e,n),i=new r,d=0;d<l.length;d++){var c=l[d];i.put(c.mode,4),i.put(c.getLength(),a.getLengthInBits(c.mode,e)),c.write(i)}var u=0;for(d=0;d<s.length;d++)u+=s[d].dataCount;if(i.getLengthInBits()>8*u)throw new Error("code length overflow. ("+i.getLengthInBits()+">"+8*u+")");for(i.getLengthInBits()+4<=8*u&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*u||(i.put(o.PAD0,8),i.getLengthInBits()>=8*u));)i.put(o.PAD1,8);return o.createBytes(i,s)},o.createBytes=function(e,t){for(var r=0,o=0,l=0,s=new Array(t.length),i=new Array(t.length),d=0;d<t.length;d++){var c=t[d].dataCount,u=t[d].totalCount-c;o=Math.max(o,c),l=Math.max(l,u),s[d]=new Array(c);for(var f=0;f<s[d].length;f++)s[d][f]=255&e.buffer[f+r];r+=c;var g=a.getErrorCorrectPolynomial(u),m=new n(s[d],g.getLength()-1).mod(g);i[d]=new Array(g.getLength()-1);for(f=0;f<i[d].length;f++){var h=f+m.getLength()-i[d].length;i[d][f]=h>=0?m.get(h):0}}var p=0;for(f=0;f<t.length;f++)p+=t[f].totalCount;var x=new Array(p),b=0;for(f=0;f<o;f++)for(d=0;d<t.length;d++)f<s[d].length&&(x[b++]=s[d][f]);for(f=0;f<l;f++)for(d=0;d<t.length;d++)f<i[d].length&&(x[b++]=i[d][f]);return x},de=o}var xe,be,ye={};function ve(){if(xe)return ye;xe=1,Object.defineProperty(ye,"__esModule",{value:!0});var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},t=o(a()),r=h(),n=o(r);function o(e){return e&&e.__esModule?e:{default:e}}var l={bgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,bgD:t.default.string.isRequired,fgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,fgD:t.default.string.isRequired,size:t.default.number.isRequired,title:t.default.string,viewBoxSize:t.default.number.isRequired,xmlns:t.default.string},s=(0,r.forwardRef)(function(t,r){var a=t.bgColor,o=t.bgD,l=t.fgD,s=t.fgColor,i=t.size,d=t.title,c=t.viewBoxSize,u=t.xmlns,f=void 0===u?"http://www.w3.org/2000/svg":u,g=function(e,t){var r={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}(t,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return n.default.createElement("svg",e({},g,{height:i,ref:r,viewBox:"0 0 "+c+" "+c,width:i,xmlns:f}),d?n.default.createElement("title",null,d):null,n.default.createElement("path",{d:o,fill:a}),n.default.createElement("path",{d:l,fill:s}))});return s.displayName="QRCodeSvg",s.propTypes=l,ye.default=s,ye}const we=p(function(){if(be)return ue;be=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.QRCode=void 0;var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},t=i(a()),r=i(fe()),n=i(pe()),o=h(),l=i(o),s=i(ve());function i(e){return e&&e.__esModule?e:{default:e}}var d={bgColor:t.default.oneOfType([t.default.object,t.default.string]),fgColor:t.default.oneOfType([t.default.object,t.default.string]),level:t.default.string,size:t.default.number,value:t.default.string.isRequired},c=(0,o.forwardRef)(function(t,a){var o=t.bgColor,i=void 0===o?"#FFFFFF":o,d=t.fgColor,c=void 0===d?"#000000":d,u=t.level,f=void 0===u?"L":u,g=t.size,m=void 0===g?256:g,h=t.value,p=function(e,t){var r={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}(t,["bgColor","fgColor","level","size","value"]),x=new n.default(-1,r.default[f]);x.addData(h),x.make();var b=x.modules;return l.default.createElement(s.default,e({},p,{bgColor:i,bgD:b.map(function(e,t){return e.map(function(e,r){return e?"":"M "+r+" "+t+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:c,fgD:b.map(function(e,t){return e.map(function(e,r){return e?"M "+r+" "+t+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:a,size:m,viewBoxSize:b.length}))});return ue.QRCode=c,c.displayName="QRCode",c.propTypes=d,ue.default=c,ue}()),je=({url:e="https://ted-sharp.github.io/aloe-wellness-log/",className:t=""})=>{const[a,n]=m.useState(!1),o=()=>n(!1);return r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>n(!0),className:`inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:ring-offset-2 transition-colors ${t}`,title:"QRコードを表示",children:[r.jsx(V,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"QRコード"})]}),a&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.3)"},children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 m-4 max-w-sm w-full shadow-xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"QRコードを表示"}),r.jsx("button",{onClick:o,className:"bg-gray-200/80 dark:bg-gray-700/70 text-gray-400 dark:text-gray-300 hover:bg-gray-300/90 dark:hover:bg-gray-600/80 transition-colors rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800","aria-label":"閉じる",children:r.jsx(G,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[r.jsx("div",{className:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-inner border border-gray-200 dark:border-gray-600",children:r.jsx(we,{value:e,size:200,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:"QRコードをスキャン"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 break-all",children:e})]}),r.jsx("button",{onClick:()=>{navigator.clipboard.writeText(e);const t=document.activeElement,r=t.textContent;t.textContent="コピーしました！",setTimeout(()=>{t.textContent=r},2e3)},className:"px-4 py-2 text-sm font-medium text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-700 rounded-md hover:bg-emerald-100 dark:hover:bg-emerald-900/30 focus:outline-none focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:ring-offset-2 transition-colors",children:"URLをコピー"})]}),r.jsx("button",{onClick:o,className:"w-full mt-4 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-2 transition-colors",children:"閉じる"})]})})]})};function ke(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v11.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-4.5 4.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.22 3.22V3a.75.75 0 0 1 .75-.75Zm-9 13.5a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"},child:[]}]})(e)}function Ne(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"},child:[]}]})(e)}function Se(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M12.75 12.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM7.5 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM8.25 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM9.75 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM10.5 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM12.75 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM14.25 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM15 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM16.5 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM15 12.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM16.5 13.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M6.75 2.25A.75.75 0 0 1 7.5 3v1.5h9V3A.75.75 0 0 1 18 3v1.5h.75a3 3 0 0 1 3 3v11.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V7.5a3 3 0 0 1 3-3H6V3a.75.75 0 0 1 .75-.75Zm13.5 9a1.5 1.5 0 0 0-1.5-1.5H5.25a1.5 1.5 0 0 0-1.5 1.5v7.5a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5v-7.5Z",clipRule:"evenodd"},child:[]}]})(e)}function Ce(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 6a3 3 0 0 1 3-3h12a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6Zm4.5 7.5a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-1.5 0v-2.25a.75.75 0 0 1 .75-.75Zm3.75-1.5a.75.75 0 0 0-1.5 0v4.5a.75.75 0 0 0 1.5 0V12Zm2.25-3a.75.75 0 0 1 .75.75v6.75a.75.75 0 0 1-1.5 0V9.75A.75.75 0 0 1 13.5 9Zm3.75-1.5a.75.75 0 0 0-1.5 0v9a.75.75 0 0 0 1.5 0v-9Z",clipRule:"evenodd"},child:[]}]})(e)}function De(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"},child:[]}]})(e)}function Ie(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"},child:[]}]})(e)}function Ee(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z"},child:[]},{tag:"path",attr:{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"},child:[]}]})(e)}function Me(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"},child:[]}]})(e)}function Te(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z"},child:[]},{tag:"path",attr:{d:"M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z"},child:[]},{tag:"path",attr:{d:"M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z"},child:[]}]})(e)}function Re(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z",clipRule:"evenodd"},child:[]}]})(e)}function Oe(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"},child:[]}]})(e)}function Le(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"m6.72 5.66 11.62 11.62A8.25 8.25 0 0 0 6.72 5.66Zm10.56 12.68L5.66 6.72a8.25 8.25 0 0 0 11.62 11.62ZM5.105 5.106c3.807-3.808 9.98-3.808 13.788 0 3.808 3.807 3.808 9.98 0 13.788-3.807 3.808-9.98 3.808-13.788 0-3.808-3.807-3.808-9.98 0-13.788Z",clipRule:"evenodd"},child:[]}]})(e)}function Be(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"},child:[]}]})(e)}function Ae(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"},child:[]}]})(e)}function _e(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z",clipRule:"evenodd"},child:[]}]})(e)}function $e(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z",clipRule:"evenodd"},child:[]}]})(e)}function Pe(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"},child:[]}]})(e)}function ze(e){return N({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"},child:[]}]})(e)}const He=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,We=e=>`${e.getDate()}`,Fe=e=>["日","月","火","水","木","金","土"][e.getDay()],Ze=({selectedDate:e,setSelectedDate:t,centerDate:a,setCenterDate:o,today:l=new Date,isRecorded:s})=>{const[i,d]=m.useState(5),[c,u]=m.useState(!1),f=m.useRef(null),g=m.useRef(null),h=m.useCallback(()=>{const e=window.innerWidth,t=Math.floor((e-64)/64);d(Math.max(5,Math.min(21,t)))},[]);m.useEffect(()=>(h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)),[h]);const p=Math.floor(i/2),b=((e,t)=>{const r=[];for(let a=-t;a<=t;a++){const t=new Date(e);t.setDate(e.getDate()+a),r.push(new Date(t))}return r})(a,p);return m.useEffect(()=>{const e=e=>{if(e.preventDefault(),e.stopPropagation(),e.deltaY<0){const e=new Date(a);e.setDate(a.getDate()+1),o(e)}else if(e.deltaY>0){const e=new Date(a);e.setDate(a.getDate()-1),o(e)}},t=f.current,r=g.current;return t&&t.addEventListener("wheel",e,{passive:!1}),r&&r.addEventListener("wheel",e,{passive:!1}),()=>{t&&t.removeEventListener("wheel",e),r&&r.removeEventListener("wheel",e)}},[a,o]),m.useEffect(()=>{const e=g.current;if(!e)return;let r=null;const a=()=>{r&&window.clearTimeout(r),r=window.setTimeout(()=>{const r=e.querySelectorAll("button[data-date-idx]"),a=e.getBoundingClientRect(),n=a.left+a.width/2;let o=1/0,l=0;r.forEach((e,t)=>{const r=e.getBoundingClientRect(),a=r.left+r.width/2,s=Math.abs(n-a);s<o&&(o=s,l=t)}),b[l]&&t(b[l])},120)};return e.addEventListener("scroll",a),()=>{r&&window.clearTimeout(r),e.removeEventListener("scroll",a)}},[b,t]),r.jsxs("div",{children:[r.jsxs("div",{ref:f,className:"w-full flex items-center justify-center py-6 bg-white/80 dark:bg-gray-900/80 shadow-md sticky top-0 z-10",children:[r.jsx("button",{type:"button",onClick:()=>u(!0),className:"ml-2 mr-1 flex items-center justify-center w-12 h-12 rounded-full border-2 border-blue-400 bg-white dark:bg-gray-800 hover:bg-blue-100 dark:hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400","aria-label":"カレンダーを開く",children:r.jsx(Se,{className:"w-7 h-7 text-blue-600 dark:text-blue-400"})}),r.jsxs("div",{ref:g,className:"flex-1 flex gap-1 mx-1 overflow-x-auto justify-center scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none",scrollSnapType:"x mandatory",WebkitOverflowScrolling:"touch"},children:[r.jsx("style",{children:"\n            .scrollbar-hide::-webkit-scrollbar, .scrollbar-none::-webkit-scrollbar, .scrollbar-fake::-webkit-scrollbar {\n              display: none !important;\n            }\n          "}),b.map((a,n)=>{const o=He(a)===He(e),i=He(a)===He(l),d=n>0?b[n-1]:null,c=0===n||d&&a.getMonth()!==d.getMonth(),u=a.getDay(),f=0===u?"text-red-500":6===u?"text-blue-500":"",g=n===p;return r.jsxs(x.Fragment,{children:[c&&r.jsxs("span",{className:"flex flex-col items-center justify-center min-w-14 w-14 max-w-14 h-14 px-0 py-0 rounded-xl bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 text-xs font-bold select-none cursor-default border border-gray-300 dark:border-gray-600","aria-hidden":"true",children:[a.getMonth()+1,"月"]}),r.jsxs("button",{"data-date-idx":n,onClick:()=>{t(a)},className:`flex flex-col items-center justify-center min-w-14 w-14 max-w-14 h-14 px-0 py-0 rounded-xl border-2 transition-colors duration-150\n                    ${o?"bg-blue-600 text-white border-blue-600":i?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-300 text-gray-700 dark:bg-gray-800 dark:text-gray-200"}\n                    hover:bg-blue-200 dark:hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400\n                    ${g?"border-4 border-blue-400 z-10":""}`,"aria-current":o?"date":void 0,style:{position:"relative",scrollSnapAlign:"center"},children:[r.jsx("span",{className:`text-xs font-medium ${f}`,children:Fe(a)}),r.jsx("span",{className:"text-lg font-bold",children:We(a)}),s&&s(a)&&r.jsx("span",{className:"absolute top-1 right-1 w-1.5 h-1.5 rounded-full bg-green-500 border border-white dark:border-gray-800","aria-label":"記録済み"})]})]},He(a))})]})]}),c&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-4 sm:p-6 w-[95vw] max-w-md relative",onClick:e=>e.stopPropagation(),children:[r.jsx("button",{type:"button",onClick:()=>u(!1),className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 focus:outline-none","aria-label":"閉じる",children:r.jsx("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",children:r.jsx("path",{stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6l12 12M6 18L18 6"})})}),r.jsx(n,{onChange:e=>{t(e),o(e),u(!1)},value:e,locale:"ja-JP",className:"w-full"})]})})]})},Ve=!1,Ge={enableRenderTracking:!0,enableMemoryTracking:!0,enableInteractionTracking:!0,enableDatabaseTracking:!0,sampleRate:.1,reportInterval:3e4};const Ke=new class{constructor(e=Ge){t(this,"metrics",[]),t(this,"maxMetrics",1e3),t(this,"config"),this.config=e}addMetric(e){Math.random()>this.config.sampleRate||(this.metrics.push({...e,timestamp:Date.now()}),this.metrics.length>this.maxMetrics&&(this.metrics=this.metrics.slice(-this.maxMetrics)))}getMetrics(){return[...this.metrics]}getAverageMetrics(e=3e5){const t=Date.now(),r=this.metrics.filter(r=>r.timestamp>t-e);if(0===r.length)return{};const a=r.reduce((e,t)=>({renderTime:e.renderTime+t.renderTime,componentCount:e.componentCount+t.componentCount,reRenderCount:e.reRenderCount+t.reRenderCount,loadTime:e.loadTime+t.loadTime,interactionToNext:e.interactionToNext+t.interactionToNext,inputDelay:e.inputDelay+t.inputDelay,dbOperationTime:e.dbOperationTime+t.dbOperationTime,recordCount:e.recordCount+t.recordCount}),{renderTime:0,componentCount:0,reRenderCount:0,loadTime:0,interactionToNext:0,inputDelay:0,dbOperationTime:0,recordCount:0}),n=r.length;return{renderTime:a.renderTime/n,componentCount:a.componentCount/n,reRenderCount:a.reRenderCount/n,loadTime:a.loadTime/n,interactionToNext:a.interactionToNext/n,inputDelay:a.inputDelay/n,dbOperationTime:a.dbOperationTime/n,recordCount:a.recordCount/n}}clearMetrics(){this.metrics=[]}};class Ue{constructor(){t(this,"renderStartTimes",new Map),t(this,"componentCounts",new Map),t(this,"reRenderCounts",new Map)}startRender(e){}endRender(e){}trackReRender(e,t){}getStats(){const e={};for(const[t,r]of this.componentCounts)e[t]={count:r,reRenders:this.reRenderCounts.get(t)||0};return e}clearStats(){this.renderStartTimes.clear(),this.componentCounts.clear(),this.reRenderCounts.clear()}}class qe{constructor(){t(this,"lastMemoryCheck",0),t(this,"memoryCheckInterval",5e3)}getCurrentMemoryUsage(){try{if("undefined"!=typeof performance&&"memory"in performance){const e=performance.memory;if(e)return{used:Math.round(e.usedJSHeapSize/1024/1024),total:Math.round(e.totalJSHeapSize/1024/1024),limit:Math.round(e.jsHeapSizeLimit/1024/1024)}}}catch(e){}return null}checkMemoryUsage(){const e=Date.now();if(e-this.lastMemoryCheck<this.memoryCheckInterval)return;this.lastMemoryCheck=e;const t=this.getCurrentMemoryUsage();if(t){const e=t.used/t.limit*100;e>80&&(t.used,e.toFixed(1))}}startMemoryMonitoring(){}}class Ye{constructor(){t(this,"operationStartTimes",new Map)}startOperation(e,t){this.operationStartTimes.set(e,performance.now())}endOperation(e,t,r){const a=this.operationStartTimes.get(e);if(a){const t=performance.now()-a;return this.operationStartTimes.delete(e),t>100&&t.toFixed(2),t.toFixed(2),t}return 0}}class Qe{constructor(){t(this,"interactionStartTimes",new Map)}startInteraction(e){const t=`${e}-${Date.now()}`;return this.interactionStartTimes.set(t,performance.now()),t}endInteraction(e,t){const r=this.interactionStartTimes.get(e);if(r){const t=performance.now()-r;return this.interactionStartTimes.delete(e),t>100&&t.toFixed(2),t.toFixed(2),t}return 0}}const Xe=new class{constructor(e=Ge){t(this,"renderTracker",new Ue),t(this,"memoryTracker",new qe),t(this,"dbTracker",new Ye),t(this,"interactionTracker",new Qe),t(this,"config"),t(this,"reportingInterval"),t(this,"trackRender",{start:e=>{this.config.enableRenderTracking&&this.renderTracker.startRender(e)},end:e=>{this.config.enableRenderTracking&&this.renderTracker.endRender(e)},reRender:(e,t)=>{this.config.enableRenderTracking&&this.renderTracker.trackReRender(e,t)}}),t(this,"trackDatabase",{start:(e,t)=>{this.config.enableDatabaseTracking&&this.dbTracker.startOperation(e,t)},end:(e,t,r)=>this.config.enableDatabaseTracking?this.dbTracker.endOperation(e,t,r):0}),t(this,"trackInteraction",{start:e=>this.config.enableInteractionTracking?this.interactionTracker.startInteraction(e):"",end:(e,t)=>this.config.enableInteractionTracking?this.interactionTracker.endInteraction(e,t):0}),this.config=e}startMonitoring(){this.config.enableMemoryTracking&&this.memoryTracker.startMemoryMonitoring()}stopMonitoring(){this.reportingInterval&&(clearInterval(this.reportingInterval),this.reportingInterval=void 0)}getMetrics(){return Ke.getMetrics()}clearMetrics(){Ke.clearMetrics(),this.renderTracker.clearStats()}updateConfig(e){this.config={...this.config,...e}}};function Je(e){const t=[];if("object"!=typeof e||null===e)return t.push("レコードデータが無効です"),{isValid:!1,errors:t};const r=e;var a;return"string"==typeof r.id&&0!==r.id.length||t.push("IDが無効です"),"string"==typeof r.date&&function(e){if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const t=new Date(e);return!isNaN(t.getTime())&&t.toISOString().slice(0,10)===e}(r.date)||t.push("日付形式が無効です (YYYY-MM-DD)"),"string"==typeof r.time&&(a=r.time,/^([01]\d|2[0-3]):([0-5]\d)$/.test(a))||t.push("時刻形式が無効です (HH:mm)"),"string"==typeof r.datetime&&0!==r.datetime.length||t.push("日時が無効です"),"string"==typeof r.fieldId&&0!==r.fieldId.length||t.push("フィールドIDが無効です"),void 0===r.value?t.push("値が設定されていません"):"number"!=typeof r.value&&"string"!=typeof r.value&&"boolean"!=typeof r.value&&t.push("値の型が無効です"),{isValid:0===t.length,data:0===t.length?r:void 0,errors:t}}const et="records",tt="fields",rt="goal";var at=(e=>(e.CONNECTION_FAILED="connection_failed",e.TRANSACTION_FAILED="transaction_failed",e.DATA_CORRUPTED="data_corrupted",e.QUOTA_EXCEEDED="quota_exceeded",e.VERSION_ERROR="version_error",e.UNKNOWN="unknown",e))(at||{});class nt extends Error{constructor(e,t,r,a=!0){super(t),this.type=e,this.originalError=r,this.retryable=a,this.name="DbError"}}async function ot(e,t,r){const a=`${e}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;Xe.trackDatabase.start(a,e);try{const n=await t();Xe.trackDatabase.end(a,e,r);return n}catch(n){throw Xe.trackDatabase.end(a,e,r),n}}function lt(e){if(e instanceof nt)return e;if(e instanceof DOMException)switch(e.name){case"QuotaExceededError":return new nt("quota_exceeded","ストレージ容量が不足しています",e,!1);case"VersionError":return new nt("version_error","データベースのバージョンが競合しています",e,!1);case"InvalidStateError":case"TransactionInactiveError":return new nt("transaction_failed","データベーストランザクションが失敗しました",e);case"DataError":case"ConstraintError":return new nt("data_corrupted","データが破損しているか、制約違反です",e,!1);default:return new nt("unknown",`データベースエラー: ${e.message}`,e)}return new nt("connection_failed","データベース接続に失敗しました",e)}async function st(e,t=3,r=1e3){let a;for(let o=1;o<=t;o++)try{return await e()}catch(n){if(a=lt(n),!a.retryable)throw a;if(o===t)throw a;await new Promise(e=>setTimeout(e,r*o))}throw a}function it(e){const t=function(e){const t=[],r=[];return e.forEach((e,a)=>{const n=Je(e);n.isValid&&n.data?r.push(n.data):t.push(`レコード[${a}]: ${n.errors.join(", ")}`)}),{isValid:0===t.length,data:r,errors:t}}(e);return t.isValid||t.errors,t.data||[]}async function dt(e,t,r){return st(async()=>{const a=await st(()=>new Promise((e,t)=>{try{const r=indexedDB.open("aloe-wellness-log",3);r.onupgradeneeded=()=>{const e=r.result;if(!e.objectStoreNames.contains(et)){const t=e.createObjectStore(et,{keyPath:"id"});t.createIndex("dateIndex","date",{unique:!1}),t.createIndex("fieldIdIndex","fieldId",{unique:!1}),t.createIndex("scopeIndex","scope",{unique:!1})}e.objectStoreNames.contains(tt)||e.createObjectStore(tt,{keyPath:"fieldId"}).createIndex("orderIndex","order",{unique:!1}),e.objectStoreNames.contains(rt)||e.createObjectStore(rt,{keyPath:"id"})},r.onsuccess=()=>{const t=r.result;t.onerror=e=>{console.error("Database error:",e)},t.onclose=()=>{},e(t)},r.onerror=()=>{t(new nt("connection_failed","データベースを開けませんでした",r.error))},r.onblocked=()=>{t(new nt("connection_failed","データベースが他のタブによってブロックされています",void 0,!1))}}catch(r){t(lt(r))}}));return new Promise((n,o)=>{try{const l=a.transaction(e,t),s=setTimeout(()=>{l.abort(),o(new nt("transaction_failed","トランザクションがタイムアウトしました"))},3e4);l.oncomplete=()=>{clearTimeout(s)},l.onerror=()=>{clearTimeout(s),o(lt(l.error))},l.onabort=()=>{clearTimeout(s),o(new nt("transaction_failed","トランザクションが中断されました"))};const i=Array.isArray(e)?e.map(e=>l.objectStore(e)):l.objectStore(e);r(l,i).then(n).catch(o)}catch(l){o(lt(l))}})})}async function ct(){return ot("get-all-fields",async()=>dt(tt,"readonly",async(e,t)=>{const r=t;return new Promise((e,t)=>{const a=r.getAll();a.onsuccess=()=>{const t=a.result;if(Array.isArray(t)){const r=function(e){const t=function(e){const t=[],r=[];return e.forEach((e,a)=>{const n=function(e){const t=[];if("object"!=typeof e||null===e)return t.push("フィールドデータが無効です"),{isValid:!1,errors:t};const r=e;if("string"==typeof r.fieldId&&0!==r.fieldId.length||t.push("フィールドIDが無効です"),"string"==typeof r.name&&0!==r.name.length||t.push("フィールド名が無効です"),"string"==typeof r.type&&["number","string","boolean"].includes(r.type)||t.push("フィールドタイプが無効です"),void 0!==r.unit&&"string"!=typeof r.unit&&t.push("単位が無効です"),void 0!==r.order&&"number"!=typeof r.order&&t.push("表示順序が無効です"),void 0!==r.defaultDisplay&&"boolean"!=typeof r.defaultDisplay&&t.push("デフォルト表示設定が無効です"),void 0!==r.default&&"string"==typeof r.type)switch(r.type){case"number":"number"!=typeof r.default&&t.push("デフォルト値が数値型と一致しません");break;case"string":"string"!=typeof r.default&&t.push("デフォルト値が文字列型と一致しません");break;case"boolean":"boolean"!=typeof r.default&&t.push("デフォルト値がブール型と一致しません")}return{isValid:0===t.length,data:0===t.length?r:void 0,errors:t}}(e);n.isValid&&n.data?r.push(n.data):t.push(`フィールド[${a}]: ${n.errors.join(", ")}`)}),{isValid:0===t.length,data:r,errors:t}}(e);return t.isValid||t.errors,t.data||[]}(t);e(r)}else e([])},a.onerror=()=>t(lt(a.error))})}))}async function ut(e){return ot("batch-update-fields",async()=>dt(tt,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{let n=0;const o=e.length;if(0===o)return void t();const l=()=>{n++,n===o&&t()};for(const s of e){const e=a.put(s);e.onsuccess=l,e.onerror=()=>r(lt(e.error))}})}),e.length)}const ft=[{fieldId:"weight",unit:"kg",type:"number",order:1,defaultDisplay:!0,scope:"weight"},{fieldId:"body_fat",unit:"%",type:"number",order:1.5,defaultDisplay:!1,scope:"weight"},{fieldId:"systolic_bp",unit:"mmHg",type:"number",order:1,defaultDisplay:!0,scope:"bp"},{fieldId:"diastolic_bp",unit:"mmHg",type:"number",order:2,defaultDisplay:!0,scope:"bp"},{fieldId:"heart_rate",unit:"bpm",type:"number",order:4,defaultDisplay:!1,scope:"bp"},{fieldId:"body_temperature",unit:"℃",type:"number",order:5,defaultDisplay:!1,scope:"bp"},{fieldId:"exercise",type:"boolean",order:6,defaultDisplay:!0,scope:"daily"},{fieldId:"meal",type:"boolean",order:7,defaultDisplay:!0,scope:"daily"},{fieldId:"sleep",type:"boolean",order:8,defaultDisplay:!0,scope:"daily"},{fieldId:"smoke",type:"boolean",order:9,defaultDisplay:!1,scope:"daily"},{fieldId:"alcohol",type:"boolean",order:10,defaultDisplay:!1,scope:"daily"}],gt=[{fieldId:"weight",name:"体重",unit:"kg",type:"number",order:1,defaultDisplay:!0,scope:"weight"},{fieldId:"body_fat",name:"体脂肪",unit:"%",type:"number",order:1.5,defaultDisplay:!1,scope:"weight"},{fieldId:"systolic_bp",name:"最高血圧",unit:"mmHg",type:"number",order:1,defaultDisplay:!0,scope:"bp"},{fieldId:"diastolic_bp",name:"最低血圧",unit:"mmHg",type:"number",order:2,defaultDisplay:!0,scope:"bp"},{fieldId:"heart_rate",name:"心拍数",unit:"bpm",type:"number",order:4,defaultDisplay:!1,scope:"bp"},{fieldId:"body_temperature",name:"体温",unit:"℃",type:"number",order:5,defaultDisplay:!1,scope:"bp"},{fieldId:"exercise",name:"運動(早歩き)",type:"boolean",order:6,defaultDisplay:!0,scope:"daily"},{fieldId:"meal",name:"減食",type:"boolean",order:7,defaultDisplay:!0,scope:"daily"},{fieldId:"sleep",name:"睡眠(早寝)",type:"boolean",order:8,defaultDisplay:!0,scope:"daily"},{fieldId:"smoke",name:"禁煙",type:"boolean",order:9,defaultDisplay:!1,scope:"daily"},{fieldId:"alcohol",name:"節酒",type:"boolean",order:10,defaultDisplay:!1,scope:"daily"}],mt=B((e,t)=>({records:[],fields:[],recordsOperation:{loading:!1,error:null},fieldsOperation:{loading:!1,error:null},clearRecordsError:()=>{e(e=>({recordsOperation:{...e.recordsOperation,error:null}}))},clearFieldsError:()=>{e(e=>({fieldsOperation:{...e.fieldsOperation,error:null}}))},loadRecords:async()=>{e(e=>({recordsOperation:{loading:!0,error:null}}));try{const t=await async function(){return ot("get-all-records",async()=>dt(et,"readonly",async(e,t)=>{const r=t;return new Promise((e,t)=>{const a=r.getAll();a.onsuccess=()=>{const t=a.result;if(Array.isArray(t)){const r=it(t);e(r)}else e([])},a.onerror=()=>t(lt(a.error))})}))}();e({records:t,recordsOperation:{loading:!1,error:null}})}catch(t){const r=t instanceof nt?t:new nt(at.UNKNOWN,"レコード読み込みに失敗しました",t);throw e(e=>({recordsOperation:{loading:!1,error:r}})),r}},addRecord:async t=>{e(e=>({records:[...e.records,t],recordsOperation:{loading:!0,error:null}}));try{await async function(e){return ot("add-record",async()=>dt(et,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.put(e);n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}),1)}(t),e(e=>({recordsOperation:{loading:!1,error:null}}))}catch(r){throw e(e=>({records:e.records.filter(e=>e.id!==t.id),recordsOperation:{loading:!1,error:r instanceof nt?r:new nt(at.UNKNOWN,"レコード追加に失敗しました",r)}})),r}},loadFields:async()=>{e(e=>({fieldsOperation:{loading:!0,error:null}}));try{let t=await ct(),r=!1;const a={weight:1,body_fat:1.5,systolic_bp:1,diastolic_bp:2,heart_rate:4,body_temperature:5,exercise:6,meal:7,sleep:8,smoke:9,alcohol:10},n={weight:!0,body_fat:!1,systolic_bp:!0,diastolic_bp:!0,heart_rate:!1,body_temperature:!1,exercise:!0,meal:!0,sleep:!0,smoke:!1,alcohol:!1},o=t.map(e=>{const t={...e};if(void 0===e.order){const n=a[e.fieldId];r=!0,t.order=n||999}if(void 0===e.defaultDisplay){r=!0;const a=n[e.fieldId];t.defaultDisplay=void 0===a||a}return t});r&&(await ut(o),t=o),e({fields:t,fieldsOperation:{loading:!1,error:null}})}catch(t){const r=t instanceof nt?t:new nt(at.UNKNOWN,"フィールド読み込みに失敗しました",t);throw e(e=>({fieldsOperation:{loading:!1,error:r}})),r}},addField:async t=>{e(e=>({fields:[...e.fields,t],fieldsOperation:{loading:!0,error:null}}));try{await async function(e){return ot("add-field",async()=>dt(tt,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.put(e);n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}),1)}(t),e(e=>({fieldsOperation:{loading:!1,error:null}}))}catch(r){throw e(e=>({fields:e.fields.filter(e=>e.fieldId!==t.fieldId),fieldsOperation:{loading:!1,error:r instanceof nt?r:new nt(at.UNKNOWN,"フィールド追加に失敗しました",r)}})),r}},initializeFields:async()=>{0===(await ct()).length&&(await ut(gt),e({fields:gt}))},initializeFieldsWithTranslation:async t=>{e(e=>({fieldsOperation:{loading:!0,error:null}}));try{const r=await ct();if(0===r.length){const r=ft.map(e=>({...e,name:t(e.fieldId)}));await ut(r),e({fields:r,fieldsOperation:{loading:!1,error:null}})}else e({fields:r,fieldsOperation:{loading:!1,error:null}})}catch(r){const t=r instanceof nt?r:new nt(at.UNKNOWN,"フィールド初期化に失敗しました",r);throw e(e=>({fieldsOperation:{loading:!1,error:t}})),t}},updateField:async r=>{const a=t().fields;e(e=>({fields:e.fields.map(e=>e.fieldId===r.fieldId?r:e),fieldsOperation:{loading:!0,error:null}}));try{await async function(e){return ot("update-field",async()=>dt(tt,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.put(e);n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}),1)}(r),e(e=>({fieldsOperation:{loading:!1,error:null}}))}catch(n){throw e({fields:a,fieldsOperation:{loading:!1,error:n instanceof nt?n:new nt(at.UNKNOWN,"フィールド更新に失敗しました",n)}}),n}},updateRecord:async r=>{const a=t().records;e(e=>({records:e.records.map(e=>e.id===r.id?r:e),recordsOperation:{loading:!0,error:null}}));try{await async function(e){return ot("update-record",async()=>dt(et,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.put(e);n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}),1)}(r),e(e=>({recordsOperation:{loading:!1,error:null}}))}catch(n){throw e({records:a,recordsOperation:{loading:!1,error:n instanceof nt?n:new nt(at.UNKNOWN,"レコード更新に失敗しました",n)}}),n}},deleteRecord:async r=>{const a=t().records,n=a.find(e=>e.id===r);e(e=>({records:e.records.filter(e=>e.id!==r),recordsOperation:{loading:!0,error:null}}));try{await async function(e){return ot("delete-record",async()=>dt(et,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.delete(e);n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}),1)}(r),e(e=>({recordsOperation:{loading:!1,error:null}}))}catch(o){throw e({records:n?[...a]:a,recordsOperation:{loading:!1,error:o instanceof nt?o:new nt(at.UNKNOWN,"レコード削除に失敗しました",o)}}),o}},deleteField:async r=>{const a=t().fields,n=a.find(e=>e.fieldId===r);e(e=>({fields:e.fields.filter(e=>e.fieldId!==r),fieldsOperation:{loading:!0,error:null}}));try{await async function(e){return ot("delete-field",async()=>dt(tt,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.delete(e);n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}),1)}(r),e(e=>({fieldsOperation:{loading:!1,error:null}}))}catch(o){throw e({fields:n?[...a]:a,fieldsOperation:{loading:!1,error:o instanceof nt?o:new nt(at.UNKNOWN,"フィールド削除に失敗しました",o)}}),o}},deleteAllRecords:async()=>{const r=t().records;e({records:[],recordsOperation:{loading:!0,error:null}});try{await async function(){return ot("delete-all-records",async()=>dt(et,"readwrite",async(e,t)=>{const r=t;return new Promise((e,t)=>{const a=r.clear();a.onsuccess=()=>e(),a.onerror=()=>t(lt(a.error))})}))}(),e(e=>({recordsOperation:{loading:!1,error:null}}))}catch(a){throw e({records:r,recordsOperation:{loading:!1,error:a instanceof nt?a:new nt(at.UNKNOWN,"全レコード削除に失敗しました",a)}}),a}},deleteAllFields:async()=>{const r=t().fields;e({fields:[],fieldsOperation:{loading:!0,error:null}});try{await async function(){return ot("delete-all-fields",async()=>dt(tt,"readwrite",async(e,t)=>{const r=t;return new Promise((e,t)=>{const a=r.clear();a.onsuccess=()=>e(),a.onerror=()=>t(lt(a.error))})}))}(),e(e=>({fieldsOperation:{loading:!1,error:null}}))}catch(a){throw e({fields:r,fieldsOperation:{loading:!1,error:a instanceof nt?a:new nt(at.UNKNOWN,"全フィールド削除に失敗しました",a)}}),a}},deleteAllData:async()=>{const r=t().records,a=t().fields;e({records:[],fields:[],recordsOperation:{loading:!0,error:null},fieldsOperation:{loading:!0,error:null}});try{await async function(){return ot("delete-all-data",async()=>dt([et,tt],"readwrite",async(e,t)=>{const[r,a]=t;return new Promise((e,t)=>{let n=0;const o=()=>{n++,2===n&&e()},l=r.clear();l.onsuccess=o,l.onerror=()=>t(lt(l.error));const s=a.clear();s.onsuccess=o,s.onerror=()=>t(lt(s.error))})}))}(),e({recordsOperation:{loading:!1,error:null},fieldsOperation:{loading:!1,error:null}})}catch(n){const t=n instanceof nt?n:new nt(at.UNKNOWN,"全データ削除に失敗しました",n);throw e({records:r,fields:a,recordsOperation:{loading:!1,error:t},fieldsOperation:{loading:!1,error:t}}),n}},batchUpdateRecords:async r=>{const a=t().records,n=new Map(a.map(e=>[e.id,e]));r.forEach(e=>{n.set(e.id,e)}),e({records:Array.from(n.values()),recordsOperation:{loading:!0,error:null}});try{await async function(e){return ot("batch-update-records",async()=>dt(et,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{let n=0;const o=e.length;if(0===o)return void t();const l=()=>{n++,n===o&&t()};for(const s of e){const e=a.put(s);e.onsuccess=l,e.onerror=()=>r(lt(e.error))}})}),e.length)}(r),e(e=>({recordsOperation:{loading:!1,error:null}}))}catch(o){throw e({records:a,recordsOperation:{loading:!1,error:o instanceof nt?o:new nt(at.UNKNOWN,"バッチレコード更新に失敗しました",o)}}),o}},batchUpdateFields:async r=>{const a=t().fields,n=new Map(a.map(e=>[e.fieldId,e]));r.forEach(e=>{n.set(e.fieldId,e)}),e({fields:Array.from(n.values()),fieldsOperation:{loading:!0,error:null}});try{await ut(r),e(e=>({fieldsOperation:{loading:!1,error:null}}))}catch(o){throw e({fields:a,fieldsOperation:{loading:!1,error:o instanceof nt?o:new nt(at.UNKNOWN,"バッチフィールド更新に失敗しました",o)}}),o}}})),ht=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,pt=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`,xt=()=>{const e=new Date,[t,a]=m.useState(e),[n,o]=m.useState(e),{fields:l,addRecord:s,updateRecord:i,deleteRecord:d,records:c,addField:u,loadRecords:f,deleteField:g,updateField:h,loadFields:p}=mt(),[b,y]=m.useState(!1),[v,w]=m.useState(""),[j,k]=m.useState(""),[N,B]=m.useState(!1),A=N?l.filter(e=>"boolean"===e.type).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId)):l.filter(e=>"boolean"===e.type&&e.defaultDisplay).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId)),[_,$]=m.useState(()=>A.map(e=>({...e}))),[P,z]=m.useState(()=>A.map(e=>e.fieldId)),[H,W]=m.useState([]),Z=S(C(L)),V=ht(n),G=(K=n,`${String(K.getHours()).padStart(2,"0")}:${String(K.getMinutes()).padStart(2,"0")}`);var K;const U=e=>c.find(t=>t.fieldId===e&&t.date===V),q=e=>{const t=ht(e),r=l.filter(e=>"daily"===e.scope).map(e=>e.fieldId);return c.some(e=>e.date===t&&r.includes(e.fieldId))},Y=async(e,t)=>{const r=U(e);if(r&&r.value===t)await d(r.id),await f();else if(r)await i({...r,value:t}),await f();else{const r=new Date,a=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;await s({id:a,fieldId:e,value:t,date:V,time:G,datetime:pt(r)}),await f()}};m.useEffect(()=>{if(N){const e=l.filter(e=>"boolean"===e.type).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId));$(e.map(e=>({...e}))),z(e.map(e=>e.fieldId)),W([])}},[N]);const[Q,X]=m.useState(null),J=m.useRef({}),ee=m.useRef({});m.useEffect(()=>{if(!Q)return;const e=J.current[Q];if(e){const t=ee.current[Q]??{start:e.value.length,end:e.value.length};e.setSelectionRange(t.start,t.end)}},[Q]);const te=x.memo(function({field:e,isEditing:t,onStartEdit:a,onEndEdit:n,onNameChange:o,onDelete:l,onToggleDisplay:s,inputRef:i}){const{attributes:d,listeners:c,setNodeRef:u,transform:f,transition:g,isDragging:m}=D({id:e.fieldId}),h={...m?{transform:I.Transform.toString(f),transition:g}:{},opacity:m?.5:1,background:m?"#f3f4f6":void 0},[p,b]=x.useState(e.name);return x.useEffect(()=>{t&&b(e.name)},[t,e.name]),r.jsxs("div",{ref:u,style:h,className:"flex items-center gap-2 rounded-xl shadow p-4 mb-2 transition-colors "+(!1===e.defaultDisplay?"bg-gray-100 dark:bg-gray-700 text-gray-400":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200"),children:[t?r.jsx("input",{ref:i,type:"text",value:p,onChange:t=>{b(t.target.value);const r=t.target.selectionStart??t.target.value.length,a=t.target.selectionEnd??t.target.value.length;ee.current[e.fieldId]={start:r,end:a}},onSelect:t=>{const r=t.target;ee.current[e.fieldId]={start:r.selectionStart??r.value.length,end:r.selectionEnd??r.value.length}},onBlur:()=>{o(p),n()},onKeyDown:e=>{"Enter"===e.key&&(o(p),n())},className:"flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 text-lg font-semibold min-w-[5em] bg-inherit "+(!1===e.defaultDisplay?"border-gray-200 dark:border-gray-600 text-gray-400 bg-gray-50 dark:bg-gray-800":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200")}):r.jsx("span",{className:"flex-1 text-lg font-semibold min-w-[5em] cursor-pointer",onClick:a,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||a()},role:"button","aria-label":"項目名を編集",tabIndex:0,children:e.name}),r.jsx("button",{type:"button",onClick:()=>{window.confirm("本当に削除しますか？\n（保存すると確定されます。）")&&l()},className:"text-red-500 hover:text-red-700 p-2","aria-label":"削除",children:r.jsx($e,{className:"w-6 h-6"})}),r.jsx("button",{type:"button",onClick:s,className:"p-2 "+(!1===e.defaultDisplay?"text-gray-400 hover:text-blue-400":"text-blue-500 hover:text-blue-700"),"aria-label":!1===e.defaultDisplay?"表示項目にする":"非表示項目にする",children:!1===e.defaultDisplay?r.jsx(Te,{className:"w-6 h-6"}):r.jsx(Re,{className:"w-6 h-6"})}),r.jsx("span",{className:"cursor-move p-2","aria-label":"並び替えハンドル",style:{touchAction:"none"},...d,...c,tabIndex:0,children:r.jsx(Ne,{className:"w-6 h-6 text-gray-400"})})]})}),re=m.useCallback(e=>{W(t=>[...t,e]),$(t=>t.filter(t=>t.fieldId!==e)),z(t=>t.filter(t=>t!==e))},[]),ae=m.useCallback(e=>{$(t=>t.map(t=>t.fieldId===e?{...t,defaultDisplay:!t.defaultDisplay}:t))},[]);return r.jsxs("div",{className:"bg-transparent",children:[r.jsx(Ze,{selectedDate:n,setSelectedDate:o,centerDate:t,setCenterDate:a,isRecorded:q}),r.jsx("div",{className:"w-full max-w-md mx-auto mt-3 mb-3 flex justify-start pl-4",children:r.jsxs("span",{className:"text-lg sm:text-xl font-bold text-gray-800 dark:text-white",children:[ht(n),q(n)&&r.jsx(Ie,{className:"inline-block w-6 h-6 text-green-500 ml-2 align-middle","aria-label":"入力済み"})]})}),r.jsxs("div",{className:"flex flex-col items-center justify-start min-h-[60vh]",children:[r.jsx("div",{className:"flex flex-col gap-6 w-full max-w-md",children:N?r.jsx(E,{sensors:Z,collisionDetection:M,onDragEnd:e=>{const{active:t,over:r}=e;if(!r)return;const a=String(t.id),n=String(r.id);if(a!==n){const e=P.indexOf(a),t=P.indexOf(n);z(O(P,e,t))}},children:r.jsx(T,{items:P,strategy:R,children:P.map(e=>{const t=_.find(t=>t.fieldId===e);if(!t)return null;const a=Q===t.fieldId;return r.jsx(te,{field:t,isEditing:a,onStartEdit:()=>X(t.fieldId),onEndEdit:()=>X(null),onNameChange:e=>$(r=>r.map(r=>r.fieldId===t.fieldId?{...r,name:e}:r)),onDelete:()=>re(t.fieldId),onToggleDisplay:()=>ae(t.fieldId),inputRef:e=>J.current[t.fieldId]=e},t.fieldId)})})}):A.map(e=>{const t=(e=>{const t=U(e);return"boolean"==typeof(null==t?void 0:t.value)?t.value:void 0})(e.fieldId);return r.jsxs("div",{className:"flex items-center gap-4 bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[r.jsx("span",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200 min-w-[5em]",children:e.name}),r.jsx(F,{variant:!0===t?"primary":"secondary",size:"md",onClick:async()=>{if(!0===t){const t=U(e.fieldId);t&&(await d(t.id),await f())}else await Y(e.fieldId,!0)},"aria-pressed":!0===t,className:"flex-1",children:"あり"}),r.jsx(F,{variant:!1===t?"primary":"secondary",size:"md",onClick:async()=>{if(!1===t){const t=U(e.fieldId);t&&(await d(t.id),await f())}else await Y(e.fieldId,!1)},"aria-pressed":!1===t,className:"flex-1",children:"なし"})]},e.fieldId)})}),N&&r.jsxs("div",{className:"w-full max-w-md mt-6 mb-2",children:[b?r.jsxs("div",{className:"flex items-center gap-2 mb-2 bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[r.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"新しい項目名",maxLength:20}),r.jsx(F,{variant:"primary",size:"md",icon:Ie,"aria-label":"保存",onClick:async()=>{k("");const e=v.trim();if(!e)return void k("項目名を入力してください");if(l.some(t=>t.name===e))return void k("同じ名前の項目が既に存在します");const t=`custom_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,r={fieldId:t,name:e,type:"boolean",order:10*(l.length+1),defaultDisplay:!0,scope:"daily"};await u(r),N&&($(e=>[...e,{...r}]),z(e=>[...e,t])),y(!1),w("")},disabled:!v.trim(),children:""}),r.jsx(F,{variant:"secondary",size:"md",icon:ze,"aria-label":"キャンセル",onClick:()=>{y(!1),w(""),k("")},children:""})]}):r.jsx(F,{variant:"teal",size:"md",icon:Ae,fullWidth:!0,onClick:()=>y(!0),children:"新規項目"}),j&&r.jsx("div",{className:"text-red-500 text-sm mt-1",children:j})]}),r.jsx("div",{className:"w-full max-w-md mt-6",children:N?r.jsxs("div",{className:"flex gap-2",children:[r.jsx(F,{variant:"success",size:"md",icon:De,onClick:async()=>{for(const e of H)await g(e);for(let e=0;e<P.length;++e){const t=_.find(t=>t.fieldId===P[e]);t&&await h({...t,order:10*e})}await p(),B(!1)},fullWidth:!0,children:"保存"}),r.jsx(F,{variant:"secondary",size:"md",icon:ze,onClick:()=>{B(!1)},fullWidth:!0,children:"キャンセル"})]}):r.jsx(F,{variant:"teal",size:"md",icon:Be,fullWidth:!0,onClick:()=>B(!0),children:"編集"})})]})]})},bt=B(e=>({goal:null,setGoal:async t=>{await async function(e){return ot("set-goal",async()=>dt(rt,"readwrite",async(t,r)=>{const a=r;return new Promise((t,r)=>{const n=a.put({...e,id:"singleton"});n.onsuccess=()=>t(),n.onerror=()=>r(lt(n.error))})}))}(t),e({goal:t})},clearGoal:async()=>{await async function(){return ot("clear-goal",async()=>dt(rt,"readwrite",async(e,t)=>{const r=t;return new Promise((e,t)=>{const a=r.delete("singleton");a.onsuccess=()=>e(),a.onerror=()=>t(lt(a.error))})}))}(),e({goal:null})},loadGoal:async()=>{const t=await async function(){return ot("get-goal",async()=>dt(rt,"readonly",async(e,t)=>{const r=t;return new Promise((e,t)=>{const a=r.get("singleton");a.onsuccess=()=>{const t=a.result;if(t&&"object"==typeof t){const{id:r,...a}=t;e(a)}else e(null)},a.onerror=()=>t(lt(a.error))})}))}();e({goal:t})}})),yt=(new Date).getFullYear(),vt=["毎日ラジオ体操(第2まで)をする","なるべく階段を使う","通勤で早歩きする","一駅歩く","毎日30分歩く","毎日5000歩歩く","毎日ジョギングをする"],wt=["清涼飲料水を 0 cal にする","間食、夜食を控える","野菜を多く食べる","よく噛んで20分以上かける","夜はお米を食べない","毎食ご飯を半分にする"],jt=["7時間以上寝る","23時までに就寝する","就寝90分前に入浴し体温調節をする","寝室の温度を 18–22 ℃ に保つ","寝室の照明を 300 lx 以下に落とす","寝る前にスマホを見ない"],kt=["家では吸わない","会社では吸わない","電子タバコへ移行し本数を半減する","1週間に1本ずつ減らす","禁煙外来に通う"],Nt=["休肝日を作る","1日1杯までにする","週2回までにする","飲み会は月1回まで","ノンアルコール飲料にする"],St=[{value:"male",label:"男性"},{value:"female",label:"女性"},{value:"unknown",label:"未回答"}];function Ct(){const{goal:e,setGoal:t,loadGoal:a}=bt(),{records:n}=mt(),[o,l]=m.useState("unknown"),[s,i]=m.useState(""),[d,c]=m.useState(""),[u,f]=m.useState(""),[g,h]=m.useState(""),[p,x]=m.useState(""),[b,y]=m.useState(""),[v,w]=m.useState(""),[j,k]=m.useState(""),[N,S]=m.useState(""),[C,D]=m.useState(""),[I,E]=m.useState(""),[M,T]=m.useState(!1),[R,O]=m.useState(!1),[L,B]=m.useState(!1),[A,_]=m.useState(!1),[$,P]=m.useState(!1),z=m.useRef(null),H=m.useRef(null),W=m.useRef(null),Z=m.useRef(null),V=m.useRef(null);m.useEffect(()=>{a().then(()=>{e?(l(e.gender||"unknown"),i(e.birthYear.toString()),c(e.height.toString()),f(void 0!==e.startWeight?e.startWeight.toString():null!==K?K.toString():""),h(e.targetStart),x(e.targetEnd),y(e.targetWeight.toString()),w(e.exerciseGoal||""),k(e.dietGoal||""),S(e.sleepGoal||""),D(e.smokingGoal||""),E(e.alcoholGoal||"")):f(null!==K?K.toString():"")})},[]),m.useEffect(()=>{e&&(l(e.gender||"unknown"),i(e.birthYear.toString()),c(e.height.toString()),f(void 0!==e.startWeight?e.startWeight.toString():null!==K?K.toString():""),h(e.targetStart),x(e.targetEnd),y(e.targetWeight.toString()),w(e.exerciseGoal||""),k(e.dietGoal||""),S(e.sleepGoal||""),D(e.smokingGoal||""),E(e.alcoholGoal||""))},[e]);m.useEffect(()=>{o&&s&&d&&u&&g&&p&&b&&!(!s||isNaN(Number(s))||Number(s)<1900||Number(s)>yt||(!d||isNaN(Number(d))||Number(d)<100||Number(d)>250||(!u||isNaN(Number(u))||Number(u)<30||Number(u)>200||(!g||!/^\d{4}-\d{2}-\d{2}$/.test(g)||(!p||!/^\d{4}-\d{2}-\d{2}$/.test(p)||(g>p||!!(!b||isNaN(Number(b))||Number(b)<30||Number(b)>200)))))))&&t({gender:o,birthYear:Number(s),height:Number(d),startWeight:Number(u),targetStart:g,targetEnd:p,targetWeight:Number(b),exerciseGoal:v,dietGoal:j,sleepGoal:N,smokingGoal:C,alcoholGoal:I})},[o,s,d,u,g,p,b,v,j,N,C,I]);const G=Number(d)||170,K=(()=>{const e=n.filter(e=>"weight"===e.fieldId&&"number"==typeof e.value).sort((e,t)=>{const r=e.datetime||`${e.date}T${e.time}`;return(t.datetime||`${t.date}T${t.time}`).localeCompare(r)});return e.length>0?Number(e[0].value):null})();m.useEffect(()=>{if(!M)return;const e=e=>{const t=document.querySelector('[aria-label="運動目標の例を表示"]'),r=z.current;t&&!t.contains(e.target)&&r&&!r.contains(e.target)&&T(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[M]),m.useEffect(()=>{if(R){const e=e=>{const t=document.querySelector('[aria-label="減食目標の例を表示"]'),r=H.current;t&&!t.contains(e.target)&&r&&!r.contains(e.target)&&O(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[R]),m.useEffect(()=>{if(L){const e=e=>{const t=document.querySelector('[aria-label="睡眠目標の例を表示"]'),r=W.current;t&&!t.contains(e.target)&&r&&!r.contains(e.target)&&B(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[L]),m.useEffect(()=>{if(A){const e=e=>{const t=document.querySelector('[aria-label="喫煙目標の例を表示"]'),r=Z.current;t&&!t.contains(e.target)&&r&&!r.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[A]),m.useEffect(()=>{if($){const e=e=>{const t=document.querySelector('[aria-label="飲酒目標の例を表示"]'),r=V.current;t&&!t.contains(e.target)&&r&&!r.contains(e.target)&&P(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}},[$]);const U="female"===o?7e3:6500;return r.jsx("div",{className:"flex flex-col items-center justify-start py-0 bg-transparent",children:r.jsxs("form",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6 w-full max-w-md flex flex-col gap-4",children:[r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"性別"}),r.jsx("div",{className:"flex gap-4 mt-1",children:St.map(e=>r.jsxs("label",{className:"flex items-center gap-1 text-base",children:[r.jsx("input",{type:"radio",name:"gender",value:e.value,checked:o===e.value,onChange:()=>l(e.value),className:"accent-blue-500"}),e.label]},e.value))})]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"生年（例: 1990）"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"1900",max:yt,value:s,onChange:e=>i(e.target.value),className:"border rounded px-3 py-2 text-base w-32",required:!0,placeholder:"例: 1990"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>i((yt-40).toString()),children:"40"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>i((Number(s)-5).toString()),children:"-5"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>i((Number(s)+5).toString()),children:"+5"})]})]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"身長[cm] (例: 165.0)"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"100",max:"250",value:d,onChange:e=>c(e.target.value),className:"border rounded px-3 py-2 text-base w-32",required:!0,placeholder:"例: 165.0"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>c("170"),children:"170"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>c((G-5).toString()),children:"-5"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>c((G+5).toString()),children:"+5"})]})]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"開始体重[kg] (例: 68.0)"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"30",max:"200",step:"0.1",value:u,onChange:e=>f(e.target.value),className:"border rounded px-3 py-2 text-base w-32",required:!0,placeholder:"例: 68.0"}),null!==K&&r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>f(K.toString()),children:"最新体重"})]})]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"目標体重[kg] (例: 75.0)"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",min:"30",max:"200",step:"0.1",value:b,onChange:e=>y(e.target.value),className:"border rounded px-3 py-2 text-base w-32",required:!0,placeholder:"例: 75.0"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>{u&&!isNaN(Number(u))&&y((Math.round(10*(Number(u)-2))/10).toString())},children:"-2kg"}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>{u&&!isNaN(Number(u))&&y((Math.round(10*(Number(u)-5))/10).toString())},children:"-5kg"})]})]}),u&&b&&!isNaN(Number(u))&&!isNaN(Number(b))&&Number(b)<Number(u)&&r.jsxs("div",{className:"text-blue-700 dark:text-blue-300 text-sm font-semibold mb-2",children:["あと",(Number(u)-Number(b)).toFixed(1),"kg減らすには約",Math.round((Number(u)-Number(b))*U).toLocaleString(),"kcalの消費が必要です"]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"目標開始日"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"date",value:g,onChange:e=>h(e.target.value),className:"border rounded px-3 py-2 text-base",required:!0}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>h((new Date).toISOString().slice(0,10)),children:"今日"})]})]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"目標終了日"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"date",value:p,onChange:e=>x(e.target.value),className:"border rounded px-3 py-2 text-base",required:!0}),r.jsx(F,{type:"button",size:"sm",variant:"secondary",onClick:()=>{const e=g?new Date(g):new Date;e.setMonth(e.getMonth()+3),x(e.toISOString().slice(0,10))},children:"3か月後"})]})]}),u&&b&&g&&p&&!isNaN(Number(u))&&!isNaN(Number(b))&&Number(b)<Number(u)&&/^\d{4}-\d{2}-\d{2}$/.test(g)&&/^\d{4}-\d{2}-\d{2}$/.test(p)&&new Date(p)>=new Date(g)&&(()=>{const e=(Number(u)-Number(b))*U,t=new Date(g),a=new Date(p),n=Math.floor((a.getTime()-t.getTime())/864e5)+1;if(n>0){const t=Math.round(e/n);return r.jsxs("div",{className:"text-blue-700 dark:text-blue-300 text-sm font-semibold mb-2",children:["期間中に一日あたり約",t.toLocaleString(),"kcalの消費が必要です"]})}return null})(),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"運動目標 (例: なるべく階段を使う)"}),r.jsxs("div",{className:"flex items-center gap-2 relative",children:[r.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"border rounded px-3 py-2 text-base flex-1",placeholder:"例: 毎日30分歩く"}),r.jsx("span",{role:"button",tabIndex:0,"aria-label":"運動目標の例を表示",className:"ml-2 text-blue-500 hover:text-blue-700 focus:outline-none cursor-pointer select-none",style:{display:"flex",alignItems:"center"},onClick:()=>T(e=>!e),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||T(e=>!e)},children:r.jsx(_e,{className:"w-8 h-8",style:{minHeight:"2.5rem",minWidth:"2.5rem"}})}),M&&r.jsxs("div",{ref:z,className:"absolute z-20 top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-4 flex flex-col gap-2",style:{minWidth:"220px"},tabIndex:-1,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 text-sm",children:"運動目標の例"}),r.jsx("button",{type:"button","aria-label":"閉じる",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none",onClick:()=>T(!1),children:r.jsx(ze,{className:"w-4 h-4"})})]}),r.jsx("ul",{className:"flex flex-col gap-1",children:vt.map(e=>r.jsx("li",{children:r.jsx("button",{type:"button",className:"w-full text-left px-2 py-1 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 text-sm text-gray-700 dark:text-gray-100",onClick:()=>{w(e),T(!1)},children:e})},e))})]})]})]}),u&&b&&g&&p&&!isNaN(Number(u))&&!isNaN(Number(b))&&Number(b)<Number(u)&&/^\d{4}-\d{2}-\d{2}$/.test(g)&&/^\d{4}-\d{2}-\d{2}$/.test(p)&&new Date(p)>=new Date(g)&&(()=>{const e=(Number(u)-Number(b))*U,t=new Date(g),a=new Date(p),n=Math.floor((a.getTime()-t.getTime())/864e5)+1;if(n>0){const t=Math.round(e/n),a=Math.round(t/2);return r.jsxs("div",{className:"text-blue-700 dark:text-blue-300 text-sm font-semibold mb-2",children:["運動で一日あたり約",a.toLocaleString(),"kcalの消費を目標にしましょう。"]})}return null})(),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"減食目標 (例: 間食を控える)"}),r.jsxs("div",{className:"flex items-center gap-2 relative",children:[r.jsx("input",{type:"text",value:j,onChange:e=>k(e.target.value),className:"border rounded px-3 py-2 text-base flex-1",placeholder:"例: 間食を控える"}),r.jsx("span",{role:"button",tabIndex:0,"aria-label":"減食目標の例を表示",className:"ml-2 text-blue-500 hover:text-blue-700 focus:outline-none cursor-pointer select-none",style:{display:"flex",alignItems:"center"},onClick:()=>O(e=>!e),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||O(e=>!e)},children:r.jsx(_e,{className:"w-8 h-8",style:{minHeight:"2.5rem",minWidth:"2.5rem"}})}),R&&r.jsxs("div",{ref:H,className:"absolute z-20 top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-4 flex flex-col gap-2",style:{minWidth:"220px"},tabIndex:-1,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 text-sm",children:"減食目標の例"}),r.jsx("button",{type:"button","aria-label":"閉じる",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none",onClick:()=>O(!1),children:r.jsx(ze,{className:"w-4 h-4"})})]}),r.jsx("ul",{className:"flex flex-col gap-1",children:wt.map(e=>r.jsx("li",{children:r.jsx("button",{type:"button",className:"w-full text-left px-2 py-1 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 text-sm text-gray-700 dark:text-gray-100",onClick:()=>{k(e),O(!1)},children:e})},e))})]})]})]}),u&&b&&g&&p&&!isNaN(Number(u))&&!isNaN(Number(b))&&Number(b)<Number(u)&&/^\d{4}-\d{2}-\d{2}$/.test(g)&&/^\d{4}-\d{2}-\d{2}$/.test(p)&&new Date(p)>=new Date(g)&&(()=>{const e=(Number(u)-Number(b))*U,t=new Date(g),a=new Date(p),n=Math.floor((a.getTime()-t.getTime())/864e5)+1;if(n>0){const t=Math.round(e/n),a=Math.round(t/2);return r.jsxs("div",{className:"text-blue-700 dark:text-blue-300 text-sm font-semibold mb-2",children:["減食で一日あたり約",a.toLocaleString(),"kcalの消費を目標にしましょう。"]})}return null})(),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"睡眠目標 (例: 23時までに就寝する)"}),r.jsxs("div",{className:"flex items-center gap-2 relative",children:[r.jsx("input",{type:"text",value:N,onChange:e=>S(e.target.value),className:"border rounded px-3 py-2 text-base flex-1",placeholder:"例: 7時間以上寝る"}),r.jsx("span",{role:"button",tabIndex:0,"aria-label":"睡眠目標の例を表示",className:"ml-2 text-blue-500 hover:text-blue-700 focus:outline-none cursor-pointer select-none",style:{display:"flex",alignItems:"center"},onClick:()=>B(e=>!e),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||B(e=>!e)},children:r.jsx(_e,{className:"w-8 h-8",style:{minHeight:"2.5rem",minWidth:"2.5rem"}})}),L&&r.jsxs("div",{ref:W,className:"absolute z-20 top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-4 flex flex-col gap-2",style:{minWidth:"220px"},tabIndex:-1,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 text-sm",children:"睡眠目標の例"}),r.jsx("button",{type:"button","aria-label":"閉じる",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none",onClick:()=>B(!1),children:r.jsx(ze,{className:"w-4 h-4"})})]}),r.jsx("ul",{className:"flex flex-col gap-1",children:jt.map(e=>r.jsx("li",{children:r.jsx("button",{type:"button",className:"w-full text-left px-2 py-1 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 text-sm text-gray-700 dark:text-gray-100",onClick:()=>{S(e),B(!1)},children:e})},e))})]})]})]}),r.jsx("div",{className:"text-blue-700 dark:text-blue-300 text-sm font-semibold mb-2",children:"十分な睡眠(7時間以上)をとると痩せやすくなります。"}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"喫煙目標 (例: 1日○本までにする)"}),r.jsxs("div",{className:"flex items-center gap-2 relative",children:[r.jsx("input",{type:"text",value:C,onChange:e=>D(e.target.value),className:"border rounded px-3 py-2 text-base flex-1",placeholder:"例: 1日○本までにする"}),r.jsx("span",{role:"button",tabIndex:0,"aria-label":"喫煙目標の例を表示",className:"ml-2 text-blue-500 hover:text-blue-700 focus:outline-none cursor-pointer select-none",style:{display:"flex",alignItems:"center"},onClick:()=>_(e=>!e),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||_(e=>!e)},children:r.jsx(_e,{className:"w-8 h-8",style:{minHeight:"2.5rem",minWidth:"2.5rem"}})}),A&&r.jsxs("div",{ref:Z,className:"absolute z-20 top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-4 flex flex-col gap-2",style:{minWidth:"220px"},tabIndex:-1,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 text-sm",children:"喫煙目標の例"}),r.jsx("button",{type:"button","aria-label":"閉じる",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none",onClick:()=>_(!1),children:r.jsx(ze,{className:"w-4 h-4"})})]}),r.jsx("ul",{className:"flex flex-col gap-1",children:kt.map(e=>r.jsx("li",{children:r.jsx("button",{type:"button",className:"w-full text-left px-2 py-1 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 text-sm text-gray-700 dark:text-gray-100",onClick:()=>{D(e),_(!1)},children:e})},e))})]})]})]}),r.jsxs("label",{className:"flex flex-col gap-1",children:[r.jsx("span",{children:"飲酒目標 (例: 週2回までにする)"}),r.jsxs("div",{className:"flex items-center gap-2 relative",children:[r.jsx("input",{type:"text",value:I,onChange:e=>E(e.target.value),className:"border rounded px-3 py-2 text-base flex-1",placeholder:"例: 週2回までにする"}),r.jsx("span",{role:"button",tabIndex:0,"aria-label":"飲酒目標の例を表示",className:"ml-2 text-blue-500 hover:text-blue-700 focus:outline-none cursor-pointer select-none",style:{display:"flex",alignItems:"center"},onClick:()=>P(e=>!e),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||P(e=>!e)},children:r.jsx(_e,{className:"w-8 h-8",style:{minHeight:"2.5rem",minWidth:"2.5rem"}})}),$&&r.jsxs("div",{ref:V,className:"absolute z-20 top-full left-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-4 flex flex-col gap-2",style:{minWidth:"220px"},tabIndex:-1,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 text-sm",children:"飲酒目標の例"}),r.jsx("button",{type:"button","aria-label":"閉じる",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none",onClick:()=>P(!1),children:r.jsx(ze,{className:"w-4 h-4"})})]}),r.jsx("ul",{className:"flex flex-col gap-1",children:Nt.map(e=>r.jsx("li",{children:r.jsx("button",{type:"button",className:"w-full text-left px-2 py-1 rounded hover:bg-blue-50 dark:hover:bg-blue-900/30 text-sm text-gray-700 dark:text-gray-100",onClick:()=>{E(e),P(!1)},children:e})},e))})]})]})]})]})})}const Dt=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,It=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`,Et=()=>{const e=new Date,[t,a]=m.useState(e),[n,o]=m.useState(e),{fields:l,addRecord:s,updateRecord:i,deleteRecord:d,records:c,addField:u,loadRecords:f,deleteField:g,updateField:h,loadFields:p}=mt(),[b,y]=m.useState(!1),[v,w]=m.useState(""),[j,k]=m.useState(""),[N,B]=m.useState(""),[A,_]=m.useState(!1),$=m.useMemo(()=>A?l.filter(e=>"number"===e.type&&"bp"===e.scope).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId)):l.filter(e=>"number"===e.type&&"bp"===e.scope&&e.defaultDisplay).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId)),[l,A]),[P,z]=m.useState(()=>$.map(e=>({...e}))),[H,W]=m.useState(()=>$.map(e=>e.fieldId)),[Z,V]=m.useState([]),G=S(C(L)),K=Dt(n),U=(q=n,`${String(q.getHours()).padStart(2,"0")}:${String(q.getMinutes()).padStart(2,"0")}`);var q;const Y=e=>c.find(t=>t.fieldId===e&&t.date===K),[Q,X]=m.useState({});m.useEffect(()=>{const e={};$.forEach(t=>{const r=Y(t.fieldId);e[t.fieldId]=r?String(r.value):""}),X(e)},[l,A,c,K,$]);const J=async e=>{const t=Q[e];if(!t)return;const r=Number(t);if(isNaN(r))return;const a=Y(e);if(a)await i({...a,value:r});else{const t=new Date;await s({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:e,value:r,date:K,time:U,datetime:It(t)})}await f()},ee=async e=>{const t=Y(e);t&&(await d(t.id),await f())};m.useEffect(()=>{if(A){const e=l.filter(e=>"number"===e.type&&"bp"===e.scope).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId));z(e.map(e=>({...e}))),W(e.map(e=>e.fieldId)),V([])}},[A,l]);const[te,re]=m.useState(null),ae=m.useRef({}),ne=m.useRef({});m.useEffect(()=>{if(!te)return;const e=ae.current[te];if(e){const t=ne.current[te]??{start:e.value.length,end:e.value.length};e.setSelectionRange(t.start,t.end)}},[te]);const oe=x.memo(function({field:e,isEditing:t,onStartEdit:a,onEndEdit:n,onNameChange:o,onUnitChange:l,onDelete:s,onToggleDisplay:i,inputRef:d,unitInputRef:c}){const{attributes:u,listeners:f,setNodeRef:g,transform:m,transition:h,isDragging:p}=D({id:e.fieldId}),b={...p?{transform:I.Transform.toString(m),transition:h}:{},opacity:p?.5:1,background:p?"#f3f4f6":void 0},[y,v]=x.useState(e.name),[w,j]=x.useState(e.unit||"");return x.useEffect(()=>{t&&(v(e.name),j(e.unit||""))},[t,e.name,e.unit]),r.jsxs("div",{ref:g,style:b,className:"flex items-center gap-2 rounded-xl shadow p-4 mb-2 transition-colors "+(!1===e.defaultDisplay?"bg-gray-100 dark:bg-gray-700 text-gray-400":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200"),children:[t?r.jsxs(r.Fragment,{children:[r.jsx("input",{ref:d,type:"text",value:y,onChange:t=>{v(t.target.value);const r=t.target.selectionStart??t.target.value.length,a=t.target.selectionEnd??t.target.value.length;ne.current[e.fieldId]={start:r,end:a}},onSelect:t=>{const r=t.target;ne.current[e.fieldId]={start:r.selectionStart??r.value.length,end:r.selectionEnd??r.value.length}},onBlur:()=>{o(y),n()},onKeyDown:e=>{"Enter"===e.key&&(o(y),n())},className:"flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 text-lg font-semibold min-w-[5em] bg-inherit "+(!1===e.defaultDisplay?"border-gray-200 dark:border-gray-600 text-gray-400 bg-gray-50 dark:bg-gray-800":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200")}),r.jsx("input",{ref:c,type:"text",value:w,onChange:e=>j(e.target.value),onBlur:()=>l(w),placeholder:"単位",className:"w-20 border rounded-lg px-2 py-2 ml-2 focus:outline-none focus:ring-2 focus:ring-blue-400 text-base bg-inherit border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200"})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"flex-1 text-lg font-semibold min-w-[5em] cursor-pointer",onClick:a,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||a()},role:"button","aria-label":"項目名を編集",tabIndex:0,children:e.name}),e.unit&&r.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-300 whitespace-nowrap",children:e.unit})]}),r.jsx("button",{type:"button",onClick:()=>{window.confirm("本当に削除しますか？\n（保存すると確定されます。）")&&s()},className:"text-red-500 hover:text-red-700 p-2","aria-label":"削除",children:r.jsx($e,{className:"w-6 h-6"})}),r.jsx("button",{type:"button",onClick:i,className:"p-2 "+(!1===e.defaultDisplay?"text-gray-400 hover:text-blue-400":"text-blue-500 hover:text-blue-700"),"aria-label":!1===e.defaultDisplay?"表示項目にする":"非表示項目にする",children:!1===e.defaultDisplay?r.jsx(Te,{className:"w-6 h-6"}):r.jsx(Re,{className:"w-6 h-6"})}),r.jsx("span",{className:"cursor-move p-2","aria-label":"並び替えハンドル",style:{touchAction:"none"},...u,...f,tabIndex:0,children:r.jsx(Ne,{className:"w-6 h-6 text-gray-400"})})]})}),le=m.useCallback(e=>{V(t=>[...t,e]),z(t=>t.filter(t=>t.fieldId!==e))},[]),se=m.useCallback(e=>{z(t=>t.map(t=>t.fieldId===e?{...t,defaultDisplay:!t.defaultDisplay}:t))},[]),ie=e=>c.some(t=>t.date===Dt(e)&&$.some(e=>e.fieldId===t.fieldId));return r.jsxs("div",{className:"bg-transparent",children:[r.jsx(Ze,{selectedDate:n,setSelectedDate:o,centerDate:t,setCenterDate:a,isRecorded:ie}),r.jsx("div",{className:"w-full max-w-md mx-auto mt-3 mb-3 flex justify-start pl-4",children:r.jsxs("span",{className:"text-lg sm:text-xl font-bold text-gray-800 dark:text-white",children:[Dt(n),ie(n)&&r.jsx(Ie,{className:"inline-block w-6 h-6 text-green-500 ml-2 align-middle","aria-label":"入力済み"})]})}),r.jsxs("div",{className:"flex flex-col items-center justify-start min-h-[60vh]",children:[r.jsx("div",{className:"flex flex-col gap-6 w-full max-w-md",children:A?r.jsx(E,{sensors:G,collisionDetection:M,onDragEnd:e=>{const{active:t,over:r}=e;if(!r)return;const a=String(t.id),n=String(r.id);if(a!==n){const e=H.indexOf(a),t=H.indexOf(n);W(O(H,e,t))}},children:r.jsx(T,{items:H,strategy:R,children:H.map(e=>{const t=P.find(t=>t.fieldId===e);if(!t)return null;const a=te===t.fieldId;return r.jsx(oe,{field:t,isEditing:a,onStartEdit:()=>re(t.fieldId),onEndEdit:()=>re(null),onNameChange:e=>z(r=>r.map(r=>r.fieldId===t.fieldId?{...r,name:e}:r)),onUnitChange:e=>z(r=>r.map(r=>r.fieldId===t.fieldId?{...r,unit:e}:r)),onDelete:()=>le(t.fieldId),onToggleDisplay:()=>se(t.fieldId),inputRef:e=>ae.current[t.fieldId]=e,unitInputRef:()=>{}},t.fieldId)})})}):$.map(e=>{const t=Q[e.fieldId]??"";return r.jsxs("div",{className:"flex items-center gap-4 bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[r.jsx("span",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200 min-w-[5em]",children:e.name}),r.jsxs("div",{className:"flex flex-1 min-w-0 items-center",children:[r.jsx("input",{type:"number",inputMode:"decimal",step:"0.1",min:"0",className:"flex-1 min-w-0 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 text-lg font-semibold bg-inherit text-gray-700 dark:text-gray-200",value:t,onChange:t=>X(r=>({...r,[e.fieldId]:t.target.value})),onBlur:()=>{t?J(e.fieldId):ee(e.fieldId)},onKeyDown:r=>{"Enter"===r.key&&(t?J(e.fieldId):ee(e.fieldId))},placeholder:e.unit?`例: 0.0 (${e.unit})`:"例: 0.0"}),e.unit&&r.jsx("span",{className:"ml-2 text-gray-500 dark:text-gray-300 whitespace-nowrap shrink-0 overflow-hidden",children:e.unit})]})]},e.fieldId)})}),A&&r.jsxs("div",{className:"w-full max-w-md mt-6 mb-2",children:[b?r.jsxs("div",{className:"flex items-center gap-2 mb-2 bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[r.jsxs("div",{className:"flex flex-1 min-w-0 gap-2",children:[r.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"flex-1 min-w-0 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"新しい項目名",maxLength:20}),r.jsx("input",{type:"text",value:j,onChange:e=>k(e.target.value),className:"w-20 shrink-0 border border-gray-300 dark:border-gray-600 rounded-lg px-2 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"単位",maxLength:10})]}),r.jsx(F,{variant:"primary",size:"md",icon:Ie,"aria-label":"保存",onClick:async()=>{B("");const e=v.trim(),t=j.trim();if(!e)return void B("項目名を入力してください");if(l.some(t=>t.name===e&&"bp"===t.scope))return void B("同じ名前の項目が既に存在します");const r={fieldId:`custom_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,name:e,unit:t,type:"number",order:10*(l.length+1),defaultDisplay:!0,scope:"bp"};await u(r),y(!1),w(""),k("")},disabled:!v.trim(),children:""}),r.jsx(F,{variant:"secondary",size:"md",icon:ze,"aria-label":"キャンセル",onClick:()=>{y(!1),w(""),k(""),B("")},children:""})]}):r.jsx(F,{variant:"teal",size:"md",icon:Ae,fullWidth:!0,onClick:()=>y(!0),children:"新規項目"}),N&&r.jsx("div",{className:"text-red-500 text-sm mt-1",children:N})]}),r.jsx("div",{className:"w-full max-w-md mt-6",children:A?r.jsxs("div",{className:"flex gap-2",children:[r.jsx(F,{variant:"success",size:"md",icon:De,onClick:async()=>{for(const e of Z)await g(e);for(let e=0;e<H.length;++e){const t=P.find(t=>t.fieldId===H[e]);t&&await h({...t,order:10*e})}await p(),_(!1)},fullWidth:!0,children:"保存"}),r.jsx(F,{variant:"secondary",size:"md",icon:ze,onClick:()=>{_(!1)},fullWidth:!0,children:"キャンセル"})]}):r.jsx(F,{variant:"teal",size:"md",icon:Be,fullWidth:!0,onClick:()=>_(!0),children:"編集"})})]})]})},Mt=[{label:"2週間",days:14},{label:"1か月半",days:45},{label:"3か月",days:90},{label:"全データ",days:null}],Tt=()=>{const{records:e,fields:t}=mt(),[a,n]=m.useState(0),[g,h]=m.useState(!1),p=t.find(e=>"weight"===e.fieldId),x=m.useMemo(()=>{if(!e.length)return null;const t=e.filter(e=>"weight"===e.fieldId&&e.datetime);return t.length?Math.max(...t.map(e=>new Date(e.datetime).getTime())):null},[e]),b=m.useMemo(()=>{let t=e.filter(e=>"weight"===e.fieldId&&"number"==typeof e.value&&(g||!e.excludeFromGraph)&&e.datetime).sort((e,t)=>(e.datetime||"").localeCompare(t.datetime||"")).map(e=>({datetime:e.datetime,timestamp:new Date(e.datetime).getTime(),value:Number(e.value),excluded:!!e.excludeFromGraph}));const r=Mt[a];if(r.days&&x){const e=x-24*r.days*60*60*1e3;t=t.filter(t=>t.timestamp>=e)}return t},[e,a,x,g]),y=m.useMemo(()=>{if(!b.length)return[];const e=new Date(b[0].timestamp),t=new Date(b[b.length-1].timestamp);e.setHours(0,0,0,0),t.setHours(0,0,0,0);const r=[];for(let a=new Date(e);a<=t;a.setDate(a.getDate()+1))r.push(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0).getTime());return r},[b]),v=e=>{const t=new Date(e);return`${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},w=m.useMemo(()=>{if(b.length<2)return null;const e=b.length;let t=0,r=0,a=0,n=0;for(const f of b)t+=f.timestamp,r+=f.value,a+=f.timestamp*f.timestamp,n+=f.timestamp*f.value;const o=t/e,l=r/e,s=a-t*o;if(0===s)return null;const i=(n-t*l)/s,d=l-i*o,c=b[0].timestamp,u=b[b.length-1].timestamp;return[{timestamp:c,value:i*c+d},{timestamp:u,value:i*u+d}]},[b]);return r.jsxs("div",{className:"flex flex-col items-center justify-start py-4 bg-transparent",children:[r.jsxs("div",{className:"flex gap-2 mb-4",children:[Mt.map((e,t)=>r.jsx("button",{className:"px-3 py-1 rounded-full border-2 text-sm font-bold transition-colors duration-100\n              "+(a===t?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-700 text-blue-700 border-blue-300 hover:bg-blue-100 dark:hover:bg-blue-800"),onClick:()=>n(t),children:e.label},e.label)),r.jsxs("label",{className:"flex items-center ml-4 cursor-pointer select-none text-sm font-bold",children:[r.jsx("input",{type:"checkbox",className:"form-checkbox accent-blue-600 mr-1",checked:g,onChange:e=>h(e.target.checked)}),"除外値も表示"]})]}),r.jsx("div",{className:"w-full h-[400px] bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:r.jsx(o,{width:"100%",height:"100%",children:r.jsxs(l,{data:b,margin:{top:20,right:30,left:0,bottom:20},children:[r.jsx(s,{stroke:"#eee",strokeDasharray:"5 5"}),r.jsx(i,{dataKey:"timestamp",type:"number",domain:["auto","auto"],tickFormatter:v}),y.map(e=>r.jsx(d,{x:e,stroke:"#888",strokeDasharray:"2 2"},e)),r.jsx(c,{domain:["auto","auto"],unit:(null==p?void 0:p.unit)||"kg"}),r.jsx(u,{content:({active:e,payload:t,label:a})=>{var n;if(!e||!t||!t.length)return null;const o=null==(n=t[0])?void 0:n.payload;return r.jsxs("div",{style:{background:"#fff",border:"1px solid #ccc",padding:8,borderRadius:8},children:[r.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:v(o.timestamp)}),t.filter(e=>"#f59e42"!==e.color).map((e,t)=>r.jsxs("div",{style:{color:e.color,fontSize:14},children:["number"==typeof e.value?e.value.toFixed(2):e.value,(null==p?void 0:p.unit)||"kg"]},t))]})}}),r.jsx(f,{type:"monotone",dataKey:"value",data:b,stroke:"#38bdf8",strokeWidth:3,dot:({cx:e,cy:t,payload:a})=>r.jsx("circle",{cx:e,cy:t,r:4,fill:a.excluded?"#f87171":"#38bdf8",stroke:"#fff",strokeWidth:1})}),w&&r.jsx(f,{type:"linear",data:w,dataKey:"value",stroke:"#f59e42",strokeWidth:3,dot:!1,isAnimationActive:!1,strokeDasharray:"6 6",legendType:"none"})]})})})]})};function Rt(e){return N({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M232,208a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V48a8,8,0,0,1,16,0V60.69l56,56,26.34-26.35a8,8,0,0,1,11.32,0L192,148.69V128a8,8,0,0,1,16,0v40a7,7,0,0,1,0,.8c0,.11,0,.21-.05.32s0,.3-.07.46a2.83,2.83,0,0,1-.09.37c0,.13-.06.26-.1.39s-.08.23-.12.35l-.14.39-.15.31c-.06.13-.12.27-.19.4s-.11.18-.16.28l-.24.39-.21.28-.26.35c-.11.14-.24.27-.36.4l-.16.18-.17.15a4.83,4.83,0,0,1-.42.37,3.92,3.92,0,0,1-.32.25l-.3.22-.38.23a2.91,2.91,0,0,1-.3.17l-.37.19-.34.15-.36.13a2.84,2.84,0,0,1-.38.13l-.36.1c-.14,0-.26.07-.4.09l-.42.07-.35.05a7,7,0,0,1-.79,0H160a8,8,0,0,1,0-16h20.69L128,107.31l-26.34,26.35a8,8,0,0,1-11.32,0L40,83.31V200H224A8,8,0,0,1,232,208Z"},child:[]}]})(e)}const Ot=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,Lt=()=>{const e=new Date,[t,a]=m.useState(e),[n,o]=m.useState(e),{fields:l,addRecord:s,updateRecord:i,deleteRecord:d,records:c,loadRecords:u}=mt(),{goal:f,loadGoal:g}=bt(),[h,p]=m.useState(!1),[x,b]=m.useState(""),[y,v]=m.useState(""),[w,j]=m.useState(""),k=Ot(n),N=e=>{const t=Ot(e);return c.some(e=>e.date===t&&"weight"===e.fieldId)},[S,C]=m.useState(""),[D,I]=m.useState("08:00"),[E,M]=m.useState(""),T=m.useMemo(()=>l.filter(e=>"number"===e.type&&"weight"===e.scope&&e.defaultDisplay).slice().sort((e,t)=>e.order!==t.order?(e.order??0)-(t.order??0):e.fieldId.localeCompare(t.fieldId)),[l]),R=(()=>{const e=c.filter(e=>"weight"===e.fieldId&&e.date===k&&"number"==typeof e.value).sort((e,t)=>(t.time||"").localeCompare(e.time||""));return e.length>0?Number(e[0].value):null})(),O=R&&f&&f.height?R/Math.pow(f.height/100,2):null,L=[{min:0,max:18.5,color:"#6ec6f1",label:"低体重",range:"<18.5"},{min:18.5,max:25,color:"#7edfa0",label:"普通体重",range:"18.5-24.9"},{min:25,max:30,color:"#b6d97a",label:"肥満(1度)",range:"25-29.9"},{min:30,max:35,color:"#ffe066",label:"肥満(2度)",range:"30-34.9"},{min:35,max:40,color:"#ff9800",label:"肥満(3度)",range:"35-39.9"},{min:40,max:100,color:"#f44336",label:"肥満(4度)",range:"40.0+"}],B=(()=>{if(null===O)return 0;let e=0;for(let t=0;t<L.length;t++){const r=L[t];if(O<r.max){return e+100/L.length*((O-r.min)/(r.max-r.min))}e+=100/L.length}return 100})();return m.useEffect(()=>{f&&f.height||g()},[f,g]),r.jsxs("div",{className:"bg-transparent",children:[r.jsx(Ze,{selectedDate:n,setSelectedDate:o,centerDate:t,setCenterDate:a,isRecorded:N}),r.jsx("div",{className:"w-full max-w-md mx-auto mt-3 mb-3 flex justify-start pl-4",children:r.jsxs("span",{className:"text-lg sm:text-xl font-bold text-gray-800 dark:text-white",children:[Ot(n),N(n)&&r.jsx(Ie,{className:"inline-block w-6 h-6 text-green-500 ml-2 align-middle","aria-label":"入力済み"}),O&&r.jsxs("span",{className:"ml-4 text-base font-semibold text-blue-700 dark:text-blue-200 align-middle",children:["BMI ",O.toFixed(1)]})]})}),O&&f&&f.height&&r.jsxs("div",{className:"w-full max-w-md mx-auto flex flex-col items-center mb-2",children:[r.jsxs("div",{className:"relative w-full h-8 flex rounded overflow-hidden shadow",style:{minWidth:240},children:[L.map(e=>r.jsx("div",{className:"flex-1 flex flex-col items-center justify-center",style:{background:e.color,minWidth:0},children:r.jsx("span",{className:"text-[10px] font-bold text-gray-800 dark:text-gray-900 select-none",style:{lineHeight:1},children:e.label})},e.label)),r.jsx("div",{className:"absolute left-0 top-0 w-full pointer-events-none",style:{height:"100%"},children:r.jsx("div",{style:{position:"absolute",left:`calc(${B}% - 0.65em)`,top:"50%",transform:"translateY(-50%)",color:"#222",fontSize:"1.5em",textShadow:"0 0 2px #fff, 0 0 2px #fff, 1px 1px 2px #0002",zIndex:2},"aria-label":"現在のBMI位置",children:"▼"})})]}),r.jsx("div",{className:"w-full flex justify-between mt-1 px-1",children:L.map(e=>r.jsx("span",{className:"text-[10px] text-gray-700 dark:text-gray-200",style:{minWidth:0},children:e.range},e.label+"-range"))})]}),r.jsxs("div",{className:"flex flex-col items-center justify-start min-h-[60vh]",children:[r.jsx("div",{className:"flex flex-col gap-6 w-full max-w-md",children:T.map(e=>{const t=c.filter(t=>t.fieldId===e.fieldId&&t.date===k).sort((e,t)=>(e.time||"").localeCompare(t.time||""));return r.jsxs("div",{className:"flex flex-col gap-4 bg-white dark:bg-gray-800 rounded-xl shadow p-4 mb-4",children:[r.jsx("span",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200 min-w-[5em] mb-2",children:e.name}),t.length>0&&t.map(e=>r.jsxs("div",{className:"flex flex-col gap-1 w-full relative",children:[r.jsxs("div",{className:"flex items-center gap-2 w-full",children:[r.jsx("input",{type:"time",className:"h-10 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-inherit text-gray-700 dark:text-gray-200 w-[6.5em]",defaultValue:e.time||"08:00",onBlur:async t=>{t.target.value!==e.time&&(await i({...e,time:t.target.value}),await u())}}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.1",min:"0",className:"h-10 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-lg font-semibold bg-inherit text-gray-700 dark:text-gray-200 w-[7em]",defaultValue:"string"==typeof e.value||"number"==typeof e.value?e.value:"",onBlur:async t=>{Number(t.target.value)!==e.value&&(await i({...e,value:Number(t.target.value)}),await u())}}),r.jsxs("div",{className:"flex gap-1 ml-auto",children:[r.jsx(F,{variant:"danger",size:"sm",icon:$e,"aria-label":"削除",onClick:async()=>{window.confirm("本当に削除しますか？")&&(await d(e.id),await u())},children:""}),r.jsx(F,{variant:!0===e.excludeFromGraph?"secondary":"sky",size:"sm","aria-label":!0===e.excludeFromGraph?"グラフ除外":"グラフ表示",onClick:async()=>{await i({...e,excludeFromGraph:!e.excludeFromGraph}),await u()},children:r.jsxs("span",{className:"relative inline-block w-5 h-5",children:[r.jsx(Rt,{className:"w-5 h-5 text-white"}),!0===e.excludeFromGraph&&r.jsx(Le,{className:"w-5 h-5 text-red-500 absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2"})]})})]})]}),r.jsx("textarea",{className:"h-10 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-inherit text-gray-700 dark:text-gray-200 resize-none w-full mt-1",rows:1,defaultValue:e.note||"",onBlur:async t=>{(t.target.value||"")!==(e.note||"")&&(await i({...e,note:t.target.value}),await u())}})]},e.id)),r.jsxs("div",{className:"flex flex-col gap-1 w-full mt-2",children:[r.jsxs("div",{className:"flex items-center gap-2 w-full",children:[r.jsx("input",{type:"time",className:"h-10 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-inherit text-gray-700 dark:text-gray-200 w-[6.5em]",value:D,onChange:e=>I(e.target.value)}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.1",min:"0",className:"h-10 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-lg font-semibold bg-inherit text-gray-700 dark:text-gray-200 w-[7em]",value:S,onChange:e=>C(e.target.value),placeholder:e.unit?`例: 0.0 (${e.unit})`:"例: 0.0"}),r.jsx(F,{variant:"success",size:"sm",icon:Ie,"aria-label":"保存",className:"ml-auto",onClick:async()=>{var t;S&&(await s({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:e.fieldId,value:Number(S),date:k,time:D,datetime:(t=new Date,`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}T${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`),note:E}),C(""),I((()=>{const e=new Date;return`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`})()),M(""),await u())},children:""})]}),r.jsx("textarea",{className:"h-10 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base bg-inherit text-gray-700 dark:text-gray-200 resize-none w-full mt-1",rows:1,value:E,onChange:e=>M(e.target.value),placeholder:"補足・メモ（任意）"})]})]},e.fieldId)})}),h&&r.jsxs("div",{className:"w-full max-w-md mt-6 mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2 bg-white dark:bg-gray-800 rounded-xl shadow p-4",children:[r.jsx("input",{type:"text",value:x,onChange:e=>b(e.target.value),className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"新しい項目名",maxLength:20}),r.jsx("input",{type:"text",value:y,onChange:e=>v(e.target.value),className:"w-20 border border-gray-300 dark:border-gray-600 rounded-lg px-2 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"単位",maxLength:10}),r.jsx(F,{variant:"primary",size:"md",icon:Ie,"aria-label":"保存",onClick:async()=>{p(!1),b(""),v(""),j("")},disabled:!x.trim(),children:""}),r.jsx(F,{variant:"secondary",size:"md",icon:ze,"aria-label":"キャンセル",onClick:()=>{p(!1),b(""),v(""),j("")},children:""})]}),w&&r.jsx("div",{className:"text-red-500 text-sm mt-1",children:w})]})]})]})},Bt=({pageName:e})=>r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300 font-medium",children:e?`${e}を読み込み中...`:"ページを読み込み中..."}),Ve]})});function At(){const e=w(),[t,a]=m.useState(!1),n=()=>{a(!1)};m.useEffect(()=>{const e=e=>{"Escape"===e.key&&t&&n()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t]),m.useEffect(()=>{if(t){const e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}}},[t]);const o=[{path:"/weight",label:"体重",color:"teal"},{path:"/daily",label:"日課",color:"teal"},{path:"/other",label:"その他",color:"teal"},{path:"/graph",label:"グラフ",color:"blue"},{path:"/goal",label:"目標",color:"teal"},{path:"/export",label:"管理",color:"purple"}],l=t=>e.pathname===t;return r.jsxs("div",{className:"relative",children:[r.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 bg-blue-600 text-white px-4 py-2 rounded-lg z-50 font-medium",children:"スキップリンク"}),r.jsxs("nav",{className:"hidden md:flex justify-between items-center gap-4 mb-12 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg mx-4 mt-4",role:"navigation","aria-label":"メインへ移動",children:[r.jsx("div",{className:"flex gap-4",children:o.map(e=>r.jsxs(j,{to:e.path,className:("purple"===e.color?"bg-purple-600 border-purple-600 hover:bg-purple-700 hover:border-purple-700":"bg-blue-500 border-blue-500 hover:bg-blue-600 hover:border-blue-600")+" !text-white px-4 py-2 rounded-lg shadow-md transition-colors duration-200 font-medium text-base border-2 hover:!text-white visited:!text-white active:!text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-current":l(e.path)?"page":void 0,"aria-label":"メインへ移動",children:[e.label,l(e.path)&&r.jsx("span",{className:"sr-only",children:"現在のページ"})]},e.path))}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(je,{}),r.jsx(Z,{className:"ml-2",debug:!1})]})]}),r.jsx("div",{className:"md:hidden flex w-full mb-4",children:r.jsxs("nav",{className:"flex w-full",children:[["/weight","/daily","/other","/graph"].map((e,t,a)=>{const s=o.find(t=>t.path===e);return s?r.jsx(j,{to:s.path,className:`flex-1 text-center py-3 font-bold text-base transition-colors duration-200\n                  ${l(s.path)?"bg-blue-600 text-white mobile-nav-current":"bg-gray-100 dark:bg-gray-700 text-blue-700 dark:text-blue-200 hover:bg-blue-100 dark:hover:bg-blue-800"}\n                  ${0===t?"rounded-l-xl":""}\n                  ${t===a.length?"rounded-r-xl":""}\n                  rounded-none focus:outline-none focus:ring-0 border-0`,"aria-current":l(s.path)?"page":void 0,"aria-label":s.label,style:{minWidth:0},onClick:n,children:s.label},s.path):null}),r.jsx("button",{onClick:()=>{a(!t)},className:"flex-1 text-center py-3 font-bold text-base bg-gray-100 dark:bg-gray-700 text-blue-700 dark:text-blue-200 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-r-xl border-0 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2","aria-label":t?"メニューを閉じる":"メニューを開く","aria-expanded":t,"aria-controls":"mobile-menu",style:{minWidth:0},children:r.jsx("span",{className:"inline-block align-middle",children:r.jsxs("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("rect",{y:"5",width:"24",height:"2",rx:"1",fill:"currentColor"}),r.jsx("rect",{y:"11",width:"24",height:"2",rx:"1",fill:"currentColor"}),r.jsx("rect",{y:"17",width:"24",height:"2",rx:"1",fill:"currentColor"})]})})})]})}),t&&r.jsx("div",{id:"mobile-menu",className:"md:hidden absolute top-full left-4 right-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg z-40 mb-4",role:"dialog","aria-modal":"true","aria-label":"モバイルメニュー",children:r.jsx("nav",{role:"navigation","aria-label":"モバイルメインナビゲーション",children:r.jsxs("div",{className:"flex flex-col",children:[o.map(e=>r.jsxs(j,{to:e.path,onClick:n,className:"px-4 py-3 font-medium text-base hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 border-b border-gray-100 dark:border-gray-600 "+(l(e.path)?"bg-blue-600 text-white":"purple"===e.color?"!text-purple-600 dark:!text-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 focus:bg-purple-50 dark:focus:bg-purple-900/20 hover:!text-purple-600 dark:hover:!text-purple-400 visited:!text-purple-600 dark:visited:!text-purple-400 active:!text-purple-600 dark:active:!text-purple-400":"!text-blue-500 dark:!text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 focus:bg-blue-50 dark:focus:bg-blue-900/20 hover:!text-blue-500 dark:hover:!text-blue-400 visited:!text-blue-500 dark:visited:!text-blue-400 active:!text-blue-500 dark:active:!text-blue-400"),"aria-current":l(e.path)?"page":void 0,"aria-label":"メインへ移動",children:[e.label,l(e.path)&&r.jsx("span",{className:"sr-only",children:"現在のページ"})]},e.path)),r.jsxs("div",{className:"flex justify-center gap-2 px-4 py-3 border-t border-gray-100 dark:border-gray-600",children:[r.jsx(je,{className:"text-sm px-3 py-2"}),r.jsx(Z,{className:"text-sm px-3 py-2",debug:!1})]})]})})}),t&&r.jsx("div",{className:"md:hidden fixed inset-0 z-30 backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.3)"},onClick:n,"aria-hidden":"true"})]})}const _t=m.lazy(()=>function(e,t){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),n=(null==a?void 0:a.nonce)||(null==a?void 0:a.getAttribute("nonce"));r=e(t.map(e=>{if((e=function(e){return"/aloe-wellness-log/"+e}(e))in P)return;P[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,n&&a.setAttribute("nonce",n),document.head.appendChild(a),t?new Promise((t,r)=>{a.addEventListener("load",t),a.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})}(()=>import("./RecordExport-Cc6Tr6B6.js"),__vite__mapDeps([0,1,2,3,4,5])).then(e=>e).catch(e=>(console.error("Failed to load RecordExport:",e),{default:function(){return r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"ロードエラー"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"エクスポートページのロードに失敗しました。"}),r.jsx(F,{variant:"primary",size:"md",onClick:()=>window.location.reload(),children:"ページを再読み込み"})]})}})));function $t(){const{initializeFields:e,loadFields:t,fieldsOperation:a,recordsOperation:n,loadRecords:o}=mt();return m.useEffect(()=>{try{Ve,e().then(()=>{t()})}catch(r){console.error("❌ App initialization failed:",r);try{e()}catch(a){console.error("❌ Fallback initialization also failed:",a)}}},[e,t]),m.useEffect(()=>{a.loading||o()},[a.loading,o]),r.jsxs("div",{children:[r.jsx("header",{role:"banner",children:r.jsx(At,{})}),r.jsx("main",{id:"main-content",role:"main",tabIndex:-1,children:a&&n&&(a.loading||n.loading)?r.jsx(Bt,{pageName:"初期化中"}):r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"日課"}),children:r.jsxs(b,{children:[r.jsx(y,{path:"/goal",element:r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"目標"}),children:r.jsx(Ct,{})})}),r.jsx(y,{path:"/daily",element:r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"日課"}),children:r.jsx(xt,{})})}),r.jsx(y,{path:"/weight",element:r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"体重"}),children:r.jsx(Lt,{})})}),r.jsx(y,{path:"/other",element:r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"その他"}),children:r.jsx(Et,{})})}),r.jsx(y,{path:"/graph",element:r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"グラフ"}),children:r.jsx(Tt,{})})}),r.jsx(y,{path:"/export",element:r.jsx(m.Suspense,{fallback:r.jsx(Bt,{pageName:"管理"}),children:r.jsx(_t,{})})}),r.jsx(y,{path:"*",element:r.jsx(v,{to:"/daily",replace:!0})})]})})})]})}function Pt(e){return r.jsx(zt,{...e})}class zt extends m.Component{constructor(e){super(e),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),t(this,"handleReload",()=>{window.location.reload()}),t(this,"handleCopy",async()=>{const{error:e,errorInfo:t}=this.state;if(!e)return;const r=`エラー名: ${e.name}\nエラーメッセージ: ${e.message}\n`+(t?`スタックトレース:\n${t.componentStack}`:"");await navigator.clipboard.writeText(r),this.setState({copied:!0}),setTimeout(()=>this.setState({copied:!1}),1500)}),this.state={hasError:!1,error:null,errorInfo:null,copied:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({errorInfo:t})}render(){const{hasError:e,error:t,errorInfo:a}=this.state,{children:n,fallback:o}=this.props;return e&&t?o?o(t,this.handleReset):r.jsxs("div",{className:"flex flex-col items-center justify-center p-8 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[r.jsx("h2",{className:"text-xl font-bold text-red-800 dark:text-red-200 mb-2 text-center",children:"エラーが発生しました"}),r.jsxs("p",{className:"text-red-700 dark:text-red-300 mb-6 text-center max-w-md",children:["申し訳ありません。予期しないエラーが発生しました。",r.jsx("br",{}),"ページを再読み込みしてください。"]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsx("button",{onClick:this.handleReset,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:"再試行"}),r.jsx("button",{onClick:this.handleReload,className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800 transition-colors duration-200",children:"再読み込み"})]}),r.jsxs("details",{className:"mt-6 w-full max-w-2xl text-left",children:[r.jsxs("summary",{className:"cursor-pointer text-sm text-red-600 dark:text-red-400 font-medium flex items-center justify-between",children:[r.jsx("span",{children:"詳細"}),r.jsx("button",{type:"button",onClick:this.handleCopy,className:"ml-4 px-2 py-1 text-xs rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500",style:{minWidth:60},children:this.state.copied?"コピーしました":"コピー"})]}),r.jsxs("div",{className:"mt-2 p-4 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded text-xs font-mono overflow-auto max-h-40 text-left",children:[r.jsxs("div",{className:"mb-2 text-left",children:[r.jsx("strong",{children:"エラー名:"})," ",t.name]}),r.jsxs("div",{className:"mb-2 text-left",children:[r.jsx("strong",{children:"エラーメッセージ:"})," ",t.message]}),a&&r.jsxs("div",{className:"text-left",children:[r.jsx("strong",{children:"スタックトレース:"}),r.jsx("pre",{className:"whitespace-pre-wrap text-xs mt-1 text-left",children:a.componentStack})]})]})]})]}):n}}const Ht=B((e,t)=>({toasts:[],showToast:(r,a="info",n=3e3)=>{const o=`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,l={id:o,type:a,message:r,duration:n};e(e=>({toasts:[...e.toasts,l]})),n&&n>0&&setTimeout(()=>{t().removeToast(o)},n)},showSuccess:(e,r=2e3)=>{t().showToast(e,"success",r)},showError:(e,r=5e3)=>{t().showToast(e,"error",r)},showWarning:(e,r=4e3)=>{t().showToast(e,"warning",r)},showInfo:(e,r=3e3)=>{t().showToast(e,"info",r)},removeToast:t=>{e(e=>({toasts:e.toasts.filter(e=>e.id!==t)}))},clearAll:()=>{e({toasts:[]})}})),Wt=()=>{const{toasts:e,removeToast:t}=Ht(),a=m.useRef(null);m.useEffect(()=>{if(e.length>0){const t=e[e.length-1];if("error"===t.type||"warning"===t.type){const e=document.querySelector(`[data-toast-id="${t.id}"]`);e&&e.focus()}}},[e]);const n=e=>{switch(e){case"success":return r.jsx(De,{className:"w-5 h-5 text-green-600 dark:text-green-400","aria-hidden":"true"});case"error":return r.jsx(Pe,{className:"w-5 h-5 text-red-600 dark:text-red-400","aria-hidden":"true"});case"warning":return r.jsx(Me,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400","aria-hidden":"true"});case"info":return r.jsx(Oe,{className:"w-5 h-5 text-blue-600 dark:text-blue-400","aria-hidden":"true"})}},o=e=>{switch(e){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700 text-green-800 dark:text-green-200";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-700 text-red-800 dark:text-red-200";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700 text-yellow-800 dark:text-yellow-200";case"info":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700 text-blue-800 dark:text-blue-200"}},l=e=>{switch(e){case"success":return"成功";case"error":return"エラー";case"warning":return"警告";case"info":return"情報"}};return 0===e.length?null:r.jsx("div",{ref:a,className:"fixed top-4 right-4 z-50 space-y-2",role:"region","aria-label":"情報","aria-live":"polite","aria-atomic":"false",children:e.map(e=>r.jsx("div",{"data-toast-id":e.id,className:`${o(e.type)} border rounded-lg p-4 shadow-lg max-w-sm transform transition-all duration-300 ease-in-out animate-in slide-in-from-right-5 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400`,role:"error"===e.type||"warning"===e.type?"alert":"status","aria-label":`${l(e.type)}: ${e.message}`,tabIndex:"error"===e.type||"warning"===e.type?0:-1,children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"flex-shrink-0",children:n(e.type)}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsxs("p",{className:"text-sm font-medium leading-5",children:[r.jsxs("span",{className:"sr-only",children:[l(e.type),": "]}),e.message]})}),r.jsx("button",{onClick:()=>t(e.id),className:"flex-shrink-0 text-gray-400 dark:text-slate-400 bg-gray-100 dark:bg-slate-700 hover:text-gray-600 dark:hover:text-slate-200 hover:bg-gray-200 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 rounded-full p-1","aria-label":"閉じる",children:r.jsx(ze,{className:"w-4 h-4","aria-hidden":"true"})})]})},e.id))})},Ft=31536e6,Zt="error";function Vt(e,t="partial"){if(null==e)return"---";const r=String(e);switch(t){case"full":return"*".repeat(r.length);case"hash":{let e=0;for(let t=0;t<r.length;t++){e=(e<<5)-e+r.charCodeAt(t),e&=e}return`#${Math.abs(e).toString(16)}`}default:return r.length<=3?"*".repeat(r.length):r.length<=8?r.slice(0,1)+"*".repeat(r.length-2)+r.slice(-1):r.slice(0,2)+"*".repeat(r.length-4)+r.slice(-2)}}function Gt(e){const t={};for(const[r,a]of Object.entries(e))Kt(r)?t[r]=Vt(a):t[r]="object"==typeof a&&null!==a?Array.isArray(a)?a.map(e=>"object"==typeof e?Gt(e):e):Gt(a):a;return t}function Kt(e){return[/password/i,/token/i,/secret/i,/key/i,/auth/i,/session/i,/cookie/i,/email/i,/phone/i,/address/i,/ssn/i,/credit/i].some(t=>t.test(e))}function Ut(e,t,r){if(!("error"===e||"warn"===e&&["debug","info","warn"].includes(Zt)||"info"===e&&["debug","info"].includes(Zt)||"debug"===e&&"debug"===Zt))return;const a=`[${(new Date).toISOString()}][PRIVACY][${e.toUpperCase()}]`;r&&"object"==typeof r?console[e](`${a} ${t}`,Gt(r)):r?console[e](`${a} ${t}`,Vt(r)):console[e](`${a} ${t}`)}function qt(e,t=Ft){return Date.now()-e>t}async function Yt(){try{Ut("info","Starting automatic data cleanup"),"indexedDB"in window&&await async function(){Ut("debug","IndexedDB cleanup completed")}(),function(){const e=[];for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);if(r){const t=localStorage.getItem(r);if(t)try{const a=JSON.parse(t);a.timestamp&&qt(a.timestamp)&&e.push(r)}catch{(localStorage.getItem(r)&&r.startsWith("cache_")||r.startsWith("temp_"))&&e.push(r)}}}e.forEach(e=>{localStorage.removeItem(e),Ut("debug",`Removed expired localStorage item: ${e}`)})}(),function(){const e=[];for(let t=0;t<sessionStorage.length;t++){const r=sessionStorage.key(t);r&&(r.startsWith("temp_")||r.startsWith("cache_"))&&e.push(r)}e.forEach(e=>{sessionStorage.removeItem(e),Ut("debug",`Removed sessionStorage item: ${e}`)})}(),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEANUP_EXPIRED_CACHE"}),Ut("info","Automatic data cleanup completed")}catch(e){Ut("error","Data cleanup failed",e)}}Ut("info","Initializing privacy settings"),setInterval(Yt,36e5),window.addEventListener("beforeunload",()=>{Yt().catch(e=>{Ut("error","Cleanup on unload failed",e)})}),window.addEventListener("securitypolicyviolation",e=>{Ut("error","Security Policy Violation detected",{directive:e.violatedDirective,blockedURI:e.blockedURI,disposition:e.disposition})}),Ut("info","Privacy settings initialized successfully"),document.addEventListener("contextmenu",e=>{});const Qt={open:!1};setInterval(function(){window.outerHeight-window.innerHeight>160||window.outerWidth-window.innerWidth>160?Qt.open||(Qt.open=!0):Qt.open=!1},500);const Xt=(e,t)=>{"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent(`performance:${e}`,{detail:t}))},Jt=performance.now(),er=e=>{var t;let r;if(console.error("Global error:",e),r=e instanceof ErrorEvent?{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:null==(t=e.error)?void 0:t.stack,timestamp:(new Date).toLocaleString(),userAgent:navigator.userAgent,url:window.location.href}:{reason:e.reason,promise:String(e.promise),timestamp:(new Date).toLocaleString(),userAgent:navigator.userAgent,url:window.location.href},"undefined"!=typeof performance){const e={timing:performance.timing,navigation:performance.navigation,memory:performance.memory};r.performance=e}const a={...r,userAgent:navigator.userAgent.substring(0,100),url:new URL(window.location.href).pathname};Xt("error",a)};window.addEventListener("error",er),window.addEventListener("unhandledrejection",er);const tr=(()=>{const e="/aloe-wellness-log/";return e.replace(/\/$/,"")})();$.createRoot(document.getElementById("root")).render(r.jsxs(Pt,{children:[r.jsx(Wt,{}),r.jsx(k,{basename:tr,children:r.jsx($t,{})})]})),window.addEventListener("load",()=>{const e=performance.now()-Jt;Xt("initialLoad",{loadTime:e})}),"serviceWorker"in navigator&&window.addEventListener("load",()=>{const e=`${"/aloe-wellness-log/".replace(/\/$/,"")}/sw.js`;navigator.serviceWorker.register(e).then(e=>{}).catch(e=>{console.error("❌ Service Worker registration failed:",e)})});export{F as B,Oe as H,Me as a,Pe as b,De as c,Ce as d,Se as e,Ee as f,ke as g,$e as h,Ve as i,Xe as p,mt as u};
