import{j as e}from"./ui-vendor-BuGzxEnB.js";import{a as t}from"./react-vendor-9hcqHTTy.js";import{g as a,d as s,e as r,f as n,h as o,B as l,j as c}from"./index-DlR7JNvY.js";import"./icons-vendor-BLJDdPqg.js";import"./dnd-vendor-B-r8cpST.js";import"./state-vendor-CZRBIdKG.js";const i=t.memo(function({onStatusChange:i}){const{exportAsJSON:d,exportAsCSV:m}=(()=>{const e=t.useCallback(e=>`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}${String(e.getHours()).padStart(2,"0")}${String(e.getMinutes()).padStart(2,"0")}${String(e.getSeconds()).padStart(2,"0")}`,[]),o=t.useCallback((e,t)=>{const a=URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=t,s.click(),URL.revokeObjectURL(a)},[]),l=t.useCallback(async()=>{const[e,t,o,l]=await Promise.all([a(),s(),r(),n()]);return{weightRecords:e,bpRecords:t,dailyRecords:o,dailyFields:l}},[]);return{exportAsJSON:t.useCallback(async t=>{try{null==t||t("データをエクスポート中...");const a=await l(),s=JSON.stringify(a,null,2),r=new Blob([s],{type:"application/json"}),n=`records-v2-${e(new Date)}.json`;o(r,n),null==t||t("JSONエクスポートが完了しました")}catch(a){null==t||t(`エクスポートエラー: ${a instanceof Error?a.message:"Unknown error"}`)}},[l,e,o]),exportAsCSV:t.useCallback(async t=>{try{null==t||t("CSVエクスポート中...");const a=await l(),s=["Date,Time,Weight,BodyFat,Waist,Note,ExcludeFromGraph",...a.weightRecords.map(e=>`${e.date},${e.time},${e.weight},${e.bodyFat||""},${e.waist||""},${e.note||""},${e.excludeFromGraph||!1}`)].join("\n"),r=["Date,Time,Systolic,Diastolic,HeartRate,Note,ExcludeFromGraph",...a.bpRecords.map(e=>`${e.date},${e.time},${e.systolic},${e.diastolic},${e.heartRate||""},${e.note||""},${e.excludeFromGraph||!1}`)].join("\n"),n=["Date,FieldId,Value",...a.dailyRecords.map(e=>`${e.date},${e.fieldId},${e.value}`)].join("\n"),c=e(new Date);o(new Blob([s],{type:"text/csv"}),`weight-records-${c}.csv`),o(new Blob([r],{type:"text/csv"}),`bp-records-${c}.csv`),o(new Blob([n],{type:"text/csv"}),`daily-records-${c}.csv`),null==t||t("CSVエクスポートが完了しました")}catch(a){null==t||t(`CSVエクスポートエラー: ${a instanceof Error?a.message:"Unknown error"}`)}},[l,e,o]),getAllData:l,formatDateForFilename:e,downloadFile:o}})(),p=t.useCallback(async()=>{await d(i)},[d,i]),x=t.useCallback(async()=>{await m(i)},[m,i]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-700 dark:text-gray-200 flex items-center gap-2 justify-center",children:[e.jsx(o,{className:"w-6 h-6"}),"データエクスポート"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex justify-center",children:e.jsx("div",{className:"text-left max-w-md",children:e.jsx("p",{children:"記録したデータをファイルとしてダウンロードできます。"})})}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx(l,{variant:"primary",icon:c,onClick:p,children:"JSON形式でエクスポート"}),e.jsx(l,{variant:"secondary",icon:c,onClick:x,children:"CSV形式でエクスポート"})]})]})]})});export{i as default};
