import{j as e}from"./ui-vendor-D7AUAfXm.js";import{a as t,b as s}from"./react-vendor-BzNAZZ5j.js";import{u as a,H as i,a as n,b as r,c as l,d,e as o,f as c,g as u,h as m,i as g,j as f,k as x,l as p,m as b,n as h,o as y,p as w,q as v,r as j,v as N,s as S,t as F}from"./index-B2p52sU7.js";import{u as C,a as E,D as k,c as I,S as D,v as M,s as $,K as T,P as A,b as O,C as P,d as q}from"./dnd-vendor-BBd399mu.js";import"./icons-vendor-DoCnAwwa.js";import"./state-vendor-O6FgWrPy.js";const R=t.memo(({recordDate:t,recordTime:s,onDateChange:r,onTimeChange:l,onSetCurrentDateTime:d})=>{const{t:o}=a();return e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-md",children:e.jsxs("fieldset",{className:"space-y-4",children:[e.jsxs("legend",{className:"text-2xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(i,{className:"w-6 h-6 text-blue-600","aria-hidden":"true"}),o("pages.input.recordDateTime")]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"record-date",className:"block text-base font-medium text-gray-700 mb-2",children:o("pages.input.date")}),e.jsx("input",{id:"record-date",type:"date",value:t,onChange:e=>r(e.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600","aria-describedby":"record-date-desc",required:!0,"aria-required":"true"}),e.jsx("div",{id:"record-date-desc",className:"sr-only",children:o("pages.input.dateDescription")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"record-time",className:"block text-base font-medium text-gray-700 mb-2",children:o("pages.input.time")}),e.jsx("input",{id:"record-time",type:"time",value:s,onChange:e=>l(e.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600","aria-describedby":"record-time-desc",required:!0,"aria-required":"true"}),e.jsx("div",{id:"record-time-desc",className:"sr-only",children:o("pages.input.timeDescription")})]}),e.jsxs("div",{className:"flex items-end",children:[e.jsxs("button",{type:"button",onClick:d,className:"bg-blue-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors duration-200 font-medium flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2","aria-label":o("pages.input.setCurrentDateTime"),"aria-describedby":"current-time-desc",children:[e.jsx(n,{className:"w-5 h-5","aria-hidden":"true"}),o("pages.input.setCurrentDateTime")]}),e.jsx("div",{id:"current-time-desc",className:"sr-only",children:o("pages.input.currentTimeDescription")})]})]})]})})});R.displayName="DateTimeSelector";const _=t.memo(({value:s,onChange:i,maxLength:n=500,placeholder:l})=>{const{t:d}=a(),o=t.useCallback(e=>{i(e.target.value)},[i]),c=s.length,u=n-c,m=c>.8*n,g=l||d("pages.input.notesPlaceholder");return e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{htmlFor:"notes-input",className:"text-2xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(r,{className:"w-6 h-6 text-blue-600","aria-hidden":"true"}),d("pages.input.notes")]}),e.jsxs("div",{children:[e.jsx("textarea",{id:"notes-input",value:s,onChange:o,placeholder:g,className:"w-full border border-gray-300 rounded-lg px-4 py-2 h-24 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 resize-none",maxLength:n,"aria-describedby":"notes-char-count notes-description","aria-label":d("pages.input.notesPlaceholder")}),e.jsx("div",{id:"notes-description",className:"sr-only",children:d("pages.input.notesDescription",{maxLength:n})}),e.jsxs("div",{id:"notes-char-count",className:"text-right text-sm mt-2 "+(m?"text-orange-600 font-medium":"text-gray-600"),"aria-live":"polite","aria-label":d("aria.charactersEntered",{count:c,remaining:u}),children:[d("pages.input.characterCount",{count:c,max:n}),m&&e.jsxs("span",{className:"ml-2 text-orange-600",children:["(残り",u,"文字)"]})]})]})]})})});function B({field:s,onToggleDisplay:i}){const{t:n}=a(),{attributes:r,listeners:l,setNodeRef:c,transform:u,transition:m,isDragging:f}=O({id:s.fieldId}),{announcePolite:x}=d(),p={transform:P.Transform.toString(u),transition:m,opacity:f?.5:1},b=t.useCallback(e=>{e.stopPropagation(),e.preventDefault();const t=!s.defaultDisplay;i(s.fieldId),x(`${s.name}${n("dialogs.sortModal.toggledAnnouncement",{state:n(t?"dialogs.sortModal.visible":"dialogs.sortModal.hidden")})}`)},[s.fieldId,s.defaultDisplay,s.name,i,x,n]),h=t.useCallback(()=>{const e=!s.defaultDisplay;i(s.fieldId),x(`${s.name}${n("dialogs.sortModal.toggledAnnouncement",{state:n(e?"dialogs.sortModal.visible":"dialogs.sortModal.hidden")})}`)},[s.fieldId,s.defaultDisplay,s.name,i,x,n]),y={onEnter:h,onSpace:h},{handleKeyDown:w}=o(y),v=s.defaultDisplay?n("dialogs.sortModal.visibleDescription"):n("dialogs.sortModal.hiddenDescription");return e.jsx("div",{ref:c,style:p,className:"bg-white border border-gray-200 rounded-lg p-2 sm:p-3 hover:shadow-md transition-all duration-200 hover:border-purple-300",...r,role:"listitem","aria-label":`${s.name}${n("common.item")} - ${v} ${n("accessibility.sortable")}`,children:e.jsxs("div",{className:"flex flex-col sm:grid sm:gap-3 sm:items-center gap-2",style:{gridTemplateColumns:"auto 1fr 1fr auto"},children:[e.jsxs("div",{className:"flex justify-between items-center sm:hidden",children:[e.jsx("div",{className:"text-lg font-medium text-gray-700",children:s.name}),e.jsx("div",{className:"text-sm text-gray-600","aria-label":`${n("dialogs.sortModal.unit")}: ${s.unit||n("dialogs.sortModal.noUnit")}`,children:s.unit?`(${s.unit})`:"―"})]}),e.jsxs("div",{className:"flex justify-between items-center sm:hidden",children:[e.jsx("div",{children:s.defaultDisplay?e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1 transition-colors duration-150","aria-label":`${s.name}${n("dialogs.sortModal.makeHidden")}`,"aria-pressed":"true",children:n("dialogs.sortModal.visible")}):e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1 transition-colors duration-150","aria-label":`${s.name}${n("dialogs.sortModal.makeVisible")}`,"aria-pressed":"false",children:n("dialogs.sortModal.hidden")})}),e.jsx("div",{className:"flex justify-center cursor-move focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-1 rounded p-1",tabIndex:0,role:"button","aria-label":`${s.name}${n("dialogs.sortModal.dragToSort")}`,...l,children:e.jsx(g,{className:"w-5 h-5 text-gray-400 hover:text-gray-600 transition-colors duration-150","aria-hidden":"true"})})]}),e.jsxs("div",{className:"hidden sm:contents",children:[e.jsx("div",{className:"text-center border-r border-gray-200 pr-3",children:s.defaultDisplay?e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1 transition-colors duration-150","aria-label":`${s.name}${n("dialogs.sortModal.makeHidden")}`,"aria-pressed":"true",children:n("dialogs.sortModal.visible")}):e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1 transition-colors duration-150","aria-label":`${s.name}${n("dialogs.sortModal.makeVisible")}`,"aria-pressed":"false",children:n("dialogs.sortModal.hidden")})}),e.jsx("div",{className:"text-lg font-medium text-gray-700 border-r border-gray-200 pr-3 text-right",children:s.name}),e.jsx("div",{className:"text-gray-600 border-r border-gray-200 pr-3 text-left","aria-label":`${n("dialogs.sortModal.unit")}: ${s.unit||n("dialogs.sortModal.noUnit")}`,children:s.unit?`(${s.unit})`:"―"}),e.jsx("div",{className:"flex justify-center cursor-move focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-1 rounded p-1",tabIndex:0,role:"button","aria-label":`${s.name}${n("dialogs.sortModal.dragToSort")}`,...l,children:e.jsx(g,{className:"w-5 h-5 text-gray-400 hover:text-gray-600 transition-colors duration-150","aria-hidden":"true"})})]})]})})}_.displayName="NotesInput";const L=({isOpen:i,onClose:n,fields:r,onDragEnd:g,onSave:f,onToggleDisplay:x})=>{const{t:p}=a(),{modalProps:b}=l(i),{announcePolite:h}=d(),y={onEscape:n},{handleKeyDown:w}=o(y),v=C(E(A),E(T,{coordinateGetter:$})),j=t.useCallback(e=>{const{active:t,over:s}=e;if(t.id!==(null==s?void 0:s.id)){g(e);const a=r.find(e=>e.fieldId===t.id),i=r.find(e=>e.fieldId===(null==s?void 0:s.id));a&&i&&h(`${a.name}${p("dialogs.sortModal.dragEndAnnouncement",{target:i.name})}`)}},[g,r,h,p]),N=t.useCallback(()=>{f(),h(p("dialogs.sortModal.savedAnnouncement"))},[f,h,p]);return t.useEffect(()=>{i&&h(p("dialogs.sortModal.openedAnnouncement"))},[i,h,p]),t.useEffect(()=>(i&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[i]),i?s.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",...b,children:[e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.3)"},onClick:n}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsxs("div",{className:"relative w-full max-w-sm sm:max-w-xl transform overflow-hidden rounded-2xl bg-white p-4 sm:p-6 text-left align-middle shadow-xl transition-all",onKeyDown:w,onClick:e=>e.stopPropagation(),children:[e.jsxs("h3",{className:"text-xl sm:text-2xl font-bold leading-6 text-gray-900 mb-4 sm:mb-6 flex items-center gap-2",id:"sort-modal-title",children:[e.jsx(c,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600","aria-hidden":"true"}),p("dialogs.sortModal.title")]}),e.jsx("div",{className:"mb-4",id:"sort-modal-description",children:e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:p("dialogs.sortModal.description")})}),e.jsx(k,{sensors:v,collisionDetection:I,onDragEnd:j,accessibility:{announcements:{onDragStart:({active:e})=>{const t=r.find(t=>t.fieldId===e.id);return`${(null==t?void 0:t.name)||"アイテム"}${p("dialogs.sortModal.dragStartAnnouncement")}`},onDragOver:({active:e,over:t})=>{const s=r.find(t=>t.fieldId===e.id),a=r.find(e=>e.fieldId===(null==t?void 0:t.id));return s&&a?`${s.name}${p("dialogs.sortModal.dragOverAnnouncement",{target:a.name})}`:""},onDragEnd:({active:e,over:t})=>{const s=r.find(t=>t.fieldId===e.id),a=r.find(e=>e.fieldId===(null==t?void 0:t.id));return e.id===(null==t?void 0:t.id)?`${(null==s?void 0:s.name)||"アイテム"}${p("dialogs.sortModal.dragReturnAnnouncement")}`:s&&a?`${s.name}${p("dialogs.sortModal.dragEndAnnouncement",{target:a.name})}`:`${(null==s?void 0:s.name)||"アイテム"}${p("dialogs.sortModal.dragCompleteAnnouncement")}`},onDragCancel:({active:e})=>{const t=r.find(t=>t.fieldId===e.id);return`${(null==t?void 0:t.name)||"アイテム"}${p("dialogs.sortModal.dragCancelAnnouncement")}`}}},children:e.jsx(D,{items:r.map(e=>e.fieldId),strategy:M,children:e.jsx("div",{className:"space-y-2 max-h-[50vh] sm:max-h-[60vh] overflow-y-auto pr-1 sm:pr-2",role:"list","aria-label":p("dialogs.sortModal.listLabel"),"aria-describedby":"sort-modal-description",children:r.map(t=>e.jsx(B,{field:t,onToggleDisplay:x},t.fieldId))})})}),e.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-col sm:flex-row gap-3 sm:justify-end",role:"group","aria-label":p("dialogs.sortModal.buttonsLabel"),children:[e.jsxs("button",{type:"button",className:"bg-gray-400 text-white px-4 sm:px-6 py-2 rounded-lg shadow-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",onClick:n,"aria-label":p("dialogs.sortModal.cancelLabel"),children:[e.jsx(u,{className:"w-4 h-4","aria-hidden":"true"}),p("common.cancel")]}),e.jsxs("button",{type:"button",className:"bg-purple-600 text-white px-4 sm:px-6 py-2 rounded-lg shadow-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",onClick:N,"aria-label":p("dialogs.sortModal.saveLabel"),children:[e.jsx(m,{className:"w-4 h-4","aria-hidden":"true"}),p("common.save")]})]})]})})]}),document.body):null};var H=(e=>(e.CONNECTION_FAILED="connection_failed",e.TRANSACTION_FAILED="transaction_failed",e.DATA_CORRUPTED="data_corrupted",e.QUOTA_EXCEEDED="quota_exceeded",e.VERSION_ERROR="version_error",e.UNKNOWN="unknown",e))(H||{});function K(){const{showError:e,showWarning:s}=f(),a=t.useCallback((t,a={})=>{const{showToast:i=!0,logToConsole:n=!0,context:r,fallbackMessage:l}=a,d=function(e){if(e&&"object"==typeof e&&"type"in e&&"retryable"in e&&"message"in e){const t=e;if(Object.values(H).includes(t.type)){const t=e;return{type:"database",message:t.message,originalError:t.originalError,context:{dbErrorType:t.type,retryable:t.retryable}}}}if(e instanceof Error){const t=e.message.toLowerCase();return t.includes("indexeddb")||t.includes("database")||t.includes("store")?{type:"database",message:"データベース操作でエラーが発生しました",originalError:e}:t.includes("parse")||t.includes("json")||t.includes("csv")?{type:"parse",message:"データの解析でエラーが発生しました",originalError:e}:t.includes("validation")||t.includes("必須")||t.includes("形式")?{type:"validation",message:e.message,originalError:e}:t.includes("network")||t.includes("fetch")||t.includes("request")?{type:"network",message:"ネットワークエラーが発生しました",originalError:e}:{type:"unknown",message:e.message,originalError:e}}return{type:"unknown",message:"予期しないエラーが発生しました",context:{originalError:e}}}(t);n&&function(e){var t;e.message,e.originalError,"database"===e.type&&(null==(t=e.context)||t.dbErrorType)}(d);const o=l||function(e){var t;switch(e.type){case"validation":return e.message;case"database":if(null==(t=e.context)?void 0:t.dbErrorType){const t=e.context.dbErrorType,s=e.context.retryable;switch(t){case"quota_exceeded":return"ストレージ容量が不足しています。不要なデータを削除してから再度お試しくださいませ。";case"connection_failed":return s?"データベース接続に失敗しました。しばらく待ってから再度お試しくださいませ。":"データベース接続に問題があります。ページを再読み込みしてお試しくださいませ。";case"transaction_failed":return"データベース処理中にエラーが発生しました。もう一度お試しくださいませ。";case"data_corrupted":return"データが破損している可能性があります。管理画面からデータの確認をお勧めいたします。";case"version_error":return"データベースの更新中です。ページを再読み込みしてお試しくださいませ。";default:return e.message||"データベース操作でエラーが発生いたしました。"}}return"データの保存・読み込みに失敗いたしました。もう一度お試しくださいませ。";case"parse":return"ファイルの形式が正しくありません。ファイルの内容をご確認くださいませ。";case"network":return"ネットワーク接続に問題があります。接続状況をご確認くださいませ。";case"permission":return"この操作を実行する権限がありません。";default:return e.message||"予期しないエラーが発生いたしました。"}}(d);return i&&("validation"===d.type?s(o):e(o)),d},[e,s]),i=t.useCallback(async(e,t={})=>{try{return await e()}catch(s){return a(s,t),null}},[a]),n=t.useCallback((e,t={})=>e.map(({error:e,context:s})=>a(e,{...t,context:s})),[a]);return{handleError:a,handleAsyncError:i,handleBatchErrors:n}}function V(){const{t:s,translateFieldName:i,translateError:n,getAriaLabel:l,getAnnouncement:o}=a(),{announcePolite:g}=d();p(),K();const{fields:C,loadFields:E,addRecord:k,loadRecords:I,records:D,fieldsOperation:M}=x(),{showSuccess:$,showError:T}=f(),A=function(){const{fields:e,loadFields:s,addField:a,updateField:i,deleteField:n}=x(),{showSuccess:r,showError:l}=f(),{handleAsyncError:d}=K(),[o,c]=t.useState(!1),[u,m]=t.useState(!1),[g,p]=t.useState({name:"",type:"number",unit:""}),[b,h]=t.useState(null),[y,w]=t.useState({}),[v,j]=t.useState(null),[N,S]=t.useState(null),[F,C]=t.useState({}),[E,k]=t.useState(new Set),[I,D]=t.useState(new Set),[M,$]=t.useState(new Set),[T,A]=t.useState(!1),[O,P]=t.useState([]),R=t.useRef([]),_=t.useCallback(()=>0===e.length?1:Math.max(...e.map(e=>e.order||0))+1,[e]),B=t.useCallback(()=>e.filter(e=>!1===e.defaultDisplay).sort((e,t)=>(e.order||999)-(t.order||999)),[e]),L=t.useCallback(async t=>{if(t.preventDefault(),j(null),!g.name.trim())return void j("項目名を入力してください");if(e.some(e=>e.name===g.name.trim()))return void j("同じ名前の項目が既に存在します");const i=g.name.trim().replace(/\s+/g,"_").toLowerCase();await d(async()=>{var e;return await a({fieldId:i,name:g.name.trim(),type:g.type,unit:(null==(e=g.unit)?void 0:e.trim())||void 0,order:_(),defaultDisplay:!1}),k(e=>new Set([...e,i])),p({name:"",type:"number",unit:""}),m(!1),c(!1),await s(),!0},{context:"項目追加",fallbackMessage:"項目の追加に失敗しました"})&&r("項目を追加しましたわ")},[g,e,a,_,d,s,r]),H=t.useCallback(e=>{h(e.fieldId),w({name:e.name,unit:e.unit})},[]),V=t.useCallback(async()=>{var t;if(!b||!(null==(t=y.name)?void 0:t.trim()))return h(null),w({}),void D(new Set);const a=e.find(e=>e.fieldId===b);a&&(await d(async()=>{var e;return await i({...a,name:y.name.trim(),unit:(null==(e=y.unit)?void 0:e.trim())||void 0}),await s(),!0},{context:"項目編集",fallbackMessage:"項目の編集に失敗しました"})&&r("項目を編集しましたわ"),h(null),w({}),D(new Set))},[b,y,e,i,d,s,r]),U=t.useCallback(t=>{e.find(e=>e.fieldId===t)&&(k(e=>new Set([...e,t])),c(!1),$(new Set),r("項目を一時表示に追加しましたわ"))},[e,r]),Y=t.useCallback(async t=>{const a=e.find(e=>e.fieldId===t);if(!a)return;const n={...a,defaultDisplay:!0},d=e.map(e=>e.fieldId===t?n:e);x.setState({fields:d});try{await i(n),k(e=>{const s=new Set(e);return s.delete(t),s}),$(new Set),c(!1),await s(),r("項目を表示状態に変更しましたわ")}catch(o){x.setState({fields:e});const t=o instanceof Error?o.message:"表示状態の変更に失敗しました";l(t)}},[e,i,d,s,r]),z=t.useCallback(e=>{S(e.fieldId),C({name:e.name,unit:e.unit}),$(new Set)},[]),W=t.useCallback(async()=>{var t;if(!N||!(null==(t=F.name)?void 0:t.trim()))return S(null),C({}),void $(new Set);const a=e.find(e=>e.fieldId===N);a&&(await d(async()=>{var e;return await i({...a,name:F.name.trim(),unit:(null==(e=F.unit)?void 0:e.trim())||void 0,order:a.order,defaultDisplay:a.defaultDisplay}),await s(),!0},{context:"既存項目編集",fallbackMessage:"項目の編集に失敗しました"})&&r("項目を編集しましたわ"),S(null),C({}),$(new Set))},[N,F,e,i,d,s,r]),G=t.useCallback(async e=>{window.confirm(`項目「${e.name}」を削除してもよろしいですか？\n\nこの項目に関連するすべての記録データも削除されます。`)&&await d(async()=>(await n(e.fieldId),await s(),$(new Set),!0),{context:"項目削除",fallbackMessage:"項目の削除に失敗しました"})&&r("項目を削除しましたわ")},[n,d,s,r]),Q=t.useCallback(e=>{D(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),X=t.useCallback(e=>I.has(e),[I]),J=t.useCallback(()=>{D(new Set)},[]),Z=t.useCallback(e=>{$(t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),ee=t.useCallback(e=>M.has(e),[M]),te=t.useCallback(()=>{$(new Set)},[]),se=t.useCallback(async()=>{let t=e;if(0===t.length)try{await s();const{fields:e}=x.getState();if(t=e,0===t.length)return void l("項目データが見つかりません。ページをリロードしてください。")}catch(i){return void l("項目データの読み込みに失敗しました。")}const a=[...t].sort((e,t)=>(e.order||999)-(t.order||999));P(a),R.current=a,A(!0)},[e,s,l]),ae=t.useCallback(e=>{const{active:t,over:s}=e;if(s&&t.id!==s.id){const e=O.findIndex(e=>e.fieldId===t.id),a=O.findIndex(e=>e.fieldId===s.id),i=q(O,e,a);P(i),R.current=i}},[O]),ie=t.useCallback(async()=>{await d(async()=>{const e=R.current.map((e,t)=>{const s={...e,order:t+1};return i(s)});return await Promise.all(e),await new Promise(e=>setTimeout(e,50)),await s(),A(!1),!0},{context:"並び順保存",fallbackMessage:"並び順の保存に失敗しました"})&&r("並び順を保存しましたわ")},[i,d,s,r]),ne=t.useCallback(async e=>{await d(async()=>(await i({...e,defaultDisplay:!1}),k(t=>{const s=new Set(t);return s.delete(e.fieldId),s}),D(new Set),await s(),!0),{context:"項目非表示",fallbackMessage:"項目の非表示に失敗しました"})&&r("項目を非表示にしましたわ")},[i,d,s,r]),re=t.useCallback(async t=>{const s=O.find(e=>e.fieldId===t);if(!s)return;const a={...s,defaultDisplay:!s.defaultDisplay};await d(async()=>{await i(a);const s=O.map(e=>e.fieldId===t?a:e);P(s),R.current=s;const n=e.map(e=>e.fieldId===t?a:e);return x.setState({fields:n}),a.defaultDisplay?k(e=>{const s=new Set(e);return s.delete(t),s}):e.some(e=>e.fieldId===t&&(e.defaultDisplay||E.has(t)))&&k(e=>new Set([...e,t])),!0},{context:"モーダル内表示状態変更",fallbackMessage:"表示状態の変更に失敗しました"})},[O,e,E,i,d]);return{showSelectField:o,setShowSelectField:c,showAddField:u,setShowAddField:m,newField:g,setNewField:p,editFieldId:b,setEditFieldId:h,editField:y,setEditField:w,addFieldError:v,editingExistingFieldId:N,setEditingExistingFieldId:S,editingExistingField:F,setEditingExistingField:C,temporaryDisplayFields:E,showSortModal:T,setShowSortModal:A,sortableFields:O,getHiddenFields:B,handleAddField:L,handleEditField:H,handleEditFieldSave:V,handleShowExistingField:U,handleShowExistingFieldPermanently:Y,handleEditExistingField:z,handleEditExistingFieldSave:W,handleDeleteExistingField:G,toggleButtons:Q,areButtonsShown:X,toggleSelectButtons:Z,areSelectButtonsShown:ee,handleOpenSortModal:se,handleDragEnd:ae,handleSaveSortOrder:ie,handleHideField:ne,handleToggleDisplayInModal:re,clearButtons:J,clearSelectButtons:te}}(),[O,P]=t.useState({}),[B,H]=t.useState(null),[V,U]=t.useState(()=>(new Date).toISOString().slice(0,10)),[Y,z]=t.useState(()=>(new Date).toTimeString().slice(0,5)),[W,G]=t.useState(""),[Q,X]=t.useState(!1);t.useEffect(()=>{E(),I()},[E,I]);const J=(e,t)=>{P(s=>({...s,[e]:t})),H(null);const s=C.find(t=>t.fieldId===e);"boolean"===(null==s?void 0:s.type)&&"boolean"==typeof t&&g(`${s.name}を${t?"あり":"なし"}に設定しました`)},Z=(e,t)=>null!=t&&("boolean"===e.type?!0===t||!1===t:"number"===e.type?"number"==typeof t&&!isNaN(t):"string"==typeof t&&t.trim().length>0),ee=e=>{const t=(e=>{const t=[...D].filter(t=>t.fieldId===e).sort((e,t)=>new Date(t.datetime).getTime()-new Date(e.datetime).getTime())[0];return(null==t?void 0:t.value)??""})(e);if(""!==t){J(e,t);const s=C.find(t=>t.fieldId===e);s&&g(o("previousValueSet",{fieldName:i(s.fieldId)}))}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 to-blue-100 p-2 sm:p-4",children:e.jsxs("div",{className:"max-w-full sm:max-w-4xl mx-auto px-2 sm:px-0",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-gray-800 mb-2 whitespace-nowrap",children:s("pages.input.title")}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:s("pages.input.description")})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=(()=>{if(!N(V))return"日付の形式が正しくありません (YYYY-MM-DD)";if(!S(Y))return"時刻の形式が正しくありません (HH:mm)";for(const e of C){const t=O[e.fieldId];if(Z(e,t)){const s=F(t,e.type,{required:!1,min:"number"===e.type?0:void 0,max:"number"===e.type?1e4:void 0});if(!s.isValid)return`${e.name}: ${s.errors.join(", ")}`}}return W.length>500?"備考は500文字以内で入力してください":""!==W.trim()||C.some(e=>Z(e,O[e.fieldId]))?null:s("validation.required")})();if(t)return H(t),void g(s("errors.inputError",{message:t}));try{let e=0;const t=[];for(const s of C){const a=O[s.fieldId];if(Z(s,a)){const i=new Date(`${V}T${Y}:00`);t.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:s.fieldId,value:a,date:V,time:Y,datetime:i.toISOString()}),e++}}if(""!==W.trim()){const s=new Date(`${V}T${Y}:00`);t.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:"notes",value:W.trim(),date:V,time:Y,datetime:s.toISOString()}),e++}for(const s of t)await k(s);g(o("recordSaved",{count:e})),P({}),$(s("pages.input.recordSuccess")),G("");const a=new Date;U(a.toISOString().slice(0,10)),z(a.toTimeString().slice(0,5))}catch(a){const e=n("database",s("pages.input.recordError"));H(e),T(e)}},className:"space-y-8 mb-12",children:[e.jsx(R,{recordDate:V,recordTime:Y,onDateChange:U,onTimeChange:z,onSetCurrentDateTime:()=>{const e=new Date;U(e.toISOString().slice(0,10)),z(e.toTimeString().slice(0,5)),g(o("currentTimeSet"))}}),e.jsx(_,{value:W,onChange:G}),[...C].filter(e=>!1!==e.defaultDisplay||A.temporaryDisplayFields.has(e.fieldId)).sort((e,t)=>(e.order||999)-(t.order||999)).map(t=>e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-md",children:A.editFieldId===t.fieldId?e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch mb-4",children:[e.jsx("div",{className:"text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:e.jsx("input",{type:"text",value:A.editField.name??"",onChange:e=>A.setEditField(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:s("pages.input.fieldManagement.fieldName")})}),e.jsx("div",{className:"pl-0 sm:pl-2 pt-2 sm:pt-0",children:"boolean"===t.type?e.jsx("div",{className:"h-full"}):e.jsx("input",{type:"text",value:A.editField.unit??"",onChange:e=>A.setEditField(t=>({...t,unit:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:s("pages.input.fieldManagement.unitPlaceholder")})})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:A.handleEditFieldSave,className:"bg-green-600 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-green-700 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(m,{className:"w-4 h-4"}),s("actions.save")]}),e.jsxs("button",{type:"button",onClick:()=>{A.setEditFieldId(null),A.setEditField({}),A.clearButtons()},className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(u,{className:"w-4 h-4"}),s("actions.cancel")]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch cursor-pointer",onClick:()=>A.toggleButtons(t.fieldId),children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:t.name}),e.jsx("div",{className:"text-lg text-gray-800 font-semibold pl-0 sm:pl-2 text-left pt-2 sm:pt-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:["boolean"===t.type?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),J(t.fieldId,!0)},className:"px-3 py-1.5 rounded-lg border-2 text-sm font-medium transition-colors duration-200 flex-shrink-0 "+(!0===O[t.fieldId]?"bg-green-100 border-green-500 text-green-700":"bg-gray-100 border-gray-300 text-gray-600 hover:bg-gray-200"),"aria-label":l("setToYes",{fieldName:i(t.fieldId)}),children:s("fields.yes")}),e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),J(t.fieldId,!1)},className:"px-3 py-1.5 rounded-lg border-2 text-sm font-medium transition-colors duration-200 flex-shrink-0 "+(!1===O[t.fieldId]?"bg-red-100 border-red-500 text-red-700":"bg-gray-100 border-gray-300 text-gray-600 hover:bg-gray-200"),"aria-label":l("setToNo",{fieldName:i(t.fieldId)}),children:s("fields.no")}),void 0!==O[t.fieldId]&&e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),P(e=>{const s={...e};return delete s[t.fieldId],s})},className:"px-2 py-1.5 rounded-lg border-2 border-gray-300 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex-shrink-0","aria-label":l("clearSelection",{fieldName:i(t.fieldId)}),title:s("fields.clearSelection"),children:"×"})]}):e.jsx("input",{type:"number"===t.type?"number":"text",value:String(O[t.fieldId]||""),onChange:e=>J(t.fieldId,"number"===t.type?Number(e.target.value)||"":e.target.value),onClick:e=>e.stopPropagation(),className:"border border-gray-300 rounded-lg px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600","aria-label":l("inputField",{fieldName:i(t.fieldId)})}),e.jsx("div",{className:"w-full sm:w-32",children:t.unit&&e.jsx("span",{className:"text-gray-600 font-medium",children:t.unit})})]})})]}),A.areButtonsShown(t.fieldId)&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",className:"bg-sky-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",onClick:()=>ee(t.fieldId),"aria-label":l("setPreviousValue",{fieldName:i(t.fieldId)}),children:[e.jsx(b,{className:"w-3 h-3 sm:w-4 sm:h-4","aria-hidden":"true"}),s("actions.lastValue")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleEditField(t),className:"bg-blue-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm","aria-label":l("editField",{fieldName:i(t.fieldId)}),children:[e.jsx(h,{className:"w-3 h-3 sm:w-4 sm:h-4","aria-hidden":"true"}),s("actions.edit")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleHideField(t),className:"bg-red-600 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm","aria-label":l("hideField",{fieldName:i(t.fieldId)}),children:[e.jsx(y,{className:"w-3 h-3 sm:w-4 sm:h-4","aria-hidden":"true"}),s("actions.hide")]})]})]})},t.fieldId)),B&&e.jsxs("div",{id:"form-error",className:"text-red-600 font-semibold bg-red-50 p-4 rounded-lg border border-red-200",role:"alert","aria-live":"polite",children:[e.jsx("span",{className:"sr-only",children:s("aria.formError")}),B]}),e.jsxs("button",{type:"submit",className:"bg-green-600 text-white px-4 sm:px-8 py-3 sm:py-4 rounded-lg font-bold text-lg sm:text-xl shadow-md hover:bg-green-700 hover:shadow-lg transition-all duration-200 flex items-center justify-center gap-2 sm:gap-3 focus:outline-none focus:ring-2 focus:ring-green-600 focus:ring-offset-2 w-full","aria-describedby":B?"form-error":void 0,children:[e.jsx(r,{className:"w-5 h-5 sm:w-6 sm:h-6","aria-hidden":"true"}),s("pages.input.record")]})]}),e.jsx("div",{className:"mb-8",children:A.showSelectField?e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-md",children:[e.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"w-6 h-6 text-blue-600"}),s("pages.input.fieldManagement.selectFieldsTitle")]}),e.jsxs("div",{className:"space-y-4",children:[A.getHiddenFields().length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-xl font-medium text-gray-700 text-left",children:s("pages.input.fieldManagement.existingFields")}),e.jsx("div",{className:"space-y-3",children:A.getHiddenFields().map(t=>e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:A.editingExistingFieldId===t.fieldId?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch",children:[e.jsx("div",{className:"text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:e.jsx("input",{type:"text",value:A.editingExistingField.name??"",onChange:e=>A.setEditingExistingField(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:s("pages.input.fieldManagement.fieldName")})}),e.jsx("div",{className:"pl-0 sm:pl-2 pt-2 sm:pt-0",children:e.jsx("input",{type:"text",value:A.editingExistingField.unit??"",onChange:e=>A.setEditingExistingField(t=>({...t,unit:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:s("pages.input.fieldManagement.unitPlaceholder")})})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center pt-2 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:A.handleEditExistingFieldSave,className:"bg-green-600 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-green-700 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(m,{className:"w-4 h-4"}),s("actions.save")]}),e.jsxs("button",{type:"button",onClick:()=>{A.setEditingExistingFieldId(null),A.clearSelectButtons()},className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(u,{className:"w-4 h-4"}),s("actions.cancel")]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch cursor-pointer",onClick:()=>A.toggleSelectButtons(t.fieldId),children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:t.name}),e.jsx("div",{className:"text-lg text-gray-800 font-semibold pl-0 sm:pl-2 text-left pt-2 sm:pt-0",children:t.unit?`(${t.unit})`:""})]}),A.areSelectButtonsShown(t.fieldId)&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>A.handleShowExistingFieldPermanently(t.fieldId),className:"bg-green-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-green-600 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(m,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s("actions.display")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleShowExistingField(t.fieldId),className:"bg-teal-400 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-teal-500 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(w,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s("actions.add")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleEditExistingField(t),className:"bg-blue-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(h,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s("actions.edit")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleDeleteExistingField(t),className:"bg-red-600 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-red-700 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(v,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s("actions.delete")]})]})]})},t.fieldId))})]}),A.showAddField&&e.jsxs("form",{onSubmit:A.handleAddField,className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-xl font-medium text-gray-700 mb-4 text-left flex items-center gap-2",children:[e.jsx(w,{className:"w-6 h-6 text-green-600","aria-hidden":"true"}),s("pages.input.fieldManagement.addNewField")]}),e.jsxs("fieldset",{className:"space-y-4",children:[e.jsx("legend",{className:"sr-only",children:s("aria.newFieldDetails")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:"new-field-name",className:"block text-sm font-medium text-gray-700 mb-1",children:[s("pages.input.fieldManagement.fieldNameRequired")," ",e.jsx("span",{className:"text-red-600","aria-label":s("fields.required"),children:"*"})]}),e.jsx("input",{id:"new-field-name",type:"text",value:A.newField.name,onChange:e=>A.setNewField(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:s("pages.input.fieldManagement.fieldNamePlaceholder"),required:!0,"aria-required":"true","aria-describedby":"new-field-name-desc","aria-invalid":A.addFieldError&&A.addFieldError.includes(s("validation.fieldNameRequired"))?"true":"false"}),e.jsx("div",{id:"new-field-name-desc",className:"sr-only",children:s("aria.fieldNameDescription")})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsxs("label",{htmlFor:"new-field-type",className:"block text-sm font-medium text-gray-700 mb-1",children:[s("pages.input.fieldManagement.dataTypeRequired")," ",e.jsx("span",{className:"text-red-600","aria-label":s("fields.required"),children:"*"})]}),e.jsxs("select",{id:"new-field-type",value:A.newField.type,onChange:e=>A.setNewField(t=>({...t,type:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",required:!0,"aria-required":"true","aria-describedby":"new-field-type-desc",children:[e.jsx("option",{value:"number",children:s("fields.types.number")}),e.jsx("option",{value:"string",children:s("fields.types.string")}),e.jsx("option",{value:"boolean",children:s("fields.types.boolean")})]}),e.jsx("div",{id:"new-field-type-desc",className:"sr-only",children:s("aria.dataTypeDescription")})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsx("label",{htmlFor:"new-field-unit",className:"block text-sm font-medium text-gray-700 mb-1",children:s("pages.input.fieldManagement.unitOptional")}),e.jsx("input",{id:"new-field-unit",type:"text",value:A.newField.unit,onChange:e=>A.setNewField(t=>({...t,unit:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:"例: kg","aria-describedby":"new-field-unit-desc"}),e.jsx("div",{id:"new-field-unit-desc",className:"sr-only",children:s("aria.unitFieldDescription")})]})]}),A.addFieldError&&e.jsxs("div",{id:"add-field-error",className:"text-red-600 font-semibold bg-red-50 p-3 rounded-lg border border-red-200",role:"alert","aria-live":"polite",children:[e.jsx("span",{className:"sr-only",children:s("aria.formError")}),A.addFieldError]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 pt-2",children:[e.jsxs("button",{type:"submit",className:"bg-teal-500 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-teal-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 text-sm sm:text-base flex-1 sm:min-w-[120px]","aria-describedby":A.addFieldError?"add-field-error":void 0,children:[e.jsx(w,{className:"w-4 h-4","aria-hidden":"true"}),s("actions.add")]}),e.jsxs("button",{type:"button",onClick:()=>A.setShowAddField(!1),className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 text-sm sm:text-base flex-1 sm:min-w-[120px]",children:[e.jsx(u,{className:"w-4 h-4","aria-hidden":"true"}),s("actions.cancel")]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[!A.showAddField&&e.jsxs("button",{type:"button",onClick:()=>A.setShowAddField(!0),className:"bg-teal-500 text-white px-3 sm:px-4 py-2 rounded-lg shadow-md hover:bg-teal-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base whitespace-nowrap",children:[e.jsx(w,{className:"w-4 h-4"}),s("pages.input.fieldManagement.addNewField")]}),e.jsxs("button",{type:"button",onClick:()=>A.setShowSelectField(!1),className:"bg-gray-500 text-white px-3 sm:px-4 py-2 rounded-lg shadow-md hover:bg-gray-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",children:[e.jsx(j,{className:"w-4 h-4 sm:w-5 sm:h-5"}),s("actions.back")]})]})]})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>A.setShowSelectField(!0),className:"bg-blue-500 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base","aria-label":l("showField",{fieldName:s("pages.input.selectFields")}),children:[e.jsx(b,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),s("pages.input.selectFields")]}),e.jsxs("button",{type:"button",onClick:A.handleOpenSortModal,disabled:M.loading||0===C.length,className:"px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base "+(M.loading||0===C.length?"bg-gray-400 text-white cursor-not-allowed":"bg-purple-500 text-white hover:bg-purple-600"),"aria-label":l("sort",{fieldName:s("pages.input.sortFields")}),children:[e.jsx(c,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),M.loading?s("common.loading"):s("pages.input.sortFields")]})]})}),e.jsx(L,{isOpen:A.showSortModal,onClose:()=>A.setShowSortModal(!1),fields:A.sortableFields,onDragEnd:A.handleDragEnd,onSave:A.handleSaveSortOrder,onToggleDisplay:A.handleToggleDisplayInModal})]})})}export{V as default};
