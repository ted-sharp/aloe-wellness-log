import{j as a}from"./ui-vendor-J9A7wRLG.js";import{a as t}from"./react-vendor-C4GzcRrE.js";import{B as e,m as s,h as n,N as r,K as l,r as o,f as i,R as d,z as c}from"./index-iR6G4H9o.js";import{B as m}from"./Button-DQwbRege.js";import{E as h,S as u,I as g}from"./StatusMessage-C95Tjw0W.js";import"./icons-vendor-DCv9Y2bB.js";import"./state-vendor-RA6ewXRt.js";const x={primary:"bg-blue-600",success:"bg-green-600",warning:"bg-amber-500",error:"bg-red-600"},f={sm:"h-2",md:"h-3",lg:"h-4"},$=({value:t,max:e=100,showPercentage:s=!0,showValue:n=!1,label:r,size:l="md",variant:o="primary",className:i="",animated:d=!0})=>{const c=Math.min(Math.max(t,0),e),m=c/e*100,h=["w-full bg-gray-200 rounded-full overflow-hidden",f[l],i].join(" "),u=["h-full transition-all duration-300 ease-out",x[o],d?"transition-all duration-300":""].join(" ");return a.jsxs("div",{className:"w-full",children:[(r||s||n)&&a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:r}),a.jsxs("div",{className:"text-sm text-gray-600 flex gap-2",children:[n&&a.jsxs("span",{children:[c," / ",e]}),s&&a.jsxs("span",{children:[Math.round(m),"%"]})]})]}),a.jsx("div",{className:h,role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":e,children:a.jsx("div",{className:u,style:{width:`${m}%`}})})]})},j=t.memo(function({onStatusChange:l}){const[x,f]=t.useState(null),[j,p]=t.useState(0),[w,y]=t.useState(!1),[M,b]=t.useState(0),[v,S]=t.useState(0),[k,N]=t.useState(0),[D,_]=t.useState(""),[C,E]=t.useState(""),[I,U]=t.useState(""),F=t.useCallback(async()=>{try{const[a,t,r]=await Promise.all([e(),s(),n()]);if(b(a.length),S(t.length),N(r.length),a.length>0){const t=a.map(a=>a.date).sort();_(`${t[0]} ～ ${t[t.length-1]}`)}else _("");if(t.length>0){const a=t.map(a=>a.date).sort();E(`${a[0]} ～ ${a[a.length-1]}`)}else E("");if(r.length>0){const a=r.map(a=>a.date).sort();U(`${a[0]} ～ ${a[a.length-1]}`)}else U("")}catch(a){}},[]),B=t.useCallback(async()=>{f("体重テストデータを生成中..."),y(!0),p(0),null==l||l("体重テストデータを生成中...");try{const t=180,e=75,s=50,n=100;let o=0;for(let l=t-1;l>=0;l--){const i=new Date;i.setDate(i.getDate()-l);const d=i.getFullYear(),c=String(i.getMonth()+1).padStart(2,"0"),m=`${d}-${c}-${String(i.getDate()).padStart(2,"0")}`,h="08:00";let u=e-.05*(t-l)+2*(Math.random()-.5);u=Math.max(s,Math.min(n,Math.round(10*u)/10));let g=25-.02*(t-l)+.3*(Math.random()-.5);g=Math.max(8,Math.min(35,Math.round(10*g)/10));let x=85-.03*(t-l)+.3*(Math.random()-.5);x=Math.max(60,Math.min(100,Math.round(10*x)/10));const f={id:`test_weight_${m}_${Math.random().toString(36).substr(2,6)}`,date:m,time:h,weight:u,bodyFat:Math.random()>.2?g:null,waist:Math.random()>.2?x:null,note:Math.random()>.7?"テストメモ":null,excludeFromGraph:Math.random()>.5};try{await r(f),o++,p(o/t*50)}catch(a){}}f(`体重テストデータ生成完了: ${o}/${t}件`),null==l||l(`体重テストデータ生成完了: ${o}/${t}件`),await F()}catch(a){f(`エラー: ${a instanceof Error?a.message:"Unknown error"}`),null==l||l(`エラー: ${a instanceof Error?a.message:"Unknown error"}`)}finally{y(!1)}},[l,F]),Y=t.useCallback(async()=>{f("日課テストデータを生成中..."),y(!0),p(50),null==l||l("日課テストデータを生成中...");try{const t=[{fieldId:"exercise"},{fieldId:"meal"},{fieldId:"sleep"},{fieldId:"smoke"},{fieldId:"alcohol"}],e=180;let s=0;for(let n=e-1;n>=0;n--){const r=new Date;r.setDate(r.getDate()-n);const l=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),d=`${l}-${i}-${String(r.getDate()).padStart(2,"0")}`;for(const e of t){const t=Math.random();let s;s=t<.3?1:t<.6?.5:0;const n={id:`test_daily_${e.fieldId}_${d}_${Math.random().toString(36).substr(2,6)}`,date:d,fieldId:e.fieldId,value:s};try{await o(n)}catch(a){}}s++,p(50+s/e*25)}f(`日課テストデータ生成完了: ${s*t.length}件`),null==l||l(`日課テストデータ生成完了: ${s*t.length}件`),await F()}catch(a){f(`エラー: ${a instanceof Error?a.message:"Unknown error"}`),null==l||l(`エラー: ${a instanceof Error?a.message:"Unknown error"}`)}},[l,F]),z=t.useCallback(async()=>{f("血圧テストデータを生成中..."),p(75),null==l||l("血圧テストデータを生成中...");try{const t=180;let e=0;for(let s=t-1;s>=0;s--){const n=new Date;n.setDate(n.getDate()-s);const r=n.getFullYear(),l=String(n.getMonth()+1).padStart(2,"0"),o=`${r}-${l}-${String(n.getDate()).padStart(2,"0")}`,d=["08:00","22:00"];for(const t of d){const e=110+Math.round(30*Math.random()),s=60+Math.round(30*Math.random()),n=60+Math.round(40*Math.random()),r={id:`test_bp_${o}_${t.replace(":","")}_${Math.random().toString(36).substr(2,6)}`,date:o,time:t,systolic:e,diastolic:s,heartRate:n,note:Math.random()>.8?"テストメモ":null};try{await i(r)}catch(a){}}e++,p(75+e/t*25)}f(`血圧テストデータ生成完了: ${2*e}件`),null==l||l(`血圧テストデータ生成完了: ${2*e}件`),await F()}catch(a){f(`エラー: ${a instanceof Error?a.message:"Unknown error"}`),null==l||l(`エラー: ${a instanceof Error?a.message:"Unknown error"}`)}finally{y(!1),p(100)}},[l,F]),P=t.useCallback(async()=>{const a=`generate-test-data-${Date.now()}`;d.trackDatabase.start(a,"generate-test-data");try{await B(),await Y(),await z(),f("すべてのテストデータ生成が完了しました"),null==l||l("すべてのテストデータ生成が完了しました")}catch(t){f(`エラー: ${t instanceof Error?t.message:"Unknown error"}`),null==l||l(`エラー: ${t instanceof Error?t.message:"Unknown error"}`)}finally{d.trackDatabase.end(a,"generate-test-data"),y(!1)}},[B,Y,z,l]);return a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow p-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-700 dark:text-gray-200 flex items-center gap-2 justify-center",children:[a.jsx(c,{className:"w-6 h-6"}),"テストデータ生成"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex justify-center",children:a.jsxs("div",{className:"text-left max-w-md",children:[a.jsxs("p",{children:["• 体重: ",M,"件 ",D&&`(${D})`]}),a.jsxs("p",{children:["• 日課: ",v,"件 ",C&&`(${C})`]}),a.jsxs("p",{children:["• 血圧: ",k,"件 ",I&&`(${I})`]})]})}),a.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[a.jsx(m,{variant:"primary",icon:c,onClick:B,disabled:w,children:"体重テストデータ生成"}),a.jsx(m,{variant:"primary",icon:c,onClick:Y,disabled:w,children:"日課テストデータ生成"}),a.jsx(m,{variant:"primary",icon:c,onClick:z,disabled:w,children:"血圧テストデータ生成"}),a.jsx(m,{variant:"success",icon:c,onClick:P,disabled:w,children:"すべて生成"})]}),w&&a.jsx($,{value:j,label:"テストデータを生成中..."}),x&&a.jsx("div",{className:"mt-4",children:x.includes("エラー")?a.jsx(h,{message:x}):x.includes("完了")?a.jsx(u,{message:x}):a.jsx(g,{message:x})})]})]})})});export{j as default};
