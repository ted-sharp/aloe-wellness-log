import{j as e}from"./ui-vendor-D7AUAfXm.js";import{a as t,b as r}from"./react-vendor-BzNAZZ5j.js";import{u as a,H as s,a as i,b as d,c as n,d as l,e as o,f as c,g as u,h as g,i as m,j as x,k as f,l as p,m as b,n as h,o as y,p as w,q as v,r as k,v as j,s as N,t as S}from"./index-_d5zLM54.js";import{u as F,a as C,D as E,c as D,S as I,v as M,s as $,K as T,P as A,b as P,C as O,d as q}from"./dnd-vendor-BBd399mu.js";import"./icons-vendor-DoCnAwwa.js";import"./state-vendor-O6FgWrPy.js";const R=t.memo(({recordDate:t,recordTime:r,onDateChange:d,onTimeChange:n,onSetCurrentDateTime:l})=>{const{t:o}=a();return e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:e.jsxs("fieldset",{className:"space-y-4",children:[e.jsxs("legend",{className:"text-2xl font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(s,{className:"w-6 h-6 text-blue-600 dark:text-blue-400","aria-hidden":"true"}),o("pages.input.recordDateTime")]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"record-date",className:"block text-base font-medium text-gray-700 dark:text-gray-200 mb-2",children:o("pages.input.date")}),e.jsx("input",{id:"record-date",type:"date",value:t,onChange:e=>d(e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400","aria-describedby":"record-date-desc",required:!0,"aria-required":"true"}),e.jsx("div",{id:"record-date-desc",className:"sr-only",children:o("pages.input.dateDescription")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"record-time",className:"block text-base font-medium text-gray-700 dark:text-gray-200 mb-2",children:o("pages.input.time")}),e.jsx("input",{id:"record-time",type:"time",value:r,onChange:e=>n(e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400","aria-describedby":"record-time-desc",required:!0,"aria-required":"true"}),e.jsx("div",{id:"record-time-desc",className:"sr-only",children:o("pages.input.timeDescription")})]}),e.jsxs("div",{className:"flex items-end",children:[e.jsxs("button",{type:"button",onClick:l,className:"bg-blue-500 dark:bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors duration-200 font-medium flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800","aria-label":o("pages.input.setCurrentDateTime"),"aria-describedby":"current-time-desc",children:[e.jsx(i,{className:"w-5 h-5","aria-hidden":"true"}),o("pages.input.setCurrentDateTime")]}),e.jsx("div",{id:"current-time-desc",className:"sr-only",children:o("pages.input.currentTimeDescription")})]})]})]})})});R.displayName="DateTimeSelector";const _=t.memo(({value:r,onChange:s,maxLength:i=500,placeholder:n})=>{const{t:l}=a(),o=t.useCallback(e=>{s(e.target.value)},[s]),c=r.length,u=i-c,g=c>.8*i,m=n||l("pages.input.notesPlaceholder");return e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{htmlFor:"notes-input",className:"text-2xl font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(d,{className:"w-6 h-6 text-blue-600 dark:text-blue-400","aria-hidden":"true"}),l("pages.input.notes")]}),e.jsxs("div",{children:[e.jsx("textarea",{id:"notes-input",value:r,onChange:o,placeholder:m,className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 h-24 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400 resize-none placeholder:text-gray-500 dark:placeholder:text-gray-400",maxLength:i,"aria-describedby":"notes-char-count notes-description","aria-label":l("pages.input.notesPlaceholder")}),e.jsx("div",{id:"notes-description",className:"sr-only",children:l("pages.input.notesDescription",{maxLength:i})}),e.jsxs("div",{id:"notes-char-count",className:"text-right text-sm mt-2 "+(g?"text-orange-600 dark:text-orange-400 font-medium":"text-gray-600 dark:text-gray-400"),"aria-live":"polite","aria-label":l("aria.charactersEntered",{count:c,remaining:u}),children:[l("pages.input.characterCount",{count:c,max:i}),g&&e.jsxs("span",{className:"ml-2 text-orange-600 dark:text-orange-400",children:["(残り",u,"文字)"]})]})]})]})})});function B({field:r,onToggleDisplay:s}){const{t:i}=a(),{attributes:d,listeners:n,setNodeRef:c,transform:u,transition:g,isDragging:x}=P({id:r.fieldId}),{announcePolite:f}=l(),p={transform:O.Transform.toString(u),transition:g,opacity:x?.5:1},b=t.useCallback(e=>{e.stopPropagation(),e.preventDefault();const t=!r.defaultDisplay;s(r.fieldId),f(`${r.name}${i("dialogs.sortModal.toggledAnnouncement",{state:i(t?"dialogs.sortModal.visible":"dialogs.sortModal.hidden")})}`)},[r.fieldId,r.defaultDisplay,r.name,s,f,i]),h=t.useCallback(()=>{const e=!r.defaultDisplay;s(r.fieldId),f(`${r.name}${i("dialogs.sortModal.toggledAnnouncement",{state:i(e?"dialogs.sortModal.visible":"dialogs.sortModal.hidden")})}`)},[r.fieldId,r.defaultDisplay,r.name,s,f,i]),y={onEnter:h,onSpace:h},{handleKeyDown:w}=o(y),v=r.defaultDisplay?i("dialogs.sortModal.visibleDescription"):i("dialogs.sortModal.hiddenDescription");return e.jsx("div",{ref:c,style:p,className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-2 sm:p-3 hover:shadow-md transition-all duration-200 hover:border-purple-300 dark:hover:border-purple-400",...d,role:"listitem","aria-label":`${r.name}${i("common.item")} - ${v} ${i("accessibility.sortable")}`,children:e.jsxs("div",{className:"flex flex-col sm:grid sm:gap-3 sm:items-center gap-2",style:{gridTemplateColumns:"auto 1fr 1fr auto"},children:[e.jsxs("div",{className:"flex justify-between items-center sm:hidden",children:[e.jsx("div",{className:"text-lg font-medium text-gray-700 dark:text-gray-200",children:r.name}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400","aria-label":`${i("dialogs.sortModal.unit")}: ${r.unit||i("dialogs.sortModal.noUnit")}`,children:r.unit?`(${r.unit})`:"―"})]}),e.jsxs("div",{className:"flex justify-between items-center sm:hidden",children:[e.jsx("div",{children:r.defaultDisplay?e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-green-200 dark:hover:bg-green-900/50 focus:outline-none focus:ring-2 focus:ring-green-500 dark:focus:ring-green-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${r.name}${i("dialogs.sortModal.makeHidden")}`,"aria-pressed":"true",children:i("dialogs.sortModal.visible")}):e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${r.name}${i("dialogs.sortModal.makeVisible")}`,"aria-pressed":"false",children:i("dialogs.sortModal.hidden")})}),e.jsx("div",{className:"flex justify-center cursor-move focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-1 rounded p-1",tabIndex:0,role:"button","aria-label":`${r.name}${i("dialogs.sortModal.dragToSort")}`,...n,children:e.jsx(m,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-150","aria-hidden":"true"})})]}),e.jsxs("div",{className:"hidden sm:contents",children:[e.jsx("div",{className:"text-center border-r border-gray-200 dark:border-gray-600 pr-3",children:r.defaultDisplay?e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-green-200 dark:hover:bg-green-900/50 focus:outline-none focus:ring-2 focus:ring-green-500 dark:focus:ring-green-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${r.name}${i("dialogs.sortModal.makeHidden")}`,"aria-pressed":"true",children:i("dialogs.sortModal.visible")}):e.jsx("button",{onClick:b,onKeyDown:w,className:"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${r.name}${i("dialogs.sortModal.makeVisible")}`,"aria-pressed":"false",children:i("dialogs.sortModal.hidden")})}),e.jsx("div",{className:"text-lg font-medium text-gray-700 dark:text-gray-200 border-r border-gray-200 dark:border-gray-600 pr-3 text-right",children:r.name}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400 border-r border-gray-200 dark:border-gray-600 pr-3 text-left","aria-label":`${i("dialogs.sortModal.unit")}: ${r.unit||i("dialogs.sortModal.noUnit")}`,children:r.unit?`(${r.unit})`:"―"}),e.jsx("div",{className:"flex justify-center cursor-move focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-1 rounded p-1",tabIndex:0,role:"button","aria-label":`${r.name}${i("dialogs.sortModal.dragToSort")}`,...n,children:e.jsx(m,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-150","aria-hidden":"true"})})]})]})})}_.displayName="NotesInput";const H=({isOpen:s,onClose:i,fields:d,onDragEnd:m,onSave:x,onToggleDisplay:f})=>{const{t:p}=a(),{modalProps:b}=n(s),{announcePolite:h}=l(),y={onEscape:i},{handleKeyDown:w}=o(y),v=F(C(A),C(T,{coordinateGetter:$})),k=t.useCallback(e=>{const{active:t,over:r}=e;if(t.id!==(null==r?void 0:r.id)){m(e);const a=d.find(e=>e.fieldId===t.id),s=d.find(e=>e.fieldId===(null==r?void 0:r.id));a&&s&&h(`${a.name}${p("dialogs.sortModal.dragEndAnnouncement",{target:s.name})}`)}},[m,d,h,p]),j=t.useCallback(()=>{x(),h(p("dialogs.sortModal.savedAnnouncement"))},[x,h,p]);return t.useEffect(()=>{s&&h(p("dialogs.sortModal.openedAnnouncement"))},[s,h,p]),t.useEffect(()=>(s&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[s]),s?r.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",...b,children:[e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.3)"},onClick:i}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsxs("div",{className:"relative w-full max-w-sm sm:max-w-xl transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-4 sm:p-6 text-left align-middle shadow-xl transition-all",onKeyDown:w,onClick:e=>e.stopPropagation(),children:[e.jsxs("h3",{className:"text-xl sm:text-2xl font-bold leading-6 text-gray-900 dark:text-white mb-4 sm:mb-6 flex items-center gap-2",id:"sort-modal-title",children:[e.jsx(c,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600 dark:text-purple-400","aria-hidden":"true"}),p("dialogs.sortModal.title")]}),e.jsx("div",{className:"mb-4",id:"sort-modal-description",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-xs sm:text-sm",children:p("dialogs.sortModal.description")})}),e.jsx(E,{sensors:v,collisionDetection:D,onDragEnd:k,accessibility:{announcements:{onDragStart:({active:e})=>{const t=d.find(t=>t.fieldId===e.id);return`${(null==t?void 0:t.name)||"アイテム"}${p("dialogs.sortModal.dragStartAnnouncement")}`},onDragOver:({active:e,over:t})=>{const r=d.find(t=>t.fieldId===e.id),a=d.find(e=>e.fieldId===(null==t?void 0:t.id));return r&&a?`${r.name}${p("dialogs.sortModal.dragOverAnnouncement",{target:a.name})}`:""},onDragEnd:({active:e,over:t})=>{const r=d.find(t=>t.fieldId===e.id),a=d.find(e=>e.fieldId===(null==t?void 0:t.id));return e.id===(null==t?void 0:t.id)?`${(null==r?void 0:r.name)||"アイテム"}${p("dialogs.sortModal.dragReturnAnnouncement")}`:r&&a?`${r.name}${p("dialogs.sortModal.dragEndAnnouncement",{target:a.name})}`:`${(null==r?void 0:r.name)||"アイテム"}${p("dialogs.sortModal.dragCompleteAnnouncement")}`},onDragCancel:({active:e})=>{const t=d.find(t=>t.fieldId===e.id);return`${(null==t?void 0:t.name)||"アイテム"}${p("dialogs.sortModal.dragCancelAnnouncement")}`}}},children:e.jsx(I,{items:d.map(e=>e.fieldId),strategy:M,children:e.jsx("div",{className:"space-y-2 max-h-[50vh] sm:max-h-[60vh] overflow-y-auto pr-1 sm:pr-2",role:"list","aria-label":p("dialogs.sortModal.listLabel"),"aria-describedby":"sort-modal-description",children:d.map(t=>e.jsx(B,{field:t,onToggleDisplay:f},t.fieldId))})})}),e.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-col sm:flex-row gap-3 sm:justify-end",role:"group","aria-label":p("dialogs.sortModal.buttonsLabel"),children:[e.jsxs("button",{type:"button",className:"bg-gray-400 dark:bg-gray-600 text-white px-4 sm:px-6 py-2 rounded-lg shadow-md hover:bg-gray-500 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",onClick:i,"aria-label":p("dialogs.sortModal.cancelLabel"),children:[e.jsx(u,{className:"w-4 h-4","aria-hidden":"true"}),p("common.cancel")]}),e.jsxs("button",{type:"button",className:"bg-purple-600 dark:bg-purple-700 text-white px-4 sm:px-6 py-2 rounded-lg shadow-md hover:bg-purple-700 dark:hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",onClick:j,"aria-label":p("dialogs.sortModal.saveLabel"),children:[e.jsx(g,{className:"w-4 h-4","aria-hidden":"true"}),p("common.save")]})]})]})})]}),document.body):null};var L=(e=>(e.CONNECTION_FAILED="connection_failed",e.TRANSACTION_FAILED="transaction_failed",e.DATA_CORRUPTED="data_corrupted",e.QUOTA_EXCEEDED="quota_exceeded",e.VERSION_ERROR="version_error",e.UNKNOWN="unknown",e))(L||{});function K(){const{showError:e,showWarning:r}=x(),a=t.useCallback((t,a={})=>{const{showToast:s=!0,logToConsole:i=!0,context:d,fallbackMessage:n}=a,l=function(e){if(e&&"object"==typeof e&&"type"in e&&"retryable"in e&&"message"in e){const t=e;if(Object.values(L).includes(t.type)){const t=e;return{type:"database",message:t.message,originalError:t.originalError,context:{dbErrorType:t.type,retryable:t.retryable}}}}if(e instanceof Error){const t=e.message.toLowerCase();return t.includes("indexeddb")||t.includes("database")||t.includes("store")?{type:"database",message:"データベース操作でエラーが発生しました",originalError:e}:t.includes("parse")||t.includes("json")||t.includes("csv")?{type:"parse",message:"データの解析でエラーが発生しました",originalError:e}:t.includes("validation")||t.includes("必須")||t.includes("形式")?{type:"validation",message:e.message,originalError:e}:t.includes("network")||t.includes("fetch")||t.includes("request")?{type:"network",message:"ネットワークエラーが発生しました",originalError:e}:{type:"unknown",message:e.message,originalError:e}}return{type:"unknown",message:"予期しないエラーが発生しました",context:{originalError:e}}}(t);i&&function(e){var t;e.message,e.originalError,"database"===e.type&&(null==(t=e.context)||t.dbErrorType)}(l);const o=n||function(e){var t;switch(e.type){case"validation":return e.message;case"database":if(null==(t=e.context)?void 0:t.dbErrorType){const t=e.context.dbErrorType,r=e.context.retryable;switch(t){case"quota_exceeded":return"ストレージ容量が不足しています。不要なデータを削除してから再度お試しくださいませ。";case"connection_failed":return r?"データベース接続に失敗しました。しばらく待ってから再度お試しくださいませ。":"データベース接続に問題があります。ページを再読み込みしてお試しくださいませ。";case"transaction_failed":return"データベース処理中にエラーが発生しました。もう一度お試しくださいませ。";case"data_corrupted":return"データが破損している可能性があります。管理画面からデータの確認をお勧めいたします。";case"version_error":return"データベースの更新中です。ページを再読み込みしてお試しくださいませ。";default:return e.message||"データベース操作でエラーが発生いたしました。"}}return"データの保存・読み込みに失敗いたしました。もう一度お試しくださいませ。";case"parse":return"ファイルの形式が正しくありません。ファイルの内容をご確認くださいませ。";case"network":return"ネットワーク接続に問題があります。接続状況をご確認くださいませ。";case"permission":return"この操作を実行する権限がありません。";default:return e.message||"予期しないエラーが発生いたしました。"}}(l);return s&&("validation"===l.type?r(o):e(o)),l},[e,r]),s=t.useCallback(async(e,t={})=>{try{return await e()}catch(r){return a(r,t),null}},[a]),i=t.useCallback((e,t={})=>e.map(({error:e,context:r})=>a(e,{...t,context:r})),[a]);return{handleError:a,handleAsyncError:s,handleBatchErrors:i}}const V=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,Y=e=>`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`,U=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`;function z(){const{t:r,translateFieldName:s,translateError:i,getAriaLabel:n,getAnnouncement:o}=a(),{announcePolite:m}=l();p(),K();const{fields:F,loadFields:C,addRecord:E,loadRecords:D,records:I,fieldsOperation:M}=f(),{showSuccess:$,showError:T}=x(),A=function(){const{t:e,getAnnouncement:r}=a(),{fields:s,loadFields:i,addField:d,updateField:n,deleteField:l}=f(),{showSuccess:o,showError:c}=x(),{handleAsyncError:u}=K(),[g,m]=t.useState(!1),[p,b]=t.useState(!1),[h,y]=t.useState({name:"",type:"number",unit:""}),[w,v]=t.useState(null),[k,j]=t.useState({}),[N,S]=t.useState(null),[F,C]=t.useState(null),[E,D]=t.useState({}),[I,M]=t.useState(new Set),[$,T]=t.useState(new Set),[A,P]=t.useState(new Set),[O,R]=t.useState(!1),[_,B]=t.useState([]),H=t.useRef([]),L=t.useCallback(()=>0===s.length?1:Math.max(...s.map(e=>e.order||0))+1,[s]),V=t.useCallback(()=>s.filter(e=>!1===e.defaultDisplay).sort((e,t)=>(e.order||999)-(t.order||999)),[s]),Y=t.useCallback(async t=>{if(t.preventDefault(),S(null),!h.name.trim())return void S(e("validation.fieldNameInput"));if(s.some(e=>e.name===h.name.trim()))return void S(e("validation.duplicateFieldName"));const a=h.name.trim().replace(/\s+/g,"_").toLowerCase();await u(async()=>{var e;return await d({fieldId:a,name:h.name.trim(),type:h.type,unit:(null==(e=h.unit)?void 0:e.trim())||void 0,order:L(),defaultDisplay:!1}),M(e=>new Set([...e,a])),y({name:"",type:"number",unit:""}),b(!1),m(!1),await i(),!0},{context:e("actions.add"),fallbackMessage:e("errors.general")})&&o(r("fieldAddedSuccess"))},[h,s,d,L,u,i,o]),U=t.useCallback(e=>{v(e.fieldId),j({name:e.name,unit:e.unit})},[]),z=t.useCallback(async()=>{var t;if(!w||!(null==(t=k.name)?void 0:t.trim()))return v(null),j({}),void T(new Set);const a=s.find(e=>e.fieldId===w);a&&(await u(async()=>{var e;return await n({...a,name:k.name.trim(),unit:(null==(e=k.unit)?void 0:e.trim())||void 0}),await i(),!0},{context:e("actions.edit"),fallbackMessage:e("errors.general")})&&o(r("fieldEditedSuccess")),v(null),j({}),T(new Set))},[w,k,s,n,u,i,o]),W=t.useCallback(e=>{s.find(t=>t.fieldId===e)&&(M(t=>new Set([...t,e])),m(!1),P(new Set),o(r("fieldTempDisplayAdded")))},[s,o]),G=t.useCallback(async e=>{const t=s.find(t=>t.fieldId===e);if(!t)return;const a={...t,defaultDisplay:!0},d=s.map(t=>t.fieldId===e?a:t);f.setState({fields:d});try{await n(a),M(t=>{const r=new Set(t);return r.delete(e),r}),P(new Set),m(!1),await i(),o(r("fieldDisplayChanged"))}catch(l){f.setState({fields:s});const e=l instanceof Error?l.message:"表示状態の変更に失敗しました";c(e)}},[s,n,u,i,o]),Q=t.useCallback(e=>{C(e.fieldId),D({name:e.name,unit:e.unit}),P(new Set)},[]),X=t.useCallback(async()=>{var t;if(!F||!(null==(t=E.name)?void 0:t.trim()))return C(null),D({}),void P(new Set);const a=s.find(e=>e.fieldId===F);a&&(await u(async()=>{var e;return await n({...a,name:E.name.trim(),unit:(null==(e=E.unit)?void 0:e.trim())||void 0,order:a.order,defaultDisplay:a.defaultDisplay}),await i(),!0},{context:e("actions.edit"),fallbackMessage:e("errors.general")})&&o(r("fieldEditedSuccess")),C(null),D({}),P(new Set))},[F,E,s,n,u,i,o]),J=t.useCallback(async t=>{window.confirm(e("common.confirmDeleteField",{fieldName:t.name}))&&await u(async()=>(await l(t.fieldId),await i(),P(new Set),!0),{context:e("actions.delete"),fallbackMessage:e("errors.general")})&&o(r("fieldDeletedSuccess"))},[l,u,i,o]),Z=t.useCallback(e=>{T(t=>{const r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),ee=t.useCallback(e=>$.has(e),[$]),te=t.useCallback(()=>{T(new Set)},[]),re=t.useCallback(e=>{P(t=>{const r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),ae=t.useCallback(e=>A.has(e),[A]),se=t.useCallback(()=>{P(new Set)},[]),ie=t.useCallback(async()=>{let t=s;if(0===t.length)try{await i();const{fields:r}=f.getState();if(t=r,0===t.length)return void c(e("errors.fieldDataNotFound"))}catch(a){return void c(e("errors.fieldDataLoadFailed"))}const r=[...t].sort((e,t)=>(e.order||999)-(t.order||999));B(r),H.current=r,R(!0)},[s,i,c]),de=t.useCallback(e=>{const{active:t,over:r}=e;if(r&&t.id!==r.id){const e=_.findIndex(e=>e.fieldId===t.id),a=_.findIndex(e=>e.fieldId===r.id),s=q(_,e,a);B(s),H.current=s}},[_]),ne=t.useCallback(async()=>{await u(async()=>{const e=H.current.map((e,t)=>{const r={...e,order:t+1};return n(r)});return await Promise.all(e),await new Promise(e=>setTimeout(e,50)),await i(),R(!1),!0},{context:e("actions.sort"),fallbackMessage:e("errors.general")})&&o(r("sortOrderSaved"))},[n,u,i,o]),le=t.useCallback(async e=>{await u(async()=>(await n({...e,defaultDisplay:!1}),M(t=>{const r=new Set(t);return r.delete(e.fieldId),r}),T(new Set),await i(),!0),{context:"項目非表示",fallbackMessage:"項目の非表示に失敗しました"})&&o(r("fieldHidden"))},[n,u,i,o]),oe=t.useCallback(async e=>{const t=_.find(t=>t.fieldId===e);if(!t)return;const r={...t,defaultDisplay:!t.defaultDisplay};await u(async()=>{await n(r);const t=_.map(t=>t.fieldId===e?r:t);B(t),H.current=t;const a=s.map(t=>t.fieldId===e?r:t);return f.setState({fields:a}),r.defaultDisplay?M(t=>{const r=new Set(t);return r.delete(e),r}):s.some(t=>t.fieldId===e&&(t.defaultDisplay||I.has(e)))&&M(t=>new Set([...t,e])),!0},{context:"モーダル内表示状態変更",fallbackMessage:"表示状態の変更に失敗しました"})},[_,s,I,n,u]);return{showSelectField:g,setShowSelectField:m,showAddField:p,setShowAddField:b,newField:h,setNewField:y,editFieldId:w,setEditFieldId:v,editField:k,setEditField:j,addFieldError:N,editingExistingFieldId:F,setEditingExistingFieldId:C,editingExistingField:E,setEditingExistingField:D,temporaryDisplayFields:I,showSortModal:O,setShowSortModal:R,sortableFields:_,getHiddenFields:V,handleAddField:Y,handleEditField:U,handleEditFieldSave:z,handleShowExistingField:W,handleShowExistingFieldPermanently:G,handleEditExistingField:Q,handleEditExistingFieldSave:X,handleDeleteExistingField:J,toggleButtons:Z,areButtonsShown:ee,toggleSelectButtons:re,areSelectButtonsShown:ae,handleOpenSortModal:ie,handleDragEnd:de,handleSaveSortOrder:ne,handleHideField:le,handleToggleDisplayInModal:oe,clearButtons:te,clearSelectButtons:se}}(),[P,O]=t.useState({}),[B,L]=t.useState(null),[z,W]=t.useState(()=>V(new Date)),[G,Q]=t.useState(()=>Y(new Date)),[X,J]=t.useState(""),[Z,ee]=t.useState(!1);t.useEffect(()=>{C(),D()},[C,D]);const te=(e,t)=>{O(r=>({...r,[e]:t})),L(null);const a=F.find(t=>t.fieldId===e);"boolean"===(null==a?void 0:a.type)&&"boolean"==typeof t&&m(o("fieldChanged",{fieldName:s(a.fieldId),value:r(t?"fields.yes":"fields.no")}))},re=(e,t)=>null!=t&&("boolean"===e.type?!0===t||!1===t:"number"===e.type?"number"==typeof t&&!isNaN(t):"string"==typeof t&&t.trim().length>0),ae=e=>{const t=(e=>{const t=[...I].filter(t=>t.fieldId===e).sort((e,t)=>new Date(t.datetime).getTime()-new Date(e.datetime).getTime())[0];return(null==t?void 0:t.value)??""})(e);if(""!==t){te(e,t);const r=F.find(t=>t.fieldId===e);r&&m(o("previousValueSet",{fieldName:s(r.fieldId)}))}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 to-blue-100 dark:from-gray-800 dark:to-gray-900 p-2 sm:p-4",children:e.jsxs("div",{className:"max-w-full sm:max-w-4xl mx-auto px-2 sm:px-0",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-gray-800 dark:text-white mb-2 whitespace-nowrap",children:r("pages.input.title")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base",children:r("pages.input.description")})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=(()=>{if(!j(z))return"日付の形式が正しくありません (YYYY-MM-DD)";if(!N(G))return"時刻の形式が正しくありません (HH:mm)";for(const e of F){const t=P[e.fieldId];if(re(e,t)){const r=S(t,e.type,{required:!1,min:"number"===e.type?0:void 0,max:"number"===e.type?1e4:void 0});if(!r.isValid)return`${e.name}: ${r.errors.join(", ")}`}}return X.length>500?"備考は500文字以内で入力してください":""!==X.trim()||F.some(e=>re(e,P[e.fieldId]))?null:r("validation.required")})();if(t)return L(t),void m(r("errors.inputError",{message:t}));try{let e=0;const t=[];for(const r of F){const a=P[r.fieldId];if(re(r,a)){const s=new Date(`${z}T${G}:00`);t.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:r.fieldId,value:a,date:z,time:G,datetime:U(s)}),e++}}if(""!==X.trim()){const r=new Date(`${z}T${G}:00`);t.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:"notes",value:X.trim(),date:z,time:G,datetime:U(r)}),e++}for(const r of t)await E(r);m(o("recordSaved",{count:e})),O({}),$(r("pages.input.recordSuccess")),J("");const a=new Date;W(V(a)),Q(Y(a))}catch(a){const e=i("database",r("pages.input.recordError"));L(e),T(e)}},className:"space-y-8 mb-12",children:[e.jsx(R,{recordDate:z,recordTime:G,onDateChange:W,onTimeChange:Q,onSetCurrentDateTime:()=>{const e=new Date;W(V(e)),Q(Y(e)),m(o("currentTimeSet"))}}),e.jsx(_,{value:X,onChange:J}),[...F].filter(e=>!1!==e.defaultDisplay||A.temporaryDisplayFields.has(e.fieldId)).sort((e,t)=>(e.order||999)-(t.order||999)).map(t=>e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:A.editFieldId===t.fieldId?e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch mb-4",children:[e.jsx("div",{className:"text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:e.jsx("input",{type:"text",value:A.editField.name??"",onChange:e=>A.setEditField(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:r("pages.input.fieldManagement.fieldName")})}),e.jsx("div",{className:"pl-0 sm:pl-2 pt-2 sm:pt-0",children:"boolean"===t.type?e.jsx("div",{className:"h-full"}):e.jsx("input",{type:"text",value:A.editField.unit??"",onChange:e=>A.setEditField(t=>({...t,unit:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:r("pages.input.fieldManagement.unitPlaceholder")})})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:A.handleEditFieldSave,className:"bg-green-600 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-green-700 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(g,{className:"w-4 h-4"}),r("actions.save")]}),e.jsxs("button",{type:"button",onClick:()=>{A.setEditFieldId(null),A.setEditField({}),A.clearButtons()},className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(u,{className:"w-4 h-4"}),r("actions.cancel")]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch cursor-pointer",onClick:()=>A.toggleButtons(t.fieldId),children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 dark:border-gray-600 pb-2 sm:pb-0",children:t.name}),e.jsx("div",{className:"text-lg text-gray-800 dark:text-gray-200 font-semibold pl-0 sm:pl-2 text-left pt-2 sm:pt-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:["boolean"===t.type?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),te(t.fieldId,!0)},className:"px-3 py-1.5 rounded-lg border-2 text-sm font-medium transition-colors duration-200 flex-shrink-0 "+(!0===P[t.fieldId]?"bg-green-100 dark:bg-green-900/30 border-green-500 dark:border-green-400 text-green-700 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),"aria-label":n("setToYes",{fieldName:s(t.fieldId)}),children:r("fields.yes")}),e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),te(t.fieldId,!1)},className:"px-3 py-1.5 rounded-lg border-2 text-sm font-medium transition-colors duration-200 flex-shrink-0 "+(!1===P[t.fieldId]?"bg-red-100 dark:bg-red-900/30 border-red-500 dark:border-red-400 text-red-700 dark:text-red-300":"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),"aria-label":n("setToNo",{fieldName:s(t.fieldId)}),children:r("fields.no")}),void 0!==P[t.fieldId]&&e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),O(e=>{const r={...e};return delete r[t.fieldId],r})},className:"px-2 py-1.5 rounded-lg border-2 border-gray-300 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex-shrink-0","aria-label":n("clearSelection",{fieldName:s(t.fieldId)}),title:r("fields.clearSelection"),children:"×"})]}):e.jsx("input",{type:"number"===t.type?"number":"text",value:String(P[t.fieldId]||""),onChange:e=>te(t.fieldId,"number"===t.type?Number(e.target.value)||"":e.target.value),onClick:e=>e.stopPropagation(),className:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400","aria-label":n("inputField",{fieldName:s(t.fieldId)})}),e.jsx("div",{className:"w-full sm:w-32",children:t.unit&&e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:t.unit})})]})})]}),A.areButtonsShown(t.fieldId)&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",className:"bg-sky-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",onClick:()=>ae(t.fieldId),"aria-label":n("setPreviousValue",{fieldName:s(t.fieldId)}),children:[e.jsx(b,{className:"w-3 h-3 sm:w-4 sm:h-4","aria-hidden":"true"}),r("actions.lastValue")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleEditField(t),className:"bg-blue-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm","aria-label":n("editField",{fieldName:s(t.fieldId)}),children:[e.jsx(h,{className:"w-3 h-3 sm:w-4 sm:h-4","aria-hidden":"true"}),r("actions.edit")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleHideField(t),className:"bg-red-600 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm","aria-label":n("hideField",{fieldName:s(t.fieldId)}),children:[e.jsx(y,{className:"w-3 h-3 sm:w-4 sm:h-4","aria-hidden":"true"}),r("actions.hide")]})]})]})},t.fieldId)),B&&e.jsxs("div",{id:"form-error",className:"text-red-600 dark:text-red-400 font-semibold bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",role:"alert","aria-live":"polite",children:[e.jsx("span",{className:"sr-only",children:r("aria.formError")}),B]}),e.jsxs("button",{type:"submit",className:"bg-green-600 text-white px-4 sm:px-8 py-3 sm:py-4 rounded-lg font-bold text-lg sm:text-xl shadow-md hover:bg-green-700 hover:shadow-lg transition-all duration-200 flex items-center justify-center gap-2 sm:gap-3 focus:outline-none focus:ring-2 focus:ring-green-600 focus:ring-offset-2 w-full","aria-describedby":B?"form-error":void 0,children:[e.jsx(d,{className:"w-5 h-5 sm:w-6 sm:h-6","aria-hidden":"true"}),r("pages.input.record")]})]}),e.jsx("div",{className:"mb-8",children:A.showSelectField?e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:[e.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),r("pages.input.fieldManagement.selectFieldsTitle")]}),e.jsxs("div",{className:"space-y-4",children:[A.getHiddenFields().length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 text-left",children:r("pages.input.fieldManagement.existingFields")}),e.jsx("div",{className:"space-y-3",children:A.getHiddenFields().map(t=>e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:A.editingExistingFieldId===t.fieldId?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch",children:[e.jsx("div",{className:"text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:e.jsx("input",{type:"text",value:A.editingExistingField.name??"",onChange:e=>A.setEditingExistingField(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",placeholder:r("pages.input.fieldManagement.fieldName")})}),e.jsx("div",{className:"pl-0 sm:pl-2 pt-2 sm:pt-0",children:e.jsx("input",{type:"text",value:A.editingExistingField.unit??"",onChange:e=>A.setEditingExistingField(t=>({...t,unit:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",placeholder:r("pages.input.fieldManagement.unitPlaceholder")})})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center pt-2 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:A.handleEditExistingFieldSave,className:"bg-green-600 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-green-700 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(g,{className:"w-4 h-4"}),r("actions.save")]}),e.jsxs("button",{type:"button",onClick:()=>{A.setEditingExistingFieldId(null),A.clearSelectButtons()},className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center gap-2 flex-1 sm:min-w-[120px] justify-center",children:[e.jsx(u,{className:"w-4 h-4"}),r("actions.cancel")]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch cursor-pointer",onClick:()=>A.toggleSelectButtons(t.fieldId),children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 dark:border-gray-600 pb-2 sm:pb-0",children:t.name}),e.jsx("div",{className:"text-lg text-gray-800 dark:text-gray-200 font-semibold pl-0 sm:pl-2 text-left pt-2 sm:pt-0",children:t.unit?`(${t.unit})`:""})]}),A.areSelectButtonsShown(t.fieldId)&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>A.handleShowExistingFieldPermanently(t.fieldId),className:"bg-green-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-green-600 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(g,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r("actions.display")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleShowExistingField(t.fieldId),className:"bg-teal-400 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-teal-500 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(w,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r("actions.add")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleEditExistingField(t),className:"bg-blue-500 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(h,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r("actions.edit")]}),e.jsxs("button",{type:"button",onClick:()=>A.handleDeleteExistingField(t),className:"bg-red-600 text-white px-2 sm:px-4 py-2 rounded-lg shadow-md hover:bg-red-700 transition-colors duration-200 font-medium flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(v,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r("actions.delete")]})]})]})},t.fieldId))})]}),A.showAddField&&e.jsxs("form",{onSubmit:A.handleAddField,className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 mb-4 text-left flex items-center gap-2",children:[e.jsx(w,{className:"w-6 h-6 text-green-600 dark:text-green-400","aria-hidden":"true"}),r("pages.input.fieldManagement.addNewField")]}),e.jsxs("fieldset",{className:"space-y-4",children:[e.jsx("legend",{className:"sr-only",children:r("aria.newFieldDetails")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:"new-field-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:[r("pages.input.fieldManagement.fieldNameRequired")," ",e.jsx("span",{className:"text-red-600","aria-label":r("fields.required"),children:"*"})]}),e.jsx("input",{id:"new-field-name",type:"text",value:A.newField.name,onChange:e=>A.setNewField(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",placeholder:r("pages.input.fieldManagement.fieldNamePlaceholder"),required:!0,"aria-required":"true","aria-describedby":"new-field-name-desc","aria-invalid":A.addFieldError&&A.addFieldError.includes(r("validation.fieldNameRequired"))?"true":"false"}),e.jsx("div",{id:"new-field-name-desc",className:"sr-only",children:r("aria.fieldNameDescription")})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsxs("label",{htmlFor:"new-field-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:[r("pages.input.fieldManagement.dataTypeRequired")," ",e.jsx("span",{className:"text-red-600","aria-label":r("fields.required"),children:"*"})]}),e.jsxs("select",{id:"new-field-type",value:A.newField.type,onChange:e=>A.setNewField(t=>({...t,type:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",required:!0,"aria-required":"true","aria-describedby":"new-field-type-desc",children:[e.jsx("option",{value:"number",children:r("fields.types.number")}),e.jsx("option",{value:"string",children:r("fields.types.string")}),e.jsx("option",{value:"boolean",children:r("fields.types.boolean")})]}),e.jsx("div",{id:"new-field-type-desc",className:"sr-only",children:r("aria.dataTypeDescription")})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsx("label",{htmlFor:"new-field-unit",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:r("pages.input.fieldManagement.unitOptional")}),e.jsx("input",{id:"new-field-unit",type:"text",value:A.newField.unit,onChange:e=>A.setNewField(t=>({...t,unit:e.target.value})),placeholder:r("fields.inputPlaceholder",{example:"kg"}),className:"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 dark:focus:ring-blue-400 focus:border-blue-600 dark:focus:border-blue-400","aria-describedby":"unit-description","aria-label":r("aria.unitFieldDescription")}),e.jsx("div",{id:"unit-description",className:"sr-only",children:r("aria.unitFieldDescription")})]})]}),A.addFieldError&&e.jsxs("div",{id:"add-field-error",className:"text-red-600 dark:text-red-400 font-semibold bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800",role:"alert","aria-live":"polite",children:[e.jsx("span",{className:"sr-only",children:r("aria.formError")}),A.addFieldError]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 pt-2",children:[e.jsxs("button",{type:"submit",className:"bg-teal-500 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-teal-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 text-sm sm:text-base flex-1 sm:min-w-[120px]","aria-describedby":A.addFieldError?"add-field-error":void 0,children:[e.jsx(w,{className:"w-4 h-4","aria-hidden":"true"}),r("actions.add")]}),e.jsxs("button",{type:"button",onClick:()=>A.setShowAddField(!1),className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 text-sm sm:text-base flex-1 sm:min-w-[120px]",children:[e.jsx(u,{className:"w-4 h-4","aria-hidden":"true"}),r("actions.cancel")]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[!A.showAddField&&e.jsxs("button",{type:"button",onClick:()=>A.setShowAddField(!0),className:"bg-teal-500 text-white px-3 sm:px-4 py-2 rounded-lg shadow-md hover:bg-teal-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base whitespace-nowrap",children:[e.jsx(w,{className:"w-4 h-4"}),r("pages.input.fieldManagement.addNewField")]}),e.jsxs("button",{type:"button",onClick:()=>A.setShowSelectField(!1),className:"bg-gray-500 text-white px-3 sm:px-4 py-2 rounded-lg shadow-md hover:bg-gray-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",children:[e.jsx(k,{className:"w-4 h-4 sm:w-5 sm:h-5"}),r("actions.back")]})]})]})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>A.setShowSelectField(!0),className:"bg-blue-500 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base","aria-label":n("showField",{fieldName:r("pages.input.selectFields")}),children:[e.jsx(b,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),r("pages.input.selectFields")]}),e.jsxs("button",{type:"button",onClick:A.handleOpenSortModal,disabled:M.loading||0===F.length,className:"px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base "+(M.loading||0===F.length?"bg-gray-400 text-white cursor-not-allowed":"bg-purple-500 text-white hover:bg-purple-600"),"aria-label":n("sort",{fieldName:r("pages.input.sortFields")}),children:[e.jsx(c,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),M.loading?r("common.loading"):r("pages.input.sortFields")]})]})}),e.jsx(H,{isOpen:A.showSortModal,onClose:()=>A.setShowSortModal(!1),fields:A.sortableFields,onDragEnd:A.handleDragEnd,onSave:A.handleSaveSortOrder,onToggleDisplay:A.handleToggleDisplayInModal})]})})}export{z as default};
