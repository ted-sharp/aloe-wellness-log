import{j as e}from"./ui-vendor-D7AUAfXm.js";import{a,b as t}from"./react-vendor-BzNAZZ5j.js";import{u as r,H as s,a as i,b as d,c as n,d as l,e as o,f as c,g as u,h as g,i as m,j as f,k as x,l as p,p as b,B as h,m as y,n as v,o as w,q as k,r as j,s as N,t as S,v as F,w as C,x as E}from"./index-DY8_zVYl.js";import{u as I,a as D,D as M,c as $,S as T,v as A,s as P,K as R,P as O,b as q,C as z,d as _}from"./dnd-vendor-BBd399mu.js";import"./icons-vendor-DoCnAwwa.js";import"./state-vendor-O6FgWrPy.js";const B=a.memo(({recordDate:a,recordTime:t,onDateChange:d,onTimeChange:n,onSetCurrentDateTime:l})=>{const{t:o}=r();return e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:e.jsxs("fieldset",{className:"space-y-4",children:[e.jsxs("legend",{className:"text-2xl font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(s,{className:"w-6 h-6 text-blue-600 dark:text-blue-400","aria-hidden":"true"}),o("pages.input.recordDateTime")]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"record-date",className:"block text-base font-medium text-gray-700 dark:text-gray-200 mb-2",children:o("pages.input.date")}),e.jsx("input",{id:"record-date",type:"date",value:a,onChange:e=>d(e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400","aria-describedby":"record-date-desc",required:!0,"aria-required":"true"}),e.jsx("div",{id:"record-date-desc",className:"sr-only",children:o("pages.input.dateDescription")})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"record-time",className:"block text-base font-medium text-gray-700 dark:text-gray-200 mb-2",children:o("pages.input.time")}),e.jsx("input",{id:"record-time",type:"time",value:t,onChange:e=>n(e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400","aria-describedby":"record-time-desc",required:!0,"aria-required":"true"}),e.jsx("div",{id:"record-time-desc",className:"sr-only",children:o("pages.input.timeDescription")})]}),e.jsxs("div",{className:"flex items-end",children:[e.jsxs("button",{type:"button",onClick:l,className:"bg-blue-500 dark:bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors duration-200 font-medium flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800","aria-label":o("pages.input.setCurrentDateTime"),"aria-describedby":"current-time-desc",children:[e.jsx(i,{className:"w-5 h-5","aria-hidden":"true"}),o("pages.input.setCurrentDateTime")]}),e.jsx("div",{id:"current-time-desc",className:"sr-only",children:o("pages.input.currentTimeDescription")})]})]})]})})});B.displayName="DateTimeSelector";const H=a.memo(({value:t,onChange:s,maxLength:i=500,placeholder:n})=>{const{t:l}=r(),o=a.useCallback(e=>{s(e.target.value)},[s]),c=t.length,u=i-c,g=c>.8*i,m=n||l("pages.input.notesPlaceholder");return e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{htmlFor:"notes-input",className:"text-2xl font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[e.jsx(d,{className:"w-6 h-6 text-blue-600 dark:text-blue-400","aria-hidden":"true"}),l("pages.input.notes")]}),e.jsxs("div",{children:[e.jsx("textarea",{id:"notes-input",value:t,onChange:o,placeholder:m,className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-4 py-2 h-24 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400 resize-none placeholder:text-gray-500 dark:placeholder:text-gray-400",maxLength:i,"aria-describedby":"notes-char-count notes-description","aria-label":l("pages.input.notesPlaceholder")}),e.jsx("div",{id:"notes-description",className:"sr-only",children:l("pages.input.notesDescription",{maxLength:i})}),e.jsxs("div",{id:"notes-char-count",className:"text-right text-sm mt-2 "+(g?"text-orange-600 dark:text-orange-400 font-medium":"text-gray-600 dark:text-gray-400"),"aria-live":"polite","aria-label":l("aria.charactersEntered",{count:c,remaining:u}),children:[l("pages.input.characterCount",{count:c,max:i}),g&&e.jsxs("span",{className:"ml-2 text-orange-600 dark:text-orange-400",children:["(残り",u,"文字)"]})]})]})]})})});function L({field:t,onToggleDisplay:s}){const{t:i}=r(),{attributes:d,listeners:n,setNodeRef:c,transform:u,transition:g,isDragging:f}=q({id:t.fieldId}),{announcePolite:x}=l(),p={transform:z.Transform.toString(u),transition:g,opacity:f?.5:1},b=a.useCallback(e=>{e.stopPropagation(),e.preventDefault();const a=!t.defaultDisplay;s(t.fieldId),x(`${t.name}${i("dialogs.sortModal.toggledAnnouncement",{state:i(a?"dialogs.sortModal.visible":"dialogs.sortModal.hidden")})}`)},[t.fieldId,t.defaultDisplay,t.name,s,x,i]),h=a.useCallback(()=>{const e=!t.defaultDisplay;s(t.fieldId),x(`${t.name}${i("dialogs.sortModal.toggledAnnouncement",{state:i(e?"dialogs.sortModal.visible":"dialogs.sortModal.hidden")})}`)},[t.fieldId,t.defaultDisplay,t.name,s,x,i]),y={onEnter:h,onSpace:h},{handleKeyDown:v}=o(y),w=t.defaultDisplay?i("dialogs.sortModal.visibleDescription"):i("dialogs.sortModal.hiddenDescription");return e.jsx("div",{ref:c,style:p,className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-2 sm:p-3 hover:shadow-md transition-all duration-200 hover:border-purple-300 dark:hover:border-purple-400",...d,role:"listitem","aria-label":`${t.name}${i("common.item")} - ${w} ${i("accessibility.sortable")}`,children:e.jsxs("div",{className:"flex flex-col sm:grid sm:gap-3 sm:items-center gap-2",style:{gridTemplateColumns:"auto 1fr 1fr auto"},children:[e.jsxs("div",{className:"flex justify-between items-center sm:hidden",children:[e.jsx("div",{className:"text-lg font-medium text-gray-700 dark:text-gray-200",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400","aria-label":`${i("dialogs.sortModal.unit")}: ${t.unit||i("dialogs.sortModal.noUnit")}`,children:t.unit?`(${t.unit})`:"―"})]}),e.jsxs("div",{className:"flex justify-between items-center sm:hidden",children:[e.jsx("div",{children:t.defaultDisplay?e.jsx("button",{onClick:b,onKeyDown:v,className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-green-200 dark:hover:bg-green-900/50 focus:outline-none focus:ring-2 focus:ring-green-500 dark:focus:ring-green-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${t.name}${i("dialogs.sortModal.makeHidden")}`,"aria-pressed":"true",children:i("dialogs.sortModal.visible")}):e.jsx("button",{onClick:b,onKeyDown:v,className:"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${t.name}${i("dialogs.sortModal.makeVisible")}`,"aria-pressed":"false",children:i("dialogs.sortModal.hidden")})}),e.jsx("div",{className:"flex justify-center cursor-move focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-1 rounded p-1",tabIndex:0,role:"button","aria-label":`${t.name}${i("dialogs.sortModal.dragToSort")}`,...n,children:e.jsx(m,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-150","aria-hidden":"true"})})]}),e.jsxs("div",{className:"hidden sm:contents",children:[e.jsx("div",{className:"text-center border-r border-gray-200 dark:border-gray-600 pr-3",children:t.defaultDisplay?e.jsx("button",{onClick:b,onKeyDown:v,className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-green-200 dark:hover:bg-green-900/50 focus:outline-none focus:ring-2 focus:ring-green-500 dark:focus:ring-green-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${t.name}${i("dialogs.sortModal.makeHidden")}`,"aria-pressed":"true",children:i("dialogs.sortModal.visible")}):e.jsx("button",{onClick:b,onKeyDown:v,className:"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full text-xs font-medium cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-1 transition-colors duration-150","aria-label":`${t.name}${i("dialogs.sortModal.makeVisible")}`,"aria-pressed":"false",children:i("dialogs.sortModal.hidden")})}),e.jsx("div",{className:"text-lg font-medium text-gray-700 dark:text-gray-200 border-r border-gray-200 dark:border-gray-600 pr-3 text-right",children:t.name}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400 border-r border-gray-200 dark:border-gray-600 pr-3 text-left","aria-label":`${i("dialogs.sortModal.unit")}: ${t.unit||i("dialogs.sortModal.noUnit")}`,children:t.unit?`(${t.unit})`:"―"}),e.jsx("div",{className:"flex justify-center cursor-move focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-1 rounded p-1",tabIndex:0,role:"button","aria-label":`${t.name}${i("dialogs.sortModal.dragToSort")}`,...n,children:e.jsx(m,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-150","aria-hidden":"true"})})]})]})})}H.displayName="NotesInput";const K=({isOpen:s,onClose:i,fields:d,onDragEnd:m,onSave:f,onToggleDisplay:x})=>{const{t:p}=r(),{modalProps:b}=n(s),{announcePolite:h}=l(),y={onEscape:i},{handleKeyDown:v}=o(y),w=I(D(O),D(R,{coordinateGetter:P})),k=a.useCallback(e=>{const{active:a,over:t}=e;if(a.id!==(null==t?void 0:t.id)){m(e);const r=d.find(e=>e.fieldId===a.id),s=d.find(e=>e.fieldId===(null==t?void 0:t.id));r&&s&&h(`${r.name}${p("dialogs.sortModal.dragEndAnnouncement",{target:s.name})}`)}},[m,d,h,p]),j=a.useCallback(()=>{f(),h(p("dialogs.sortModal.savedAnnouncement"))},[f,h,p]);return a.useEffect(()=>{s&&h(p("dialogs.sortModal.openedAnnouncement"))},[s,h,p]),a.useEffect(()=>(s&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[s]),s?t.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",...b,children:[e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.3)"},onClick:i}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsxs("div",{className:"relative w-full max-w-sm sm:max-w-xl transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-4 sm:p-6 text-left align-middle shadow-xl transition-all",onKeyDown:v,onClick:e=>e.stopPropagation(),children:[e.jsxs("h3",{className:"text-xl sm:text-2xl font-bold leading-6 text-gray-900 dark:text-white mb-4 sm:mb-6 flex items-center gap-2",id:"sort-modal-title",children:[e.jsx(c,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600 dark:text-purple-400","aria-hidden":"true"}),p("dialogs.sortModal.title")]}),e.jsx("div",{className:"mb-4",id:"sort-modal-description",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-xs sm:text-sm",children:p("dialogs.sortModal.description")})}),e.jsx(M,{sensors:w,collisionDetection:$,onDragEnd:k,accessibility:{announcements:{onDragStart:({active:e})=>{const a=d.find(a=>a.fieldId===e.id);return`${(null==a?void 0:a.name)||"アイテム"}${p("dialogs.sortModal.dragStartAnnouncement")}`},onDragOver:({active:e,over:a})=>{const t=d.find(a=>a.fieldId===e.id),r=d.find(e=>e.fieldId===(null==a?void 0:a.id));return t&&r?`${t.name}${p("dialogs.sortModal.dragOverAnnouncement",{target:r.name})}`:""},onDragEnd:({active:e,over:a})=>{const t=d.find(a=>a.fieldId===e.id),r=d.find(e=>e.fieldId===(null==a?void 0:a.id));return e.id===(null==a?void 0:a.id)?`${(null==t?void 0:t.name)||"アイテム"}${p("dialogs.sortModal.dragReturnAnnouncement")}`:t&&r?`${t.name}${p("dialogs.sortModal.dragEndAnnouncement",{target:r.name})}`:`${(null==t?void 0:t.name)||"アイテム"}${p("dialogs.sortModal.dragCompleteAnnouncement")}`},onDragCancel:({active:e})=>{const a=d.find(a=>a.fieldId===e.id);return`${(null==a?void 0:a.name)||"アイテム"}${p("dialogs.sortModal.dragCancelAnnouncement")}`}}},children:e.jsx(T,{items:d.map(e=>e.fieldId),strategy:A,children:e.jsx("div",{className:"space-y-2 max-h-[50vh] sm:max-h-[60vh] overflow-y-auto pr-1 sm:pr-2",role:"list","aria-label":p("dialogs.sortModal.listLabel"),"aria-describedby":"sort-modal-description",children:d.map(a=>e.jsx(L,{field:a,onToggleDisplay:x},a.fieldId))})})}),e.jsxs("div",{className:"mt-4 sm:mt-6 flex flex-col sm:flex-row gap-3 sm:justify-end",role:"group","aria-label":p("dialogs.sortModal.buttonsLabel"),children:[e.jsxs("button",{type:"button",className:"bg-gray-400 dark:bg-gray-600 text-white px-4 sm:px-6 py-2 rounded-lg shadow-md hover:bg-gray-500 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:focus:ring-gray-400 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",onClick:i,"aria-label":p("dialogs.sortModal.cancelLabel"),children:[e.jsx(u,{className:"w-4 h-4","aria-hidden":"true"}),p("common.cancel")]}),e.jsxs("button",{type:"button",className:"bg-purple-600 dark:bg-purple-700 text-white px-4 sm:px-6 py-2 rounded-lg shadow-md hover:bg-purple-700 dark:hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",onClick:j,"aria-label":p("dialogs.sortModal.saveLabel"),children:[e.jsx(g,{className:"w-4 h-4","aria-hidden":"true"}),p("common.save")]})]})]})})]}),document.body):null};var V=(e=>(e.CONNECTION_FAILED="connection_failed",e.TRANSACTION_FAILED="transaction_failed",e.DATA_CORRUPTED="data_corrupted",e.QUOTA_EXCEEDED="quota_exceeded",e.VERSION_ERROR="version_error",e.UNKNOWN="unknown",e))(V||{});function Y(){const{showError:e,showWarning:t}=f(),r=a.useCallback((a,r={})=>{const{showToast:s=!0,logToConsole:i=!0,context:d,fallbackMessage:n}=r,l=function(e){if(e&&"object"==typeof e&&"type"in e&&"retryable"in e&&"message"in e){const a=e;if(Object.values(V).includes(a.type)){const a=e;return{type:"database",message:a.message,originalError:a.originalError,context:{dbErrorType:a.type,retryable:a.retryable}}}}if(e instanceof Error){const a=e.message.toLowerCase();return a.includes("indexeddb")||a.includes("database")||a.includes("store")?{type:"database",message:"データベース操作でエラーが発生しました",originalError:e}:a.includes("parse")||a.includes("json")||a.includes("csv")?{type:"parse",message:"データの解析でエラーが発生しました",originalError:e}:a.includes("validation")||a.includes("必須")||a.includes("形式")?{type:"validation",message:e.message,originalError:e}:a.includes("network")||a.includes("fetch")||a.includes("request")?{type:"network",message:"ネットワークエラーが発生しました",originalError:e}:{type:"unknown",message:e.message,originalError:e}}return{type:"unknown",message:"予期しないエラーが発生しました",context:{originalError:e}}}(a);i&&function(e){var a;e.message,e.originalError,"database"===e.type&&(null==(a=e.context)||a.dbErrorType)}(l);const o=n||function(e){var a;switch(e.type){case"validation":return e.message;case"database":if(null==(a=e.context)?void 0:a.dbErrorType){const a=e.context.dbErrorType,t=e.context.retryable;switch(a){case"quota_exceeded":return"ストレージ容量が不足しています。不要なデータを削除してから再度お試しくださいませ。";case"connection_failed":return t?"データベース接続に失敗しました。しばらく待ってから再度お試しくださいませ。":"データベース接続に問題があります。ページを再読み込みしてお試しくださいませ。";case"transaction_failed":return"データベース処理中にエラーが発生しました。もう一度お試しくださいませ。";case"data_corrupted":return"データが破損している可能性があります。管理画面からデータの確認をお勧めいたします。";case"version_error":return"データベースの更新中です。ページを再読み込みしてお試しくださいませ。";default:return e.message||"データベース操作でエラーが発生いたしました。"}}return"データの保存・読み込みに失敗いたしました。もう一度お試しくださいませ。";case"parse":return"ファイルの形式が正しくありません。ファイルの内容をご確認くださいませ。";case"network":return"ネットワーク接続に問題があります。接続状況をご確認くださいませ。";case"permission":return"この操作を実行する権限がありません。";default:return e.message||"予期しないエラーが発生いたしました。"}}(l);return s&&("validation"===l.type?t(o):e(o)),l},[e,t]),s=a.useCallback(async(e,a={})=>{try{return await e()}catch(t){return r(t,a),null}},[r]),i=a.useCallback((e,a={})=>e.map(({error:e,context:t})=>r(e,{...a,context:t})),[r]);return{handleError:r,handleAsyncError:s,handleBatchErrors:i}}const U=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,W=e=>`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`,G=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`;function Q(){const{t:t,translateFieldName:s,translateError:i,getAriaLabel:n,getAnnouncement:o}=r(),{announcePolite:m}=l();p(),Y();const{fields:I,loadFields:D,addRecord:M,loadRecords:$,records:T,fieldsOperation:A}=x(),{showSuccess:P,showError:R}=f(),O=function(){const{t:e,getAnnouncement:t}=r(),{fields:s,loadFields:i,addField:d,updateField:n,deleteField:l}=x(),{showSuccess:o,showError:c}=f(),{handleAsyncError:u}=Y(),[g,m]=a.useState(!1),[p,b]=a.useState(!1),[h,y]=a.useState({name:"",type:"number",unit:""}),[v,w]=a.useState(null),[k,j]=a.useState({}),[N,S]=a.useState(null),[F,C]=a.useState(null),[E,I]=a.useState({}),[D,M]=a.useState(new Set),[$,T]=a.useState(new Set),[A,P]=a.useState(new Set),[R,O]=a.useState(!1),[q,z]=a.useState([]),B=a.useRef([]),H=a.useCallback(()=>0===s.length?1:Math.max(...s.map(e=>e.order||0))+1,[s]),L=a.useCallback(()=>s.filter(e=>!1===e.defaultDisplay).sort((e,a)=>(e.order||999)-(a.order||999)),[s]),K=a.useCallback(async a=>{if(a.preventDefault(),S(null),!h.name.trim())return void S(e("validation.fieldNameInput"));if(s.some(e=>e.name===h.name.trim()))return void S(e("validation.duplicateFieldName"));const r=h.name.trim().replace(/\s+/g,"_").toLowerCase();await u(async()=>{var e;return await d({fieldId:r,name:h.name.trim(),type:h.type,unit:(null==(e=h.unit)?void 0:e.trim())||void 0,order:H(),defaultDisplay:!1}),M(e=>new Set([...e,r])),y({name:"",type:"number",unit:""}),b(!1),m(!1),await i(),!0},{context:e("actions.add"),fallbackMessage:e("errors.general")})&&o(t("fieldAddedSuccess"))},[h,s,d,H,u,i,o]),V=a.useCallback(e=>{w(e.fieldId),j({name:e.name,unit:e.unit})},[]),U=a.useCallback(async()=>{var a;if(!v||!(null==(a=k.name)?void 0:a.trim()))return w(null),j({}),void T(new Set);const r=s.find(e=>e.fieldId===v);r&&(await u(async()=>{var e;return await n({...r,name:k.name.trim(),unit:(null==(e=k.unit)?void 0:e.trim())||void 0}),await i(),!0},{context:e("actions.edit"),fallbackMessage:e("errors.general")})&&o(t("fieldEditedSuccess")),w(null),j({}),T(new Set))},[v,k,s,n,u,i,o]),W=a.useCallback(e=>{s.find(a=>a.fieldId===e)&&(M(a=>new Set([...a,e])),m(!1),P(new Set),o(t("fieldTempDisplayAdded")))},[s,o]),G=a.useCallback(async e=>{const a=s.find(a=>a.fieldId===e);if(!a)return;const r={...a,defaultDisplay:!0},d=s.map(a=>a.fieldId===e?r:a);x.setState({fields:d});try{await n(r),M(a=>{const t=new Set(a);return t.delete(e),t}),P(new Set),m(!1),await i(),o(t("fieldDisplayChanged"))}catch(l){x.setState({fields:s});const e=l instanceof Error?l.message:"表示状態の変更に失敗しました";c(e)}},[s,n,u,i,o]),Q=a.useCallback(e=>{C(e.fieldId),I({name:e.name,unit:e.unit}),P(new Set)},[]),X=a.useCallback(async()=>{var a;if(!F||!(null==(a=E.name)?void 0:a.trim()))return C(null),I({}),void P(new Set);const r=s.find(e=>e.fieldId===F);r&&(await u(async()=>{var e;return await n({...r,name:E.name.trim(),unit:(null==(e=E.unit)?void 0:e.trim())||void 0,order:r.order,defaultDisplay:r.defaultDisplay}),await i(),!0},{context:e("actions.edit"),fallbackMessage:e("errors.general")})&&o(t("fieldEditedSuccess")),C(null),I({}),P(new Set))},[F,E,s,n,u,i,o]),J=a.useCallback(async a=>{window.confirm(e("common.confirmDeleteField",{fieldName:a.name}))&&await u(async()=>(await l(a.fieldId),await i(),P(new Set),!0),{context:e("actions.delete"),fallbackMessage:e("errors.general")})&&o(t("fieldDeletedSuccess"))},[l,u,i,o]),Z=a.useCallback(e=>{T(a=>{const t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})},[]),ee=a.useCallback(e=>$.has(e),[$]),ae=a.useCallback(()=>{T(new Set)},[]),te=a.useCallback(e=>{P(a=>{const t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})},[]),re=a.useCallback(e=>A.has(e),[A]),se=a.useCallback(()=>{P(new Set)},[]),ie=a.useCallback(async()=>{let a=s;if(0===a.length)try{await i();const{fields:t}=x.getState();if(a=t,0===a.length)return void c(e("errors.fieldDataNotFound"))}catch(r){return void c(e("errors.fieldDataLoadFailed"))}const t=[...a].sort((e,a)=>(e.order||999)-(a.order||999));z(t),B.current=t,O(!0)},[s,i,c]),de=a.useCallback(e=>{const{active:a,over:t}=e;if(t&&a.id!==t.id){const e=q.findIndex(e=>e.fieldId===a.id),r=q.findIndex(e=>e.fieldId===t.id),s=_(q,e,r);z(s),B.current=s}},[q]),ne=a.useCallback(async()=>{await u(async()=>{const e=B.current.map((e,a)=>{const t={...e,order:a+1};return n(t)});return await Promise.all(e),await new Promise(e=>setTimeout(e,50)),await i(),O(!1),!0},{context:e("actions.sort"),fallbackMessage:e("errors.general")})&&o(t("sortOrderSaved"))},[n,u,i,o]),le=a.useCallback(async e=>{await u(async()=>(await n({...e,defaultDisplay:!1}),M(a=>{const t=new Set(a);return t.delete(e.fieldId),t}),T(new Set),await i(),!0),{context:"項目非表示",fallbackMessage:"項目の非表示に失敗しました"})&&o(t("fieldHidden"))},[n,u,i,o]),oe=a.useCallback(async e=>{const a=q.find(a=>a.fieldId===e);if(!a)return;const t={...a,defaultDisplay:!a.defaultDisplay};await u(async()=>{await n(t);const a=q.map(a=>a.fieldId===e?t:a);z(a),B.current=a;const r=s.map(a=>a.fieldId===e?t:a);return x.setState({fields:r}),t.defaultDisplay?M(a=>{const t=new Set(a);return t.delete(e),t}):s.some(a=>a.fieldId===e&&(a.defaultDisplay||D.has(e)))&&M(a=>new Set([...a,e])),!0},{context:"モーダル内表示状態変更",fallbackMessage:"表示状態の変更に失敗しました"})},[q,s,D,n,u]);return{showSelectField:g,setShowSelectField:m,showAddField:p,setShowAddField:b,newField:h,setNewField:y,editFieldId:v,setEditFieldId:w,editField:k,setEditField:j,addFieldError:N,editingExistingFieldId:F,setEditingExistingFieldId:C,editingExistingField:E,setEditingExistingField:I,temporaryDisplayFields:D,showSortModal:R,setShowSortModal:O,sortableFields:q,getHiddenFields:L,handleAddField:K,handleEditField:V,handleEditFieldSave:U,handleShowExistingField:W,handleShowExistingFieldPermanently:G,handleEditExistingField:Q,handleEditExistingFieldSave:X,handleDeleteExistingField:J,toggleButtons:Z,areButtonsShown:ee,toggleSelectButtons:te,areSelectButtonsShown:re,handleOpenSortModal:ie,handleDragEnd:de,handleSaveSortOrder:ne,handleHideField:le,handleToggleDisplayInModal:oe,clearButtons:ae,clearSelectButtons:se}}(),[q,z]=a.useState({}),[L,V]=a.useState(null),[Q,X]=a.useState(()=>U(new Date)),[J,Z]=a.useState(()=>W(new Date)),[ee,ae]=a.useState(""),[te,re]=a.useState(!1);a.useEffect(()=>(b.trackRender.start("RecordInput"),()=>{b.trackRender.end("RecordInput")})),a.useEffect(()=>{(async()=>{try{await S("load-fields-input",async()=>{await D()}),await S("load-records-input",async()=>{await $()})}catch(e){}})()},[D,$]),a.useEffect(()=>{},[I.length,T.length,q,Q,J]);const se=(e,a)=>{const r=b.trackInteraction.start("field-change");z(t=>({...t,[e]:a})),V(null);const i=I.find(a=>a.fieldId===e);"boolean"===(null==i?void 0:i.type)&&"boolean"==typeof a&&m(o("fieldChanged",{fieldName:s(i.fieldId),value:t(a?"fields.yes":"fields.no")})),b.trackInteraction.end(r,"field-change")},ie=(e,a)=>null!=a&&("boolean"===e.type?!0===a||!1===a:"number"===e.type?"number"==typeof a&&!isNaN(a):"string"==typeof a&&a.trim().length>0),de=e=>{const a=b.trackInteraction.start("set-last-value"),t=(e=>{const a=[...T].filter(a=>a.fieldId===e).sort((e,a)=>new Date(a.datetime).getTime()-new Date(e.datetime).getTime())[0];return(null==a?void 0:a.value)??""})(e);if(""!==t){se(e,t);const a=I.find(a=>a.fieldId===e);a&&m(o("previousValueSet",{fieldName:s(a.fieldId)}))}b.trackInteraction.end(a,"set-last-value")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 to-blue-100 dark:from-gray-800 dark:to-gray-900 p-2 sm:p-4",children:e.jsxs("div",{className:"max-w-full sm:max-w-4xl mx-auto px-2 sm:px-0",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-gray-800 dark:text-white mb-2 whitespace-nowrap",children:t("pages.input.title")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base",children:t("pages.input.description")})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const a=b.trackInteraction.start("form-submit"),r=(()=>{if(!F(Q))return"日付の形式が正しくありません (YYYY-MM-DD)";if(!C(J))return"時刻の形式が正しくありません (HH:mm)";for(const e of I){const a=q[e.fieldId];if(ie(e,a)){const t=E(a,e.type,{required:!1,min:"number"===e.type?0:void 0,max:"number"===e.type?1e4:void 0});if(!t.isValid)return`${e.name}: ${t.errors.join(", ")}`}}return ee.length>500?"備考は500文字以内で入力してください":""!==ee.trim()||I.some(e=>ie(e,q[e.fieldId]))?null:t("validation.required")})();if(r)return V(r),m(t("errors.inputError",{message:r})),void b.trackInteraction.end(a,"form-submit-validation-error");try{let e=0;const r=[];for(const a of I){const t=q[a.fieldId];if(ie(a,t)){const s=new Date(`${Q}T${J}:00`);r.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:a.fieldId,value:t,date:Q,time:J,datetime:G(s)}),e++}}if(""!==ee.trim()){const a=new Date(`${Q}T${J}:00`);r.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,fieldId:"notes",value:ee.trim(),date:Q,time:J,datetime:G(a)}),e++}await S("add-records-batch",async()=>{for(const e of r)await M(e)},r.length),m(o("recordSaved",{count:e})),z({}),P(t("pages.input.recordSuccess")),ae("");const s=new Date;X(U(s)),Z(W(s)),b.trackInteraction.end(a,"form-submit-success")}catch(s){const e=i("database",t("pages.input.recordError"));V(e),R(e),b.trackInteraction.end(a,"form-submit-error")}},className:"space-y-8 mb-12",children:[e.jsx(B,{recordDate:Q,recordTime:J,onDateChange:X,onTimeChange:Z,onSetCurrentDateTime:()=>{const e=new Date;X(U(e)),Z(W(e)),m(o("currentTimeSet"))}}),e.jsx(H,{value:ee,onChange:ae}),[...I].filter(e=>!1!==e.defaultDisplay||O.temporaryDisplayFields.has(e.fieldId)).sort((e,a)=>(e.order||999)-(a.order||999)).map(a=>e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:O.editFieldId===a.fieldId?e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch mb-4",children:[e.jsx("div",{className:"text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:e.jsx("input",{type:"text",value:O.editField.name??"",onChange:e=>O.setEditField(a=>({...a,name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:t("pages.input.fieldManagement.fieldName")})}),e.jsx("div",{className:"pl-0 sm:pl-2 pt-2 sm:pt-0",children:"boolean"===a.type?e.jsx("div",{className:"h-full"}):e.jsx("input",{type:"text",value:O.editField.unit??"",onChange:e=>O.setEditField(a=>({...a,unit:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600",placeholder:t("pages.input.fieldManagement.unitPlaceholder")})})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center mt-4 pt-4 border-t border-gray-200",children:[e.jsx(h,{variant:"success",size:"md",icon:g,onClick:O.handleEditFieldSave,className:"flex-1 sm:min-w-[120px]",children:t("actions.save")}),e.jsx(h,{variant:"secondary",size:"md",icon:u,onClick:()=>{O.setEditFieldId(null),O.setEditField({}),O.clearButtons()},className:"flex-1 sm:min-w-[120px]",children:t("actions.cancel")})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch cursor-pointer",onClick:()=>O.toggleButtons(a.fieldId),children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 dark:border-gray-600 pb-2 sm:pb-0",children:a.name}),e.jsx("div",{className:"text-lg text-gray-800 dark:text-gray-200 font-semibold pl-0 sm:pl-2 text-left pt-2 sm:pt-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:["boolean"===a.type?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"success",size:"sm",onClick:e=>{e.stopPropagation(),se(a.fieldId,!0)},className:!0===q[a.fieldId]?"bg-green-100 dark:bg-green-900/30 border-green-500 dark:border-green-400 text-green-700 dark:text-green-300 border-2":"","aria-label":n("setToYes",{fieldName:s(a.fieldId)}),children:t("fields.yes")}),e.jsx(h,{variant:"danger",size:"sm",onClick:e=>{e.stopPropagation(),se(a.fieldId,!1)},className:!1===q[a.fieldId]?"bg-red-100 dark:bg-red-900/30 border-red-500 dark:border-red-400 text-red-700 dark:text-red-300 border-2":"","aria-label":n("setToNo",{fieldName:s(a.fieldId)}),children:t("fields.no")}),void 0!==q[a.fieldId]&&e.jsx(h,{variant:"secondary",size:"sm",onClick:e=>{e.stopPropagation(),z(e=>{const t={...e};return delete t[a.fieldId],t})},"aria-label":n("clearSelection",{fieldName:s(a.fieldId)}),title:t("fields.clearSelection"),children:"×"})]}):e.jsx("input",{type:"number"===a.type?"number":"text",value:String(q[a.fieldId]||""),onChange:e=>se(a.fieldId,"number"===a.type?Number(e.target.value)||"":e.target.value),onClick:e=>e.stopPropagation(),className:"border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400","aria-label":n("inputField",{fieldName:s(a.fieldId)})}),e.jsx("div",{className:"w-full sm:w-32",children:a.unit&&e.jsx("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:a.unit})})]})})]}),O.areButtonsShown(a.fieldId)&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-4 pt-4 border-t border-gray-200",children:[e.jsx(h,{variant:"sky",size:"sm",icon:y,onClick:()=>de(a.fieldId),"aria-label":n("setPreviousValue",{fieldName:s(a.fieldId)}),children:t("actions.lastValue")}),e.jsx(h,{variant:"primary",size:"sm",icon:v,onClick:()=>O.handleEditField(a),"aria-label":n("editField",{fieldName:s(a.fieldId)}),children:t("actions.edit")}),e.jsx(h,{variant:"danger",size:"sm",icon:w,onClick:()=>O.handleHideField(a),"aria-label":n("hideField",{fieldName:s(a.fieldId)}),children:t("actions.hide")})]})]})},a.fieldId)),L&&e.jsxs("div",{id:"form-error",className:"text-red-600 dark:text-red-400 font-semibold bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",role:"alert","aria-live":"polite",children:[e.jsx("span",{className:"sr-only",children:t("aria.formError")}),L]}),e.jsx(h,{type:"submit",variant:"success",size:"lg",icon:d,fullWidth:!0,"aria-describedby":L?"form-error":void 0,children:t("pages.input.record")})]}),e.jsx("div",{className:"mb-8",children:O.showSelectField?e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-md",children:[e.jsxs("h3",{className:"text-2xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(y,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),t("pages.input.fieldManagement.selectFieldsTitle")]}),e.jsxs("div",{className:"space-y-4",children:[O.getHiddenFields().length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 text-left",children:t("pages.input.fieldManagement.existingFields")}),e.jsx("div",{className:"space-y-3",children:O.getHiddenFields().map(a=>e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:O.editingExistingFieldId===a.fieldId?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch",children:[e.jsx("div",{className:"text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 pb-2 sm:pb-0",children:e.jsx("input",{type:"text",value:O.editingExistingField.name??"",onChange:e=>O.setEditingExistingField(a=>({...a,name:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",placeholder:t("pages.input.fieldManagement.fieldName")})}),e.jsx("div",{className:"pl-0 sm:pl-2 pt-2 sm:pt-0",children:e.jsx("input",{type:"text",value:O.editingExistingField.unit??"",onChange:e=>O.setEditingExistingField(a=>({...a,unit:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",placeholder:t("pages.input.fieldManagement.unitPlaceholder")})})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 justify-center pt-2 border-t border-gray-200",children:[e.jsx(h,{variant:"success",size:"md",icon:g,onClick:O.handleEditExistingFieldSave,className:"flex-1 sm:min-w-[120px]",children:t("actions.save")}),e.jsx(h,{variant:"secondary",size:"md",icon:u,onClick:()=>{O.setEditingExistingFieldId(null),O.clearSelectButtons()},className:"flex-1 sm:min-w-[120px]",children:t("actions.cancel")})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-stretch cursor-pointer",onClick:()=>O.toggleSelectButtons(a.fieldId),children:[e.jsx("div",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 text-left sm:text-right pr-0 sm:pr-2 border-b sm:border-b-0 sm:border-r border-gray-200 dark:border-gray-600 pb-2 sm:pb-0",children:a.name}),e.jsx("div",{className:"text-lg text-gray-800 dark:text-gray-200 font-semibold pl-0 sm:pl-2 text-left pt-2 sm:pt-0",children:a.unit?`(${a.unit})`:""})]}),O.areSelectButtonsShown(a.fieldId)&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mt-4 pt-4 border-t border-gray-200",children:[e.jsx(h,{variant:"success",size:"sm",icon:g,onClick:()=>O.handleShowExistingFieldPermanently(a.fieldId),children:t("actions.display")}),e.jsx(h,{variant:"teal",size:"sm",icon:k,onClick:()=>O.handleShowExistingField(a.fieldId),children:t("actions.add")}),e.jsx(h,{variant:"primary",size:"sm",icon:v,onClick:()=>O.handleEditExistingField(a),children:t("actions.edit")}),e.jsx(h,{variant:"danger",size:"sm",icon:j,onClick:()=>O.handleDeleteExistingField(a),children:t("actions.delete")})]})]})},a.fieldId))})]}),O.showAddField&&e.jsxs("form",{onSubmit:O.handleAddField,className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-xl font-medium text-gray-700 dark:text-gray-200 mb-4 text-left flex items-center gap-2",children:[e.jsx(k,{className:"w-6 h-6 text-green-600 dark:text-green-400","aria-hidden":"true"}),t("pages.input.fieldManagement.addNewField")]}),e.jsxs("fieldset",{className:"space-y-4",children:[e.jsx("legend",{className:"sr-only",children:t("aria.newFieldDetails")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{htmlFor:"new-field-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:[t("pages.input.fieldManagement.fieldNameRequired")," ",e.jsx("span",{className:"text-red-600","aria-label":t("fields.required"),children:"*"})]}),e.jsx("input",{id:"new-field-name",type:"text",value:O.newField.name,onChange:e=>O.setNewField(a=>({...a,name:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",placeholder:t("pages.input.fieldManagement.fieldNamePlaceholder"),required:!0,"aria-required":"true","aria-describedby":"new-field-name-desc","aria-invalid":O.addFieldError&&O.addFieldError.includes(t("validation.fieldNameRequired"))?"true":"false"}),e.jsx("div",{id:"new-field-name-desc",className:"sr-only",children:t("aria.fieldNameDescription")})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsxs("label",{htmlFor:"new-field-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:[t("pages.input.fieldManagement.dataTypeRequired")," ",e.jsx("span",{className:"text-red-600","aria-label":t("fields.required"),children:"*"})]}),e.jsxs("select",{id:"new-field-type",value:O.newField.type,onChange:e=>O.setNewField(a=>({...a,type:e.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600 dark:focus:ring-blue-400 dark:focus:border-blue-400",required:!0,"aria-required":"true","aria-describedby":"new-field-type-desc",children:[e.jsx("option",{value:"number",children:t("fields.types.number")}),e.jsx("option",{value:"string",children:t("fields.types.string")}),e.jsx("option",{value:"boolean",children:t("fields.types.boolean")})]}),e.jsx("div",{id:"new-field-type-desc",className:"sr-only",children:t("aria.dataTypeDescription")})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsx("label",{htmlFor:"new-field-unit",className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1",children:t("pages.input.fieldManagement.unitOptional")}),e.jsx("input",{id:"new-field-unit",type:"text",value:O.newField.unit,onChange:e=>O.setNewField(a=>({...a,unit:e.target.value})),placeholder:t("fields.inputPlaceholder",{example:"kg"}),className:"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 dark:focus:ring-blue-400 focus:border-blue-600 dark:focus:border-blue-400","aria-describedby":"unit-description","aria-label":t("aria.unitFieldDescription")}),e.jsx("div",{id:"unit-description",className:"sr-only",children:t("aria.unitFieldDescription")})]})]}),O.addFieldError&&e.jsxs("div",{id:"add-field-error",className:"text-red-600 dark:text-red-400 font-semibold bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800",role:"alert","aria-live":"polite",children:[e.jsx("span",{className:"sr-only",children:t("aria.formError")}),O.addFieldError]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 pt-2",children:[e.jsxs("button",{type:"submit",className:"bg-teal-500 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-teal-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 text-sm sm:text-base flex-1 sm:min-w-[120px]","aria-describedby":O.addFieldError?"add-field-error":void 0,children:[e.jsx(k,{className:"w-4 h-4","aria-hidden":"true"}),t("actions.add")]}),e.jsxs("button",{type:"button",onClick:()=>O.setShowAddField(!1),className:"bg-gray-400 text-white px-3 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-gray-500 transition-colors duration-200 font-medium flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 text-sm sm:text-base flex-1 sm:min-w-[120px]",children:[e.jsx(u,{className:"w-4 h-4","aria-hidden":"true"}),t("actions.cancel")]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[!O.showAddField&&e.jsxs("button",{type:"button",onClick:()=>O.setShowAddField(!0),className:"bg-teal-500 text-white px-3 sm:px-4 py-2 rounded-lg shadow-md hover:bg-teal-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base whitespace-nowrap",children:[e.jsx(k,{className:"w-4 h-4"}),t("pages.input.fieldManagement.addNewField")]}),e.jsxs("button",{type:"button",onClick:()=>O.setShowSelectField(!1),className:"bg-gray-500 text-white px-3 sm:px-4 py-2 rounded-lg shadow-md hover:bg-gray-600 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base",children:[e.jsx(N,{className:"w-4 h-4 sm:w-5 sm:h-5"}),t("actions.back")]})]})]})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>O.setShowSelectField(!0),className:"bg-blue-500 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base","aria-label":n("showField",{fieldName:t("pages.input.selectFields")}),children:[e.jsx(y,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),t("pages.input.selectFields")]}),e.jsxs("button",{type:"button",onClick:O.handleOpenSortModal,disabled:A.loading||0===I.length,className:"px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2 text-sm sm:text-base "+(A.loading||0===I.length?"bg-gray-400 text-white cursor-not-allowed":"bg-purple-500 text-white hover:bg-purple-600"),"aria-label":n("sort",{fieldName:t("pages.input.sortFields")}),children:[e.jsx(c,{className:"w-4 h-4 sm:w-5 sm:h-5","aria-hidden":"true"}),A.loading?t("common.loading"):t("pages.input.sortFields")]})]})}),e.jsx(K,{isOpen:O.showSortModal,onClose:()=>O.setShowSortModal(!1),fields:O.sortableFields,onDragEnd:O.handleDragEnd,onSave:O.handleSaveSortOrder,onToggleDisplay:O.handleToggleDisplayInModal})]})})}export{Q as default};
